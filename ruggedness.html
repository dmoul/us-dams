<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>10&nbsp; Terrain ruggedness – A look at US Dams</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<link href="./ruggedness-preparing.html" rel="next">
<link href="./dams-and-waterways.html" rel="prev">
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-485d01fc63b59abcd3ee1bf1e8e2748d.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/quarto-contrib/quarto-auto-dark-mode-1.0.0/auto-dark-mode.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="site_libs/quarto-contrib/quarto-project/gadenbuie/auto-dark/auto-dark-mode.css">
</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./ruggedness.html"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Terrain ruggedness</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">A look at US Dams</a> 
    </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Summary</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./risk.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Risks</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./asce-grades.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Infrastructure grades</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./maps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Maps</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./numbers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Numbers</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./owners-nc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Owners in NC</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./drainage.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Drainage</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dams-and-waterways.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Dams, waterways, and watersheds</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ruggedness.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Terrain ruggedness</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ruggedness-preparing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Preparing terrain ruggedness</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Notes and limitations</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="3">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#hypotheses-related-to-dams-and-ruggedness" id="toc-hypotheses-related-to-dams-and-ruggedness" class="nav-link active" data-scroll-target="#hypotheses-related-to-dams-and-ruggedness"><span class="header-section-number">10.1</span> Hypotheses related to dams and ruggedness</a>
  <ul>
  <li><a href="#sec-h1" id="toc-sec-h1" class="nav-link" data-scroll-target="#sec-h1"><span class="header-section-number">10.1.1</span> Hypothesis 1</a></li>
  <li><a href="#sec-h2" id="toc-sec-h2" class="nav-link" data-scroll-target="#sec-h2"><span class="header-section-number">10.1.2</span> Hypothesis 2</a></li>
  <li><a href="#sec-h3" id="toc-sec-h3" class="nav-link" data-scroll-target="#sec-h3"><span class="header-section-number">10.1.3</span> Hypothesis 3</a></li>
  </ul></li>
  <li><a href="#methodology" id="toc-methodology" class="nav-link" data-scroll-target="#methodology"><span class="header-section-number">10.2</span> Methodology</a>
  <ul>
  <li><a href="#key-metric" id="toc-key-metric" class="nav-link" data-scroll-target="#key-metric"><span class="header-section-number">10.2.1</span> Key metric</a></li>
  <li><a href="#data-sources" id="toc-data-sources" class="nav-link" data-scroll-target="#data-sources"><span class="header-section-number">10.2.2</span> Data sources</a></li>
  <li><a href="#data-prep" id="toc-data-prep" class="nav-link" data-scroll-target="#data-prep"><span class="header-section-number">10.2.3</span> Data prep</a></li>
  <li><a href="#exploration" id="toc-exploration" class="nav-link" data-scroll-target="#exploration"><span class="header-section-number">10.2.4</span> Exploration</a></li>
  </ul></li>
  <li><a href="#sec-h1-explore" id="toc-sec-h1-explore" class="nav-link" data-scroll-target="#sec-h1-explore"><span class="header-section-number">10.3</span> Exploring H<sub>1</sub> : Local terrain ruggedness in the area around dams is greater than the ruggedness of areas around randomly sampled points in the contentinental US states</a>
  <ul>
  <li><a href="#first-dam-and-sample-distributions" id="toc-first-dam-and-sample-distributions" class="nav-link" data-scroll-target="#first-dam-and-sample-distributions"><span class="header-section-number">10.3.1</span> First: dam and sample distributions</a></li>
  <li><a href="#second-difference-in-tri_meandam---tri_meansample" id="toc-second-difference-in-tri_meandam---tri_meansample" class="nav-link" data-scroll-target="#second-difference-in-tri_meandam---tri_meansample"><span class="header-section-number">10.3.2</span> Second: difference in tri_mean<sub>dam</sub> - tri_mean<sub>sample</sub></a></li>
  <li><a href="#regression-models" id="toc-regression-models" class="nav-link" data-scroll-target="#regression-models"><span class="header-section-number">10.3.3</span> Regression models</a>
  <ul class="collapse">
  <li><a href="#sec-h1-mod1" id="toc-sec-h1-mod1" class="nav-link" data-scroll-target="#sec-h1-mod1"><span class="header-section-number">10.3.3.1</span> Model mod.h1.1</a></li>
  <li><a href="#sec-h1-mod2" id="toc-sec-h1-mod2" class="nav-link" data-scroll-target="#sec-h1-mod2"><span class="header-section-number">10.3.3.2</span> Model mod.h1.2</a></li>
  <li><a href="#sec-h1-mod3" id="toc-sec-h1-mod3" class="nav-link" data-scroll-target="#sec-h1-mod3"><span class="header-section-number">10.3.3.3</span> Model mod.h1.3</a></li>
  <li><a href="#sec-h1-mod4" id="toc-sec-h1-mod4" class="nav-link" data-scroll-target="#sec-h1-mod4"><span class="header-section-number">10.3.3.4</span> Model mod.h1.4</a></li>
  </ul></li>
  <li><a href="#conclusion-h1" id="toc-conclusion-h1" class="nav-link" data-scroll-target="#conclusion-h1"><span class="header-section-number">10.3.4</span> Conclusion: H<sub>1</sub></a></li>
  </ul></li>
  <li><a href="#sec-h2-explore" id="toc-sec-h2-explore" class="nav-link" data-scroll-target="#sec-h2-explore"><span class="header-section-number">10.4</span> Exploring H<sub>2</sub> : In states with higher terrain ruggedness, dams’ <span class="math inline">\(\frac{surfaceArea}{nidStorage}\)</span> will be lower</a>
  <ul>
  <li><a href="#first-surfacearea-and-nidstorage-distributions" id="toc-first-surfacearea-and-nidstorage-distributions" class="nav-link" data-scroll-target="#first-surfacearea-and-nidstorage-distributions"><span class="header-section-number">10.4.1</span> First: <code>surfaceArea</code> and <code>nidStorage</code> distributions</a>
  <ul class="collapse">
  <li><a href="#data-availability" id="toc-data-availability" class="nav-link" data-scroll-target="#data-availability"><span class="header-section-number">10.4.1.1</span> Data availability</a></li>
  <li><a href="#plots" id="toc-plots" class="nav-link" data-scroll-target="#plots"><span class="header-section-number">10.4.1.2</span> Plots</a></li>
  <li><a href="#sec-h2-mod1" id="toc-sec-h2-mod1" class="nav-link" data-scroll-target="#sec-h2-mod1"><span class="header-section-number">10.4.1.3</span> Model mod.h2.1</a></li>
  <li><a href="#sec-h2-mod2" id="toc-sec-h2-mod2" class="nav-link" data-scroll-target="#sec-h2-mod2"><span class="header-section-number">10.4.1.4</span> Model mod.h2.2</a></li>
  </ul></li>
  <li><a href="#sec-plots-tri-mean-sample" id="toc-sec-plots-tri-mean-sample" class="nav-link" data-scroll-target="#sec-plots-tri-mean-sample"><span class="header-section-number">10.4.2</span> Second: exploring the relationship among tri_mean<sub>sample</sub>, <code>sufaceArea</code>, and <code>nidStorage</code></a>
  <ul class="collapse">
  <li><a href="#plots-1" id="toc-plots-1" class="nav-link" data-scroll-target="#plots-1"><span class="header-section-number">10.4.2.1</span> Plots</a></li>
  <li><a href="#regression-models-1" id="toc-regression-models-1" class="nav-link" data-scroll-target="#regression-models-1"><span class="header-section-number">10.4.2.2</span> Regression models</a></li>
  </ul></li>
  <li><a href="#conclusion-h2" id="toc-conclusion-h2" class="nav-link" data-scroll-target="#conclusion-h2"><span class="header-section-number">10.4.3</span> Conclusion: H<sub>2</sub></a></li>
  </ul></li>
  <li><a href="#sec-h3-explore" id="toc-sec-h3-explore" class="nav-link" data-scroll-target="#sec-h3-explore"><span class="header-section-number">10.5</span> Exploring H<sub>3</sub> : Compared to H<sub>2</sub> there is a stronger inverse proportional relationship between ruggeness in the local areas around dams and surfaceArea::nidStorage</a>
  <ul>
  <li><a href="#plots-2" id="toc-plots-2" class="nav-link" data-scroll-target="#plots-2"><span class="header-section-number">10.5.1</span> Plots</a></li>
  <li><a href="#regression-models-2" id="toc-regression-models-2" class="nav-link" data-scroll-target="#regression-models-2"><span class="header-section-number">10.5.2</span> Regression models</a>
  <ul class="collapse">
  <li><a href="#sec-h3-mod1" id="toc-sec-h3-mod1" class="nav-link" data-scroll-target="#sec-h3-mod1"><span class="header-section-number">10.5.2.1</span> Model mod.h3.1</a></li>
  <li><a href="#sec-h3-mod2" id="toc-sec-h3-mod2" class="nav-link" data-scroll-target="#sec-h3-mod2"><span class="header-section-number">10.5.2.2</span> Model mod.h3.2</a></li>
  <li><a href="#sec-h3-mod3" id="toc-sec-h3-mod3" class="nav-link" data-scroll-target="#sec-h3-mod3"><span class="header-section-number">10.5.2.3</span> Model mod.h3.3</a></li>
  <li><a href="#sec-h3-mod4" id="toc-sec-h3-mod4" class="nav-link" data-scroll-target="#sec-h3-mod4"><span class="header-section-number">10.5.2.4</span> Model mod.h3.4</a></li>
  <li><a href="#sec-h3-mod5" id="toc-sec-h3-mod5" class="nav-link" data-scroll-target="#sec-h3-mod5"><span class="header-section-number">10.5.2.5</span> Model mod.h3.5</a></li>
  <li><a href="#sec-h3-mod6" id="toc-sec-h3-mod6" class="nav-link" data-scroll-target="#sec-h3-mod6"><span class="header-section-number">10.5.2.6</span> Model mod.h3.6</a></li>
  <li><a href="#sec-h3-mod7" id="toc-sec-h3-mod7" class="nav-link" data-scroll-target="#sec-h3-mod7"><span class="header-section-number">10.5.2.7</span> Model mod.h3.7</a></li>
  </ul></li>
  <li><a href="#conclusion-h3" id="toc-conclusion-h3" class="nav-link" data-scroll-target="#conclusion-h3"><span class="header-section-number">10.5.3</span> Conclusion: H<sub>3</sub></a></li>
  </ul></li>
  <li><a href="#summary-insights-from-ruggedness" id="toc-summary-insights-from-ruggedness" class="nav-link" data-scroll-target="#summary-insights-from-ruggedness"><span class="header-section-number">10.6</span> Summary: insights from ruggedness</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-ruggedness" class="quarto-section-identifier"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Terrain ruggedness</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>state_boundaries_sf <span class="ot">&lt;-</span> <span class="fu">us_states</span>() <span class="sc">|&gt;</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># `dams` data uses `state_abb` rather than 'state_abbr`, which `dam` gets from R's built-in `state.abb` data frame.</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># next 3 lines are a workaround since "rename(state_abb = state_abbr)" doesn't work</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   "Error in rename.sf(us_states(), state_abb = state_abbr) : internal error: can't find `agr` columns"</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">state_abb =</span> state_abbr) <span class="sc">|&gt;</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(state_abb, <span class="at">.after =</span> state_abbr) <span class="sc">|&gt;</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>state_abbr) <span class="sc">|&gt;</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>state_abb <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"DC"</span>, <span class="st">"HI"</span>, <span class="st">"AK"</span>, <span class="st">"PR"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(state_abb) <span class="sc">|&gt;</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="st">"NAD83"</span>) <span class="co"># US Government standard CRS</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>nc_boundary <span class="ot">&lt;-</span> state_boundaries_sf <span class="sc">|&gt;</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(state_abb <span class="sc">==</span> <span class="st">"NC"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="do">###### Does dam TRI data exist?</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>states_with_dams <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(dams<span class="sc">$</span>state_abb))</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_len</span>(<span class="fu">length</span>(states_with_dams))) {</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  state_dam_tri_summary_fname <span class="ot">&lt;-</span> <span class="fu">paste0</span>(state_dam_tri_summary_pname, <span class="st">"/"</span>, states_with_dams[i], <span class="st">".rds"</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">file.exists</span>(state_dam_tri_summary_fname)) {</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">errorCondition</span>(</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">glue</span>(<span class="st">"This chapter ('ruggedness.qmd') needs dam terrain ruggedness (TRI) data created in the 'Exploring ruggedness' chapter."</span>, </span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"</span><span class="sc">\n</span><span class="st">Rerender this chapter after rendering that chapter (from a terminal command line: 'quarto render ruggedness-exploring.qmd')"</span>,</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">"</span><span class="sc">\n</span><span class="st">After doing that files will exist for each continental state similar to</span><span class="sc">\n</span><span class="st">{state_dam_tri_summary_fname}"</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    knitr<span class="sc">::</span><span class="fu">knit_exit</span>()</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="do">###### Does state sample TRI data exist?</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>states_with_points <span class="ot">&lt;-</span> states_with_dams</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_len</span>(<span class="fu">length</span>(states_with_points))) {</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>  state_tri_circle_samples_fname <span class="ot">&lt;-</span> <span class="fu">paste0</span>(state_tri_circle_samples_pname, <span class="st">"/"</span>, states_with_points[i], <span class="st">".rds"</span>)</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">file.exists</span>(state_tri_circle_samples_fname)) {</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">errorCondition</span>(</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>      <span class="fu">glue</span>(<span class="st">"This chapter ('ruggedness.qmd') needs state sample terrain ruggedness (TRI) data created in the 'Exploring ruggedness' chapter."</span>, </span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>    <span class="st">"</span><span class="sc">\n</span><span class="st">Rerender this chapter after rendering that chapter (from a terminal command line: 'quarto render ruggedness-exploring.qmd')."</span>,</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>    <span class="st">"</span><span class="sc">\n</span><span class="st">After doing that files will exist for each continental state similar to</span><span class="sc">\n</span><span class="st">{state_tri_circle_samples_fname}"</span>,</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>    <span class="st">"</span><span class="sc">\n</span><span class="st">Then you can rerender 'ruggedness.qmd' from a terminal command line: 'quarto render' or 'quarto rend ruggedness.qmd')."</span></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>    knitr<span class="sc">::</span><span class="fu">knit_exit</span>()</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>states_with_dams <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(dams<span class="sc">$</span>state_abb))</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>n_states_with_dams <span class="ot">&lt;-</span> <span class="fu">length</span>(states_with_dams)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>states_and_regions <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">state_region =</span> state.region,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">state_abb =</span> state.abb) <span class="sc">|&gt;</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(state_abb <span class="sc">%in%</span> states_with_dams) <span class="sc">|&gt;</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_states =</span> <span class="fu">n</span>(),</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">region_label =</span> <span class="fu">glue</span>(<span class="st">"{state_region} (n={n_states})"</span>),</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">.by =</span> state_region)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="do">###### Get state samples TRI data</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>state_samples_tri_summary_df <span class="ot">&lt;-</span> <span class="fu">map</span>(<span class="fu">dir</span>(state_tri_circle_samples_pname, <span class="at">full.names =</span> <span class="cn">TRUE</span>), </span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>                                    read_rds) <span class="sc">|&gt;</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>() <span class="sc">|&gt;</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    states_and_regions,</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="st">"state_abb"</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">tri_n_sample =</span> tri_n,</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">tri_mean_sample =</span> tri_mean,</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>         <span class="at">tri_median_sample =</span> tri_median,</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>         <span class="at">tri_sd_sample =</span> tri_sd)</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a><span class="do">###### Get dam TRI data</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="co"># state_dam_tri_summary_fname &lt;- paste0(state_dam_tri_summary_pname, "/", states_with_dams[i], ".rds")</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>state_dam_tri_summary_df <span class="ot">&lt;-</span> <span class="fu">map</span>(<span class="fu">dir</span>(state_dam_tri_summary_pname, <span class="at">full.names =</span> <span class="cn">TRUE</span>), </span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>             read_rds) <span class="sc">|&gt;</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>() <span class="sc">|&gt;</span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>    states_and_regions,</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="st">"state_abb"</span></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">tri_n_dam =</span> tri_n,</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>         <span class="at">tri_mean_dam =</span> tri_mean,</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>         <span class="at">tri_median_dam =</span> tri_median,</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>         <span class="at">tri_sd_dam =</span> tri_sd)</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>dams_with_tri <span class="ot">&lt;-</span> dams <span class="sc">|&gt;</span></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(state_dam_tri_summary_df <span class="sc">|&gt;</span></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>               <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(state_region<span class="sc">:</span>region_label)),</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>             <span class="at">by =</span> <span class="fu">join_by</span>(nidId, state_abb)) <span class="sc">|&gt;</span></span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(nidHeightId <span class="sc">!=</span> <span class="st">"Undetermined"</span>)</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>n_dams_with_tri <span class="ot">&lt;-</span> state_dam_tri_summary_df <span class="sc">|&gt;</span></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>()</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>min_tri_n_dam_state <span class="ot">&lt;-</span> <span class="fu">count</span>(state_dam_tri_summary_df, state_abb, <span class="at">wt =</span> tri_n_dam) <span class="sc">|&gt;</span></span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">min</span>(n) <span class="sc">==</span> n)</span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>min_dams_n_state <span class="ot">&lt;-</span> <span class="fu">count</span>(state_dam_tri_summary_df, state_abb) <span class="sc">|&gt;</span></span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">min</span>(n) <span class="sc">==</span> n)</span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>max_dams_n_state <span class="ot">&lt;-</span> <span class="fu">count</span>(state_dam_tri_summary_df, state_abb) <span class="sc">|&gt;</span></span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">max</span>(n) <span class="sc">==</span> n)</span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a><span class="do">###### Get Blue Ridge Parkway multiline</span></span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>fname <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">"data/processed/blue-ridge-parkway.rds"</span>)</span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">file.exists</span>(fname)) {</span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">st_bbox</span>(nc_boundary) <span class="sc">|&gt;</span></span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">opq</span>() <span class="sc">%&gt;%</span></span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_osm_feature</span>(<span class="at">key =</span> <span class="st">"name"</span>, </span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a>                    <span class="at">value =</span> <span class="st">"Blue Ridge Parkway"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a>    <span class="fu">osmdata_sf</span>()</span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a>  parkway_lines <span class="ot">&lt;-</span> results<span class="sc">$</span>osm_multilines <span class="sc">|&gt;</span></span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">st_transform</span>(<span class="st">"NAD83"</span>)</span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a>  parkway_lines_nc <span class="ot">&lt;-</span> <span class="fu">st_intersection</span>(parkway_lines, nc_boundary)</span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write_rds</span>(parkway_lines_nc, fname)</span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a>  parkway_lines_nc <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(fname)</span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="hypotheses-related-to-dams-and-ruggedness" class="level2" data-number="10.1">
<h2 data-number="10.1" class="anchored" data-anchor-id="hypotheses-related-to-dams-and-ruggedness"><span class="header-section-number">10.1</span> Hypotheses related to dams and ruggedness</h2>
<p>After thinking about the question I asked in <em><a href="numbers.html#sec-ratios" class="quarto-xref"><span>Section 6.4</span></a> Ratios</em> and how I might answer it:</p>
<blockquote class="blockquote">
<p>Dams built in hilly areas seem to me to be more likely to have low ratios of surfaceArea to nidStorage, i.e., the dams are likely to be deeper rather than broader. Can we substantiate or disprove this conjecture?</p>
</blockquote>
<p>I’ve thought of three more specific hypotheses I want to explore (<span class="math inline">\(H_2\)</span> and <span class="math inline">\(H_3\)</span> are variants addressing the original question).</p>
<section id="sec-h1" class="level3" data-number="10.1.1">
<h3 data-number="10.1.1" class="anchored" data-anchor-id="sec-h1"><span class="header-section-number">10.1.1</span> Hypothesis 1</h3>
<blockquote class="blockquote">
<p>Local terrain ruggedness in the area around dams is greater than the ruggedness of areas around randomly sampled points in the continental US states.</p>
</blockquote>
<p>In other words, for states:</p>
<p><span class="math display">\[tri\_mean_{dam} \gt tri\_mean_{sample}\]</span> In addition to plots exploring distributions and relationships, I look at four regressions:</p>
<ol type="1">
<li>mod.h1.1: lm(tri_mean_dam ~ tri_mean_sample)</li>
</ol>
<ul>
<li>If <span class="math inline">\(H_1\)</span> is true, the regression term estimate for <span class="math inline">\(tri\_mean_{sample}\)</span> will be positive. this is a necessary but not sufficient condition for <span class="math inline">\(H_1\)</span>.</li>
</ul>
<ol start="2" type="1">
<li>mod.h1.2: lmer(tri_mean_dam ~ (1 | state))</li>
</ol>
<ul>
<li>How much variation in <span class="math inline">\(tri\_mean_{dam}\)</span> can be explained by state effects without consideration of <span class="math inline">\(tri\_mean_{sample}\)</span>? This provides a base from which to consider other models.</li>
</ul>
<ol start="3" type="1">
<li>mod.h1.3: lmer(tri_mean_sample ~ (1 | state))</li>
</ol>
<ul>
<li>How much variation in <span class="math inline">\(tri\_mean_{sample}\)</span> can be explained by state effects without consideration of <span class="math inline">\(tri\_mean_{dam}\)</span>? This provides a base from which to consider other models.</li>
</ul>
<ol start="4" type="1">
<li>mod.h1.4: lmer(tri_mean_dam ~ tri_mean_sample + (1 | state))</li>
</ol>
<ul>
<li>I assume this model explains the more of the variance than the others.</li>
</ul>
<p><br></p>
</section>
<section id="sec-h2" class="level3" data-number="10.1.2">
<h3 data-number="10.1.2" class="anchored" data-anchor-id="sec-h2"><span class="header-section-number">10.1.2</span> Hypothesis 2</h3>
<blockquote class="blockquote">
<p>In states with higher terrain ruggedness, dams’ <span class="math inline">\(\frac{surfaceArea}{nidStorage}\)</span> will be lower.</p>
</blockquote>
<p>Where dams are in more rugged states, it seems likely dams’ lakes will be deeper and thus have smaller ratios <span class="math inline">\(\frac{surfaceArea}{nidStorage}\)</span>. In other words, considering the states in the continental US, there is an inverse proportional relationship:</p>
<p><span class="math display">\[tri\_mean_{sample} \propto \frac{1}{\left(\frac{surfaceArea}{nidStorage}\right)}\]</span></p>
<p>In addition to plots exploring distributions and relationships, I look at two regressions:</p>
<ol type="1">
<li>lm(tri_mean_sample ~ ratio)</li>
<li>lmer(tri_mean_sample ~ ratio + (1 | state))</li>
</ol>
<p>where <span class="math inline">\(ratio = \frac{surfaceArea}{nidStorage}\)</span>.</p>
</section>
<section id="sec-h3" class="level3" data-number="10.1.3">
<h3 data-number="10.1.3" class="anchored" data-anchor-id="sec-h3"><span class="header-section-number">10.1.3</span> Hypothesis 3</h3>
<blockquote class="blockquote">
<p>Compared to H<sub>2</sub> there is a stronger inverse proportional relationship between ruggeness in the local areas around dams and surfaceArea::nidStorage</p>
</blockquote>
<p>In <span class="math inline">\(H_3\)</span> I restrict the locations to the local areas around dams. It’s likely there is a stronger inverse proportional relationship between <span class="math inline">\(tri\_mean_{dam}\)</span> and <span class="math inline">\(\frac{surfaceArea}{nidStorage}\)</span> for the same dam, since dams are built where the topography provides good places to hold water.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<p>Expressed like <span class="math inline">\(H_2\)</span> :</p>
<p><span class="math display">\[tri\_mean_{dam} \propto \frac{1}{\left(\frac{surfaceArea}{nidStorage}\right)}\]</span></p>
<p>In addition to plots exploring distributions and relationships, I look at two regressions:</p>
<ol type="1">
<li>lm(tri_mean_dam ~ ratio)</li>
<li>lmer(tri_mean_dam ~ ratio + (1 | state))</li>
</ol>
<p><br></p>
</section>
</section>
<section id="methodology" class="level2" data-number="10.2">
<h2 data-number="10.2" class="anchored" data-anchor-id="methodology"><span class="header-section-number">10.2</span> Methodology</h2>
<section id="key-metric" class="level3" data-number="10.2.1">
<h3 data-number="10.2.1" class="anchored" data-anchor-id="key-metric"><span class="header-section-number">10.2.1</span> Key metric</h3>
<p>I calculate terrain ruggedness index (TRI) from digital elevation model (DEM) data I downloaded and saved in GeoTIFF files. The <a href="https://rspatial.github.io/terra/reference/terrain.html">terra::terrain()</a> function calculates TRI for me from the elevation data using eight-neighbor “classic” TRI per Wilson et al.&nbsp;(2007).<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<p>From the <code>terra::terrain()</code> help:</p>
<blockquote class="blockquote">
<p>“TRI (Terrain Ruggedness Index) is the mean of the absolute differences between the value of a cell and its 8 surrounding cells.”</p>
</blockquote>
<p>Note that TRI values are sensitive to the resolution of the digital elevation model, since differences in elevation differ significantly over various distances.</p>
</section>
<section id="data-sources" class="level3" data-number="10.2.2">
<h3 data-number="10.2.2" class="anchored" data-anchor-id="data-sources"><span class="header-section-number">10.2.2</span> Data sources</h3>
<p>I get elevation data from <a href="https://cran.r-project.org/web/packages/elevatr/refman/elevatr.html#get_elev_raster">elevatr::get_elev_raster()</a>, which returns Shuttle Radar Topography Mission (SRTM)<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> data via <a href="https://opentopography.org">Open Topography</a>. The SRTM’s Digital Elevation Model (DEM) is a Digital Surface Model (DSM) rather than a Digital Terrain Model (DTM). In other words, the radar reflections used to calculate elevations in some cases are from the tops of buildings and partway through the tree canopy; elevation values have not been adjusted to estimate ground level.<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a> For my purposes, and because I have so many points to work with, this noise is not an issue.</p>
<p>The SRTM digital elevation model (DEM) has a range over continental North America south of 60° N latitude. This range is fine, since the northernmost point in the continental USA is the Northwest Angle Inlet in Lake of the Woods, MN at 49.4°).<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a></p>
<p>I use zoom level 9 (<code>elevatr::get_elev_raster(z = 9)</code>), which provides data at the resolution of about 125 m per point in North Carolina and greater distances between points in lower latitudes. For more information see <em><a href="ruggedness-preparing.html#sec-res-by-latitude" class="quarto-xref"><span>Section 11.1.4.1</span></a> Resolution of elevation data varies by latitude</em>.</p>
<p>For state boundaries, I use <a href="https://ropensci.r-universe.dev/USAboundaries">USAboundaries::us_states()</a></p>
<p>For drawing the Blue Ridge Parkway in North Carolina, I use shapes from OpenStreetMap, which I acquire via the <a href="https://ropensci.r-universe.dev/osmdata">osmdata</a> package.</p>
</section>
<section id="data-prep" class="level3" data-number="10.2.3">
<h3 data-number="10.2.3" class="anchored" data-anchor-id="data-prep"><span class="header-section-number">10.2.3</span> Data prep</h3>
<ol type="1">
<li><p><strong>Dam data</strong>: Using data the from the National Inventory of Dams, I prepare a data set with 86351 dams that include <code>nidHeightId</code> (and thus <code>nidHeight</code>) along with state abbreviation (<code>state_abb</code>) and <span class="math inline">\((longitude, latitude)\)</span> location.</p></li>
<li><p><strong>State boundaries, etc.</strong>: I use <a href="https://ropensci.r-universe.dev/USAboundaries">USAboundaries::us_states()</a> to get state boundaries and use <a href="https://ropensci.r-universe.dev/osmdata">osmdata::opq()</a> to download OpenStreetMap shapes for the Blue Ridge Parkway in North Carolina.</p></li>
<li><p><strong>State-level elevation data</strong>: Using state boundaries, I downloaded DEM and saved them as GeoTIFF files for use in the following steps.</p></li>
<li><p><strong>Local terrain ruggedness around dams</strong>: I define a circle of radius r = 5 km around each dam location, get the elevations for every point in the circle, and calculate the TRI for the points. Then I create summary statistics for each dam’s circle (<code>tri_mean_dam</code>, <code>tri_median_dam</code>, <code>tri_sd_dam</code>, <code>tri_n_dam</code> points).</p></li>
<li><p><strong>Local terrain ruggedness around random points</strong>: The number of dams vary by state. So for each state, I randomly sample the same number of points as there are dams in that state, define circles of radius r = 5 km, get the elevations for every point in the circle, and calculate the TRI for the points. Then I create summary statistics for each sample’s circle (<code>tri_mean_sample</code>, <code>tri_median_sample</code>, <code>tri_sd_sample</code>, <code>tri_n_sample</code> points).</p></li>
</ol>
<p>For more information about data preparation, questions I asked, and trade-offs I made along the way, see <em><a href="ruggedness-preparing.html" class="quarto-xref"><span>Chapter 11</span></a> Preparing terrain ruggedness</em>.</p>
</section>
<section id="exploration" class="level3" data-number="10.2.4">
<h3 data-number="10.2.4" class="anchored" data-anchor-id="exploration"><span class="header-section-number">10.2.4</span> Exploration</h3>
<p>To explore <span class="math inline">\(H_1:\)</span> in <em><a href="#sec-h1-explore" class="quarto-xref"><span>Section 10.3</span></a></em>:</p>
<ul>
<li><p>I plot the distribution of <span class="math inline">\(tri\_mean_{dam}\)</span> and <span class="math inline">\(tri\_mean_{sample}\)</span> by <code>state_abb</code>, <code>state_region</code>, and <code>nidHeightId</code>.</p></li>
<li><p>I sort the dam and state samples in order of <span class="math inline">\(tri\_mean_{dam}\)</span> and <span class="math inline">\(tri\_mean_{sample}\)</span> respectively, and I pair them in linear regressions with various models to check which models explain the most variance. I plot some of the model parameter (a.k.a. term) estimates.</p></li>
</ul>
<p>To explore <span class="math inline">\(H_2:\)</span>in <em><a href="#sec-h2-explore" class="quarto-xref"><span>Section 10.4</span></a></em>:</p>
<ul>
<li><p>I plot the distributions of <span class="math inline">\(surfaceArea\)</span>, <span class="math inline">\(nidStorage\)</span>, and <span class="math inline">\(\frac{surfaceArea}{nidStorage}\)</span> aggregated by <code>state_abb</code> and <code>nidHeigthId</code>.</p></li>
<li><p>I sort the dam and state samples in order of <span class="math inline">\(tri\_mean_{dam}\)</span> and <span class="math inline">\(tri\_mean_{sample}\)</span> respectively, and I pair them in linear regressions predicting <span class="math inline">\(tri\_mean_{sample}\)</span> using various models to check which models explain the most variance.</p></li>
</ul>
<p>To explore <span class="math inline">\(H_3:\)</span>in <em><a href="#sec-h3-explore" class="quarto-xref"><span>Section 10.5</span></a></em>:</p>
<ul>
<li><p>I plot the distributions of <span class="math inline">\(surfaceArea\)</span>, <span class="math inline">\(nidStorage\)</span>, and <span class="math inline">\(\frac{surfaceArea}{nidStorage}\)</span> aggregated by <code>state_abb</code> and <code>nidHeigthId</code>.</p></li>
<li><p>I use the same data set as in <span class="math inline">\(H_2\)</span> and run linear regressions predicting <span class="math inline">\(tri\_mean_{dam}\)</span> using various models to check which models explain the most variance.</p></li>
</ul>
<p><br></p>
</section>
</section>
<section id="sec-h1-explore" class="level2 page-columns page-full" data-number="10.3">
<h2 data-number="10.3" class="anchored" data-anchor-id="sec-h1-explore"><span class="header-section-number">10.3</span> Exploring H<sub>1</sub> : Local terrain ruggedness in the area around dams is greater than the ruggedness of areas around randomly sampled points in the contentinental US states</h2>
<p>The area around a dam has greater terrain ruggedness than its paired state sample if</p>
<p><span class="math display">\[tri\_mean_{dam} - tri\_mean_{sample} &gt; 0\]</span></p>
<p>When the differences in <span class="math inline">\(tri\_mean_{dam}\)</span> and <span class="math inline">\(tri\_mean_{sample}\)</span> are aggregated by state, region, or other property, their distributions and differences in distribution medians allow us to make some generalizations:</p>
<p><span class="math display">\[{median(tri\_mean_{dam} - tri\_mean_{sample})} &gt; 0\]</span></p>
<p>for some aggregation.</p>
<section id="first-dam-and-sample-distributions" class="level3 page-columns page-full" data-number="10.3.1">
<h3 data-number="10.3.1" class="anchored" data-anchor-id="first-dam-and-sample-distributions"><span class="header-section-number">10.3.1</span> First: dam and sample distributions</h3>
<p>Of note re: <a href="#fig-dam-local-area-tri-summary-density-by-state" class="quarto-xref">Figure&nbsp;<span>10.1</span></a>:</p>
<ol type="1">
<li><p>There is a lot of variation in the distributions and median tri_means of <span class="math inline">\(tri\_mean_{dam}\)</span> and <span class="math inline">\(tri\_mean_{sample}\)</span> by state. And I didn’t expect West Virginia to have the highest median <span class="math inline">\(tri\_mean_{sample}\)</span>.</p></li>
<li><p>While there are states that have high median <span class="math inline">\(tri\_mean_{dam}\)</span> for the local areas around some dams, there is no concentration in the distributions at these higher values. Ruggedness varies a lot more than flatness.</p></li>
<li><p>There is wide variation in number of points in each state, proportional to the number of dams in the state. DE has the fewest points: 471,661, which is more than enough for my purposes.</p></li>
</ol>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>dta_for_plot <span class="ot">&lt;-</span> state_dam_tri_summary_df <span class="sc">|&gt;</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">state_mean_dam =</span> <span class="fu">weighted.mean</span>(tri_mean_dam, <span class="at">w =</span> tri_n_dam),</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">state_median_dam =</span> <span class="fu">median</span>(tri_mean_dam),</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">.by =</span> <span class="fu">c</span>(state_abb, state_region, region_label)) <span class="sc">|&gt;</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">state_abb =</span> <span class="fu">fct_reorder</span>(state_abb, state_median_dam))</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>p1_dam_state <span class="ot">&lt;-</span> dta_for_plot <span class="sc">|&gt;</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density_ridges</span>(</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(tri_mean_dam, state_abb, <span class="at">fill =</span> region_label),</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">rel_min_height =</span> <span class="fl">0.005</span>,</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.1</span>,</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="cn">NA</span>,</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> state_dam_tri_summary_df <span class="sc">|&gt;</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">state_mean_dam =</span> <span class="fu">weighted.mean</span>(tri_mean_dam, <span class="at">w =</span> tri_n_dam),</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">state_median_dam =</span> <span class="fu">median</span>(tri_mean_dam),</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">.by =</span> state_abb</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">|&gt;</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>      <span class="fu">distinct</span>(state_abb, state_median_dam),</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(state_median_dam, state_abb, <span class="at">label =</span> <span class="st">"^"</span>),</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">4</span>,</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.75</span>,</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"firebrick"</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"firebrick"</span>, <span class="st">"darkslategrey"</span>, <span class="st">"blue"</span>, <span class="st">"skyblue"</span>)) <span class="sc">+</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">position =</span> <span class="st">"inside"</span>)) <span class="sc">+</span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position.inside =</span> <span class="fu">c</span>(<span class="fl">0.75</span>, <span class="fl">0.2</span>)) <span class="sc">+</span></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">28</span>)) <span class="sc">+</span></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"A. Distribution of tri_mean&lt;sub&gt;dam&lt;/sub&gt;&lt;br&gt;"</span>,</span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="cn">NULL</span></span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> dta_for_plot <span class="sc">|&gt;</span></span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(</span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(tri_n_dam, state_abb, <span class="at">fill =</span> region_label),</span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.1</span>,</span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="cn">NA</span>,</span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> <span class="fu">label_number</span>(<span class="at">scale_cut =</span> <span class="fu">cut_short_scale</span>())) <span class="sc">+</span></span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"firebrick"</span>, <span class="st">"darkslategrey"</span>, <span class="st">"blue"</span>, <span class="st">"skyblue"</span>)) <span class="sc">+</span></span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"B. Number of TRI values&lt;br&gt;"</span>,</span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="cn">NULL</span></span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>p1_dam_state <span class="sc">+</span> p2 <span class="sc">+</span></span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribution of *tri_mean&lt;sub&gt;dam&lt;/sub&gt;* for local areas around dams"</span>,</span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Red indicator is median tri_mean&lt;sub&gt;dam&lt;/sub&gt;&lt;br&gt;"</span>,</span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> my_caption_nid_opentopography</span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">&amp;</span></span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_textbox_simple</span>(),</span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_textbox_simple</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div id="fig-dam-local-area-tri-summary-density-by-state" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-dam-local-area-tri-summary-density-by-state-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="page-columns page-full">
<img src="ruggedness_files/figure-html/fig-dam-local-area-tri-summary-density-by-state-1.png" class="img-fluid figure-img column-page-right" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-dam-local-area-tri-summary-density-by-state-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10.1: Distributions of tri_mean<sub>dam</sub> in areas around dams in each state
</figcaption>
</figure>
</div>
</div>
</div>
<p><br></p>
<p>Of note re: <a href="#fig-dam-local-area-tri-summary-density-non-state" class="quarto-xref">Figure&nbsp;<span>10.2</span></a></p>
<ul>
<li><p>The Northeast and West regions have the highest median <span class="math inline">\(tri\_mean_{dam}\)</span> (panel A).</p></li>
<li><p>The median <span class="math inline">\(tri\_mean_{dam}\)</span> is higher for every higher category of <code>nidHeightId</code> (panel B).</p></li>
</ul>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>dta_for_plot <span class="ot">&lt;-</span> state_dam_tri_summary_df <span class="sc">|&gt;</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">region_mean_dam =</span> <span class="fu">weighted.mean</span>(tri_mean_dam, <span class="at">w =</span> tri_n_dam),</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">region_median_dam =</span> <span class="fu">median</span>(tri_mean_dam),</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">.by =</span> <span class="fu">c</span>(region_label))</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>dta_for_plot_p1_region_medians <span class="ot">&lt;-</span> dta_for_plot <span class="sc">|&gt;</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(region_label, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>p1_dam_region <span class="ot">&lt;-</span> dta_for_plot <span class="sc">|&gt;</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(tri_mean_dam, <span class="at">fill =</span> region_label),</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.1</span>,</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="cn">NA</span>,</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> dta_for_plot_p1_region_medians,</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(region_median_dam, <span class="dv">0</span>, <span class="at">label =</span> <span class="st">"^"</span>),</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">4</span>,</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.75</span>,</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"firebrick"</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> dta_for_plot_p1_region_medians,</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x=</span> <span class="fu">I</span>(<span class="fl">0.7</span>), <span class="at">y =</span> <span class="fu">I</span>(<span class="fl">0.8</span>), </span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">label =</span> <span class="fu">glue</span>(<span class="st">"Median: {round(region_median_dam, digits = 1)}"</span>)</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"firebrick"</span>, <span class="st">"darkslategrey"</span>, <span class="st">"blue"</span>, <span class="st">"skyblue"</span>)) <span class="sc">+</span></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>region_label, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">55</span>)) <span class="sc">+</span></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"A. Distribution of tri_mean&lt;sub&gt;dam&lt;/sub&gt;</span><span class="sc">\n</span><span class="st">by region&lt;br&gt;"</span>,</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="cn">NULL</span></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>dta_for_plot_p2 <span class="ot">&lt;-</span> dams_with_tri <span class="sc">|&gt;</span></span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_drop_geometry</span>() <span class="sc">|&gt;</span></span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(nidHeightId <span class="sc">!=</span> <span class="st">"Undetermined"</span>) <span class="sc">|&gt;</span></span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(nidId, state_abb, nidHeight, nidHeightId, <span class="fu">starts_with</span>(<span class="st">"tri"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nidHeightId_tri_mean_dam =</span> <span class="fu">weighted.mean</span>(tri_mean_dam, <span class="at">w =</span> tri_n_dam),</span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>         <span class="at">nidHeightId_tri_median_dam =</span> <span class="fu">median</span>(tri_mean_dam),</span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>         <span class="at">.by =</span> nidHeightId)</span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>dta_for_plot_p2_nidHeightId_medians <span class="ot">&lt;-</span> dta_for_plot_p2 <span class="sc">|&gt;</span></span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(nidHeightId, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>p2_dam_nidHeightId <span class="ot">&lt;-</span> dta_for_plot_p2 <span class="sc">|&gt;</span></span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(</span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(tri_mean_dam),</span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.1</span>,</span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"grey80"</span>,</span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="cn">NA</span>,</span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> dta_for_plot_p2_nidHeightId_medians,</span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(nidHeightId_tri_median_dam, <span class="dv">0</span>, <span class="at">label =</span> <span class="st">"^"</span>),</span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">4</span>,</span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.75</span>,</span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"firebrick"</span></span>
<span id="cb5-64"><a href="#cb5-64" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-65"><a href="#cb5-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb5-66"><a href="#cb5-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> dta_for_plot_p2_nidHeightId_medians,</span>
<span id="cb5-67"><a href="#cb5-67" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x=</span> <span class="fu">I</span>(<span class="fl">0.7</span>), <span class="at">y =</span> <span class="fu">I</span>(<span class="fl">0.8</span>), </span>
<span id="cb5-68"><a href="#cb5-68" aria-hidden="true" tabindex="-1"></a>        <span class="at">label =</span> <span class="fu">glue</span>(<span class="st">"Median: {round(nidHeightId_tri_median_dam, digits = 1)}"</span>)</span>
<span id="cb5-69"><a href="#cb5-69" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb5-70"><a href="#cb5-70" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-71"><a href="#cb5-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>nidHeightId, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb5-72"><a href="#cb5-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">55</span>)) <span class="sc">+</span></span>
<span id="cb5-73"><a href="#cb5-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb5-74"><a href="#cb5-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"B. Distribution of tri_mean&lt;sub&gt;dam&lt;/sub&gt;</span><span class="sc">\n</span><span class="st">by nidHeightId&lt;br&gt;"</span>,</span>
<span id="cb5-75"><a href="#cb5-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="cn">NULL</span></span>
<span id="cb5-76"><a href="#cb5-76" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-77"><a href="#cb5-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-78"><a href="#cb5-78" aria-hidden="true" tabindex="-1"></a>p1_dam_region <span class="sc">+</span> p2_dam_nidHeightId <span class="sc">+</span></span>
<span id="cb5-79"><a href="#cb5-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb5-80"><a href="#cb5-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribution of *tri_mean&lt;sub&gt;dam&lt;/sub&gt;* for local areas around dams"</span>,</span>
<span id="cb5-81"><a href="#cb5-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Red indicator is median tri_mean&lt;sub&gt;dam&lt;/sub&gt;&lt;br&gt;"</span>,</span>
<span id="cb5-82"><a href="#cb5-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> my_caption_nid_opentopography</span>
<span id="cb5-83"><a href="#cb5-83" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">&amp;</span></span>
<span id="cb5-84"><a href="#cb5-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_textbox_simple</span>(),</span>
<span id="cb5-85"><a href="#cb5-85" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_textbox_simple</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div id="fig-dam-local-area-tri-summary-density-non-state" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-dam-local-area-tri-summary-density-non-state-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="page-columns page-full">
<img src="ruggedness_files/figure-html/fig-dam-local-area-tri-summary-density-non-state-1.png" class="img-fluid figure-img column-page-right" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-dam-local-area-tri-summary-density-non-state-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10.2: Distribution of tri_mean<sub>dam</sub> of areas around dams by nidHeightId and region
</figcaption>
</figure>
</div>
</div>
</div>
<p><br></p>
<p>Of note re: <a href="#fig-state-local-area-tri-summary-density-by-state" class="quarto-xref">Figure&nbsp;<span>10.3</span></a>:</p>
<ul>
<li>States with large flat areas as well as mountains have a distribution with a mode in low TRI values and a long tail. See for example, CO, NC, OH, TX (panel A).</li>
</ul>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>dta_for_plot <span class="ot">&lt;-</span> state_samples_tri_summary_df <span class="sc">|&gt;</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">state_mean_sample =</span> <span class="fu">weighted.mean</span>(tri_mean_sample, <span class="at">w =</span> tri_n_sample),</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">state_median_sample =</span> <span class="fu">median</span>(tri_mean_sample),</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">.by =</span> state_abb) <span class="sc">|&gt;</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">state_abb =</span> <span class="fu">fct_reorder</span>(state_abb, state_median_sample))</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>dta_for_plot2 <span class="ot">&lt;-</span> dta_for_plot <span class="sc">|&gt;</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">region_mean_sample =</span> <span class="fu">weighted.mean</span>(tri_mean_sample, <span class="at">w =</span> tri_n_sample),</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">region_median_sample =</span> <span class="fu">median</span>(tri_mean_sample),</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">.by =</span> region_label) <span class="co">#|&gt;</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># FYI: need to adjust factors to match regions in panel A if I use the fct_reorder() line below</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># mutate(region_label = fct_reorder(region_label, region_mean)) </span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>dta_for_plot2_region_medians <span class="ot">&lt;-</span> dta_for_plot2 <span class="sc">|&gt;</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(region_median_sample, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>p1_sample_state <span class="ot">&lt;-</span> dta_for_plot <span class="sc">|&gt;</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density_ridges</span>(</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(tri_mean_sample, state_abb, <span class="at">fill =</span> region_label),</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">rel_min_height =</span> <span class="fl">0.005</span>,</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.1</span>,</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="cn">NA</span>,</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> state_samples_tri_summary_df <span class="sc">|&gt;</span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">state_mean_sample =</span> <span class="fu">weighted.mean</span>(tri_mean_sample, <span class="at">w =</span> tri_n_sample),</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">state_median_sample =</span> <span class="fu">median</span>(tri_mean_sample),</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">.by =</span> state_abb</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">|&gt;</span></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>      <span class="fu">distinct</span>(state_abb, state_median_sample),</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(state_median_sample, state_abb, <span class="at">label =</span> <span class="st">"^"</span>),</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">4</span>,</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.75</span>,</span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"firebrick"</span></span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">10</span> <span class="sc">*</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"firebrick"</span>, <span class="st">"darkslategrey"</span>, <span class="st">"blue"</span>, <span class="st">"skyblue"</span>)) <span class="sc">+</span></span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">position =</span> <span class="st">"inside"</span>)) <span class="sc">+</span></span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position.inside =</span> <span class="fu">c</span>(<span class="fl">0.75</span>, <span class="fl">0.15</span>)) <span class="sc">+</span></span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">30</span>)) <span class="sc">+</span></span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"A. Distribution of tri_mean&lt;sub&gt;sample&lt;/sub&gt;&lt;br&gt;"</span>,</span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="cn">NULL</span></span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> dta_for_plot <span class="sc">|&gt;</span></span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(</span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(tri_n_sample, state_abb, <span class="at">fill =</span> region_label),</span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.1</span>,</span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="cn">NA</span>,</span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> <span class="fu">label_number</span>(<span class="at">scale_cut =</span> <span class="fu">cut_short_scale</span>())) <span class="sc">+</span></span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"firebrick"</span>, <span class="st">"darkslategrey"</span>, <span class="st">"blue"</span>, <span class="st">"skyblue"</span>)) <span class="sc">+</span></span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"B. Number of TRI values&lt;br&gt;"</span>,</span>
<span id="cb6-62"><a href="#cb6-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="cn">NULL</span></span>
<span id="cb6-63"><a href="#cb6-63" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb6-64"><a href="#cb6-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-65"><a href="#cb6-65" aria-hidden="true" tabindex="-1"></a>p1_sample_state <span class="sc">+</span> p2 <span class="sc">+</span></span>
<span id="cb6-66"><a href="#cb6-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb6-67"><a href="#cb6-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribution of *tri_mean&lt;sub&gt;sample&lt;/sub&gt;* for local area&lt;br&gt;around sampled points in each state"</span>,</span>
<span id="cb6-68"><a href="#cb6-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Red indicator is median tri_mean&lt;sub&gt;sample&lt;/sub&gt;&lt;br&gt;"</span>,</span>
<span id="cb6-69"><a href="#cb6-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> my_caption_nid_opentopography</span>
<span id="cb6-70"><a href="#cb6-70" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">&amp;</span></span>
<span id="cb6-71"><a href="#cb6-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_textbox_simple</span>(),</span>
<span id="cb6-72"><a href="#cb6-72" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_textbox_simple</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div id="fig-state-local-area-tri-summary-density-by-state" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-state-local-area-tri-summary-density-by-state-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="page-columns page-full">
<img src="ruggedness_files/figure-html/fig-state-local-area-tri-summary-density-by-state-1.png" class="img-fluid figure-img column-page-right" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-state-local-area-tri-summary-density-by-state-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10.3: Distribution of tri_mean<sub>sample</sub> for areas around randomly sampled points in each state
</figcaption>
</figure>
</div>
</div>
</div>
<p><br></p>
<p>Of note re: fig-state-local-area-tri-summary-density-non-state:</p>
<ul>
<li><p>Similar to <a href="#fig-dam-local-area-tri-summary-density-non-state" class="quarto-xref">Figure&nbsp;<span>10.2</span></a>, there is more variation in <span class="math inline">\(tri\_mean_{sample}\)</span> in the Northeast and West, which have higher median <span class="math inline">\(tri\_mean_{sample}\)</span> than the North Central and South regions (panel A).</p></li>
<li><p>North Central looks by eye to be the region with a distribution of <span class="math inline">\(tri\_mean_{sample}\)</span> closest to the overall distribution (panel B), however Northeast region has the closest median <span class="math inline">\(tri\_mean_{sample}\)</span>.</p></li>
</ul>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>dta_for_plot <span class="ot">&lt;-</span> state_samples_tri_summary_df <span class="sc">|&gt;</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">region_mean_sample =</span> <span class="fu">weighted.mean</span>(tri_mean_sample, <span class="at">w =</span> tri_n_sample),</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">region_median_sample =</span> <span class="fu">median</span>(tri_mean_sample),</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">.by =</span> <span class="fu">c</span>(region_label))</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>dta_for_plot_p1_region_medians <span class="ot">&lt;-</span> dta_for_plot <span class="sc">|&gt;</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(region_label, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>p1_sample_region <span class="ot">&lt;-</span> dta_for_plot <span class="sc">|&gt;</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(tri_median_sample, <span class="at">fill =</span> region_label),</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.1</span>,</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="cn">NA</span>,</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> dta_for_plot_p1_region_medians,</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(region_mean_sample, <span class="dv">0</span>, <span class="at">label =</span> <span class="st">"^"</span>),</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">4</span>,</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.75</span>,</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"firebrick"</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> dta_for_plot_p1_region_medians,</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x=</span> <span class="fu">I</span>(<span class="fl">0.7</span>), <span class="at">y =</span> <span class="fu">I</span>(<span class="fl">0.8</span>), </span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">label =</span> <span class="fu">glue</span>(<span class="st">"Median: {round(region_median_sample, digits = 1)}"</span>)</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"firebrick"</span>, <span class="st">"darkslategrey"</span>, <span class="st">"blue"</span>, <span class="st">"skyblue"</span>)) <span class="sc">+</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>region_label, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">55</span>)) <span class="sc">+</span></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"A. Distribution of tri_mean&lt;sub&gt;sample&lt;/sub&gt; by region&lt;br&gt;"</span>,</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="cn">NULL</span></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>dta_for_plot_p1_overall_median <span class="ot">&lt;-</span> dta_for_plot <span class="sc">|&gt;</span></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">overall_tri_median_sample =</span> <span class="fu">mean</span>(tri_mean_sample))</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>p2_sample_overall <span class="ot">&lt;-</span> dta_for_plot <span class="sc">|&gt;</span></span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(</span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(tri_mean_sample),</span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.1</span>,</span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"grey80"</span>,</span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="cn">NA</span>,</span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>    <span class="co"># alpha = 0.3</span></span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> dta_for_plot_p1_overall_median,</span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(overall_tri_median_sample, <span class="dv">0</span>, <span class="at">label =</span> <span class="st">"^"</span>),</span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">4</span>,</span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.75</span>,</span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"firebrick"</span></span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> dta_for_plot_p1_overall_median,</span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x=</span> <span class="fu">I</span>(<span class="fl">0.7</span>), <span class="at">y =</span> <span class="fu">I</span>(<span class="fl">0.8</span>), </span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a>        <span class="at">label =</span> <span class="fu">glue</span>(<span class="st">"Median: {round(overall_tri_median_sample, digits = 1)}"</span>)</span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb7-63"><a href="#cb7-63" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb7-64"><a href="#cb7-64" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~nidHeightId, ncol = 1) +</span></span>
<span id="cb7-65"><a href="#cb7-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">55</span>)) <span class="sc">+</span></span>
<span id="cb7-66"><a href="#cb7-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb7-67"><a href="#cb7-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"B. Distribution of tri_mean&lt;sub&gt;sample&lt;/sub&gt;&lt;br&gt;"</span>,</span>
<span id="cb7-68"><a href="#cb7-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="cn">NULL</span></span>
<span id="cb7-69"><a href="#cb7-69" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-70"><a href="#cb7-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-71"><a href="#cb7-71" aria-hidden="true" tabindex="-1"></a>p1_sample_region <span class="sc">+</span> p2_sample_overall <span class="sc">+</span></span>
<span id="cb7-72"><a href="#cb7-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb7-73"><a href="#cb7-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribution of *tri_mean&lt;sub&gt;sample&lt;/sub&gt;* for local areas around random points"</span>,</span>
<span id="cb7-74"><a href="#cb7-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Red indicator is median tri_mean&lt;sub&gt;sample&lt;/sub&gt;&lt;br&gt;"</span>,</span>
<span id="cb7-75"><a href="#cb7-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> my_caption_nid_opentopography</span>
<span id="cb7-76"><a href="#cb7-76" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">&amp;</span></span>
<span id="cb7-77"><a href="#cb7-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_textbox_simple</span>(),</span>
<span id="cb7-78"><a href="#cb7-78" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_textbox_simple</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div id="fig-state-local-area-tri-summary-density-non-state" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-state-local-area-tri-summary-density-non-state-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="page-columns page-full">
<img src="ruggedness_files/figure-html/fig-state-local-area-tri-summary-density-non-state-1.png" class="img-fluid figure-img column-page-right" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-state-local-area-tri-summary-density-non-state-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10.4: Distribution of tri_mean<sub>sample</sub> for areas around randomly sampled points in each state
</figcaption>
</figure>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="second-difference-in-tri_meandam---tri_meansample" class="level3 page-columns page-full" data-number="10.3.2">
<h3 data-number="10.3.2" class="anchored" data-anchor-id="second-difference-in-tri_meandam---tri_meansample"><span class="header-section-number">10.3.2</span> Second: difference in tri_mean<sub>dam</sub> - tri_mean<sub>sample</sub></h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>tri_dam_tmp <span class="ot">&lt;-</span> dams_with_tri <span class="sc">|&gt;</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">st_drop_geometry</span>() <span class="sc">|&gt;</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(nidId, state_abb, nidHeight, nidHeightId, nidStorage, surfaceArea, <span class="fu">starts_with</span>(<span class="st">"tri_"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(state_abb, tri_mean_dam)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>n_tri_dam_tmp <span class="ot">&lt;-</span> tri_dam_tmp <span class="sc">|&gt;</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(state_abb, <span class="at">name =</span> <span class="st">"n_dams"</span>)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>tri_sample_tmp <span class="ot">&lt;-</span> state_samples_tri_summary_df</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>check_n <span class="ot">&lt;-</span> <span class="fu">left_join</span>(</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  dams_with_tri <span class="sc">|&gt;</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">st_drop_geometry</span>() <span class="sc">|&gt;</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(state_abb, <span class="at">name =</span> <span class="st">"n_dam"</span>),</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  state_dam_tri_summary_df <span class="sc">|&gt;</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(state_abb, <span class="at">name =</span> <span class="st">"n_sample"</span>),</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">by =</span> <span class="st">"state_abb"</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_diff =</span> n_sample <span class="sc">-</span> n_dam</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Need n_diff to be zero for all states to pair tri_mean_dam and tri_mean_sample in dta_for_model</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">sum</span>(check_n<span class="sc">$</span>n_diff) <span class="sc">!=</span> <span class="dv">0</span>) {</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We have some work to do</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>  tri_sample_tmp2 <span class="ot">&lt;-</span> tri_sample_tmp <span class="sc">|&gt;</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(check_n,</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>              <span class="at">by =</span> <span class="st">"state_abb"</span>)</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">any</span>(check_n<span class="sc">$</span>n_diff) <span class="sc">&lt;</span> <span class="dv">0</span>) {</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"Code block define-tri-diff-model-data: at least one state has fewer rows of sample points than dams. Fix this manually."</span>)</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>  } </span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>  tri_sample_tmp3 <span class="ot">&lt;-</span> tri_sample_tmp2 <span class="sc">|&gt;</span></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>      <span class="at">test_n_sample =</span> n_sample <span class="sc">-</span> n_diff,</span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>      <span class="at">test_tri_mean_sample =</span> <span class="fu">if_else</span>(<span class="fu">row_number</span>() <span class="sc">&lt;=</span> n_diff,</span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>                              <span class="cn">NA_real_</span>,</span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>                              tri_mean_sample),</span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>      <span class="at">.by =</span> state_abb</span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(test_tri_mean_sample)) <span class="sc">|&gt;</span></span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="co">#test_tri_n_sample = test_tri_mean_sample,</span></span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>           <span class="at">n_diff2 =</span> test_n_sample <span class="sc">-</span> n_dam</span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span><span class="fu">starts_with</span>(<span class="st">"test"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a>    <span class="co"># </span><span class="al">TODO</span><span class="co">: solve the following kludge at source and remove this filter</span></span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>(state_abb <span class="sc">==</span> <span class="st">"TX"</span> <span class="sc">&amp;</span> <span class="fu">row_number</span>() <span class="sc">&lt;=</span><span class="dv">3</span>) <span class="sc">&amp;</span></span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a>             <span class="sc">!</span>(state_abb <span class="sc">==</span> <span class="st">"VT"</span> <span class="sc">&amp;</span> <span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">&amp;</span></span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a>             <span class="sc">!</span>(state_abb <span class="sc">==</span> <span class="st">"WV"</span> <span class="sc">&amp;</span> <span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>),</span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a>           <span class="at">.by =</span> state_abb)</span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a>  n_tri_sample_tmp3 <span class="ot">&lt;-</span> tri_sample_tmp3 <span class="sc">|&gt;</span></span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(state_abb, <span class="at">name =</span> <span class="st">"tri_sample_n2"</span>)</span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a>  tri_check_tmp <span class="ot">&lt;-</span> </span>
<span id="cb8-59"><a href="#cb8-59" aria-hidden="true" tabindex="-1"></a>    <span class="fu">inner_join</span>(</span>
<span id="cb8-60"><a href="#cb8-60" aria-hidden="true" tabindex="-1"></a>      n_tri_sample_tmp3,</span>
<span id="cb8-61"><a href="#cb8-61" aria-hidden="true" tabindex="-1"></a>      n_tri_dam_tmp,</span>
<span id="cb8-62"><a href="#cb8-62" aria-hidden="true" tabindex="-1"></a>      <span class="at">by =</span> <span class="fu">join_by</span>(state_abb)</span>
<span id="cb8-63"><a href="#cb8-63" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb8-64"><a href="#cb8-64" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">dif =</span> tri_sample_n2 <span class="sc">-</span> n_dams) <span class="sc">|&gt;</span></span>
<span id="cb8-65"><a href="#cb8-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(dif))</span>
<span id="cb8-66"><a href="#cb8-66" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-67"><a href="#cb8-67" aria-hidden="true" tabindex="-1"></a>  state_abb_levels <span class="ot">&lt;-</span> tri_dam_tmp <span class="sc">|&gt;</span></span>
<span id="cb8-68"><a href="#cb8-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">mean_tri_mean_dam =</span> <span class="fu">mean</span>(tri_mean_dam),</span>
<span id="cb8-69"><a href="#cb8-69" aria-hidden="true" tabindex="-1"></a>           <span class="at">.by =</span> state_abb</span>
<span id="cb8-70"><a href="#cb8-70" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb8-71"><a href="#cb8-71" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(mean_tri_mean_dam) <span class="sc">|&gt;</span></span>
<span id="cb8-72"><a href="#cb8-72" aria-hidden="true" tabindex="-1"></a>    <span class="fu">distinct</span>(state_abb, mean_tri_mean_dam) <span class="sc">|&gt;</span></span>
<span id="cb8-73"><a href="#cb8-73" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">state_abb =</span> <span class="fu">as_factor</span>(state_abb)) <span class="co"># keeps current order</span></span>
<span id="cb8-74"><a href="#cb8-74" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-75"><a href="#cb8-75" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb8-76"><a href="#cb8-76" aria-hidden="true" tabindex="-1"></a>  <span class="co"># no adjustments needed</span></span>
<span id="cb8-77"><a href="#cb8-77" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-78"><a href="#cb8-78" aria-hidden="true" tabindex="-1"></a>  state_tri_tmp3 <span class="ot">&lt;-</span> tri_dam_tmp <span class="co">#</span></span>
<span id="cb8-79"><a href="#cb8-79" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-80"><a href="#cb8-80" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-81"><a href="#cb8-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-82"><a href="#cb8-82" aria-hidden="true" tabindex="-1"></a>dta_for_model <span class="ot">&lt;-</span> </span>
<span id="cb8-83"><a href="#cb8-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(</span>
<span id="cb8-84"><a href="#cb8-84" aria-hidden="true" tabindex="-1"></a>    tri_sample_tmp3 <span class="sc">|&gt;</span></span>
<span id="cb8-85"><a href="#cb8-85" aria-hidden="true" tabindex="-1"></a>      <span class="fu">group_by</span>(state_abb) <span class="sc">|&gt;</span></span>
<span id="cb8-86"><a href="#cb8-86" aria-hidden="true" tabindex="-1"></a>      <span class="fu">arrange</span>(tri_mean_sample,</span>
<span id="cb8-87"><a href="#cb8-87" aria-hidden="true" tabindex="-1"></a>              <span class="at">.by_group =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb8-88"><a href="#cb8-88" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ungroup</span>(),</span>
<span id="cb8-89"><a href="#cb8-89" aria-hidden="true" tabindex="-1"></a>    tri_dam_tmp <span class="sc">|&gt;</span></span>
<span id="cb8-90"><a href="#cb8-90" aria-hidden="true" tabindex="-1"></a>      <span class="fu">group_by</span>(state_abb) <span class="sc">|&gt;</span></span>
<span id="cb8-91"><a href="#cb8-91" aria-hidden="true" tabindex="-1"></a>      <span class="fu">arrange</span>(tri_mean_dam,</span>
<span id="cb8-92"><a href="#cb8-92" aria-hidden="true" tabindex="-1"></a>              <span class="at">.by_group =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb8-93"><a href="#cb8-93" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb8-94"><a href="#cb8-94" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(<span class="sc">-</span>state_abb) <span class="co"># already in state_tri_tmp</span></span>
<span id="cb8-95"><a href="#cb8-95" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb8-96"><a href="#cb8-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tri_diff_dam_sample =</span> tri_mean_dam <span class="sc">-</span> tri_mean_sample,</span>
<span id="cb8-97"><a href="#cb8-97" aria-hidden="true" tabindex="-1"></a>         <span class="at">area_to_volume_dam =</span> surfaceArea <span class="sc">/</span> nidStorage,</span>
<span id="cb8-98"><a href="#cb8-98" aria-hidden="true" tabindex="-1"></a>         <span class="at">state_abb =</span> <span class="fu">factor</span>(state_abb, <span class="at">levels =</span> state_abb_levels<span class="sc">$</span>state_abb)</span>
<span id="cb8-99"><a href="#cb8-99" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">|&gt;</span></span>
<span id="cb8-100"><a href="#cb8-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(nidId <span class="sc">!=</span> <span class="st">"NM00039"</span>, <span class="co"># surfaceArea seems to be an error (or very major outlier)</span></span>
<span id="cb8-101"><a href="#cb8-101" aria-hidden="true" tabindex="-1"></a>         nidId <span class="sc">!=</span> <span class="st">"MI00650"</span>) <span class="co"># Lake Superior adjustments as noted in an earlier chapter</span></span>
<span id="cb8-102"><a href="#cb8-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-103"><a href="#cb8-103" aria-hidden="true" tabindex="-1"></a>n_dams_by_nidHeightId <span class="ot">&lt;-</span> dta_for_model <span class="sc">|&gt;</span></span>
<span id="cb8-104"><a href="#cb8-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(nidHeightId) <span class="sc">|&gt;</span></span>
<span id="cb8-105"><a href="#cb8-105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb8-106"><a href="#cb8-106" aria-hidden="true" tabindex="-1"></a>    <span class="at">supports_h1 =</span> nidHeightId <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Less than 25 feet"</span>, <span class="st">"25-50 feet"</span>)</span>
<span id="cb8-107"><a href="#cb8-107" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb8-108"><a href="#cb8-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-109"><a href="#cb8-109" aria-hidden="true" tabindex="-1"></a>n_dams_support_h1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(n_dams_by_nidHeightId[n_dams_by_nidHeightId<span class="sc">$</span>supports_h1, ]<span class="sc">$</span>n)</span>
<span id="cb8-110"><a href="#cb8-110" aria-hidden="true" tabindex="-1"></a>pct_dams_support_h1 <span class="ot">&lt;-</span> n_dams_support_h1 <span class="sc">/</span> <span class="fu">sum</span>(n_dams_by_nidHeightId<span class="sc">$</span>n)</span>
<span id="cb8-111"><a href="#cb8-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-112"><a href="#cb8-112" aria-hidden="true" tabindex="-1"></a>states_support_h1 <span class="ot">&lt;-</span> dta_for_model <span class="sc">|&gt;</span></span>
<span id="cb8-113"><a href="#cb8-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb8-114"><a href="#cb8-114" aria-hidden="true" tabindex="-1"></a>    <span class="at">supports_h1 =</span> tri_mean_dam <span class="sc">&gt;</span> tri_mean_sample </span>
<span id="cb8-115"><a href="#cb8-115" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb8-116"><a href="#cb8-116" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(</span>
<span id="cb8-117"><a href="#cb8-117" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_dams_state =</span> <span class="fu">n</span>(),</span>
<span id="cb8-118"><a href="#cb8-118" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_dams_state_support_h1 =</span> <span class="fu">sum</span>(supports_h1),</span>
<span id="cb8-119"><a href="#cb8-119" aria-hidden="true" tabindex="-1"></a>    <span class="at">.by =</span> state_abb</span>
<span id="cb8-120"><a href="#cb8-120" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb8-121"><a href="#cb8-121" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb8-122"><a href="#cb8-122" aria-hidden="true" tabindex="-1"></a>    <span class="at">pct_dams_in_state_support_h1 =</span> n_dams_state_support_h1 <span class="sc">/</span> n_dams_state</span>
<span id="cb8-123"><a href="#cb8-123" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb8-124"><a href="#cb8-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-125"><a href="#cb8-125" aria-hidden="true" tabindex="-1"></a>n_states_support_h1 <span class="ot">&lt;-</span> states_support_h1 <span class="sc">|&gt;</span></span>
<span id="cb8-126"><a href="#cb8-126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(pct_dams_in_state_support_h1 <span class="sc">&gt;</span> <span class="fl">0.5</span>) <span class="sc">|&gt;</span></span>
<span id="cb8-127"><a href="#cb8-127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Of note re: <a href="#fig-mean-tri-diff-dam-and-state-by-state" class="quarto-xref">Figure&nbsp;<span>10.5</span></a> and related data:</p>
<p>Aggregations in which <span class="math inline">\(median({tri\_mean_{dam} - tri\_mean_{sample}}) &gt; 0\)</span> have a higher terrain ruggedness than the state in general. The panels in <a href="#fig-mean-tri-diff-dam-and-state-by-state" class="quarto-xref">Figure&nbsp;<span>10.5</span></a> reveal the following:</p>
<ul>
<li><p>Panel A: there is a lot of variation in the distributions by state.</p>
<ul>
<li><p>30 of 48 states (62%) have positive <span class="math inline">\({median(tri\_mean_{dam} - tri\_mean_{sample})} &gt; 0\)</span>, supporting <span class="math inline">\(H_1\)</span>.</p></li>
<li><p>in flatter states <span class="math inline">\(H_1\)</span> holds true. In mountainous states it does not.</p></li>
</ul></li>
<li><p>Panel B: the median for all dams and samples is slightly positive, supporting <span class="math inline">\(H_1\)</span>.</p></li>
<li><p>Panel C: North Central and South regions have a (mildly) positive median. These, the flattest regions, support <span class="math inline">\(H_1\)</span>.</p></li>
<li><p>Panel D:<code>nidHeightId</code> categories &lt; 50 ft have positive means, which includes most dams</p>
<ul>
<li>79305 of 85854 (92%) support <span class="math inline">\(H_1\)</span>.</li>
</ul></li>
</ul>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>data_for_plot <span class="ot">&lt;-</span> dta_for_model <span class="sc">|&gt;</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">state_abb =</span> <span class="fu">fct_reorder</span>(state_abb, tri_diff_dam_sample))</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>p1_medians <span class="ot">&lt;-</span> data_for_plot <span class="sc">|&gt;</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">state_median =</span> <span class="fu">median</span>(tri_diff_dam_sample),</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">.by =</span> state_abb)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>p1_diff_dam_sample <span class="ot">&lt;-</span> data_for_plot <span class="sc">|&gt;</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density_ridges</span>(</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(tri_diff_dam_sample, state_abb, <span class="at">fill =</span> region_label),</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">rel_min_height =</span> <span class="fl">0.005</span>,</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">quantile_lines =</span> <span class="cn">TRUE</span>,</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">quantiles =</span> <span class="dv">2</span>,</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.1</span>,</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="cn">NA</span>,</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">xintercept =</span> <span class="dv">0</span>,</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">lty =</span> <span class="dv">2</span>,</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.25</span>,</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> p1_medians,</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(state_median, state_abb, <span class="at">label =</span> <span class="st">"^"</span>),</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">4</span>,</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.75</span>,</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"firebrick"</span></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"firebrick"</span>, <span class="st">"darkslategrey"</span>, <span class="st">"blue"</span>, <span class="st">"skyblue"</span>)) <span class="sc">+</span></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">position =</span> <span class="st">"inside"</span>)) <span class="sc">+</span></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position.inside =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.85</span>)) <span class="sc">+</span></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">13</span>, <span class="dv">6</span>)) <span class="sc">+</span></span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"A. By state"</span>,</span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="cn">NULL</span>,</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Region (n=states)"</span></span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>p2_median <span class="ot">&lt;-</span> data_for_plot <span class="sc">|&gt;</span></span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">state_median =</span> <span class="fu">median</span>(tri_diff_dam_sample))</span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>p2_diff_all <span class="ot">&lt;-</span> data_for_plot <span class="sc">|&gt;</span></span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(</span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(tri_diff_dam_sample),</span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.1</span>,</span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"grey80"</span>,</span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"grey80"</span>,</span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a>    <span class="co"># alpha = 0.5</span></span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(</span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">xintercept =</span> <span class="dv">0</span>,</span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">lty =</span> <span class="dv">2</span>,</span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.25</span>,</span>
<span id="cb9-57"><a href="#cb9-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb9-58"><a href="#cb9-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb9-59"><a href="#cb9-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> p2_median,</span>
<span id="cb9-60"><a href="#cb9-60" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(state_median, <span class="dv">0</span>, <span class="at">label =</span> <span class="st">"^"</span>),</span>
<span id="cb9-61"><a href="#cb9-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">4</span>,</span>
<span id="cb9-62"><a href="#cb9-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.75</span>,</span>
<span id="cb9-63"><a href="#cb9-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"firebrick"</span></span>
<span id="cb9-64"><a href="#cb9-64" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb9-65"><a href="#cb9-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"firebrick"</span>, <span class="st">"darkslategrey"</span>, <span class="st">"blue"</span>, <span class="st">"skyblue"</span>)) <span class="sc">+</span></span>
<span id="cb9-66"><a href="#cb9-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb9-67"><a href="#cb9-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span> <span class="fu">I</span>(<span class="fl">0.3</span>), <span class="at">y =</span> <span class="fu">I</span>(<span class="fl">0.8</span>), <span class="at">label =</span> <span class="fu">glue</span>(<span class="st">"Median: {round(p2_median$state_median, digits = 2)}"</span>)) <span class="sc">+</span></span>
<span id="cb9-68"><a href="#cb9-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb9-69"><a href="#cb9-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"B. All in one"</span></span>
<span id="cb9-70"><a href="#cb9-70" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb9-71"><a href="#cb9-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-72"><a href="#cb9-72" aria-hidden="true" tabindex="-1"></a>p3_medians <span class="ot">&lt;-</span> data_for_plot <span class="sc">|&gt;</span></span>
<span id="cb9-73"><a href="#cb9-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">median_tri_diff_dam_state =</span> <span class="fu">median</span>(tri_diff_dam_sample),</span>
<span id="cb9-74"><a href="#cb9-74" aria-hidden="true" tabindex="-1"></a>            <span class="at">.by =</span> region_label)</span>
<span id="cb9-75"><a href="#cb9-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-76"><a href="#cb9-76" aria-hidden="true" tabindex="-1"></a>p3_diff_region <span class="ot">&lt;-</span> data_for_plot <span class="sc">|&gt;</span></span>
<span id="cb9-77"><a href="#cb9-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb9-78"><a href="#cb9-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(</span>
<span id="cb9-79"><a href="#cb9-79" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(tri_diff_dam_sample, <span class="at">fill =</span> region_label),</span>
<span id="cb9-80"><a href="#cb9-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.1</span>,</span>
<span id="cb9-81"><a href="#cb9-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="cn">NA</span>,</span>
<span id="cb9-82"><a href="#cb9-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb9-83"><a href="#cb9-83" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb9-84"><a href="#cb9-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(</span>
<span id="cb9-85"><a href="#cb9-85" aria-hidden="true" tabindex="-1"></a>    <span class="at">xintercept =</span> <span class="dv">0</span>,</span>
<span id="cb9-86"><a href="#cb9-86" aria-hidden="true" tabindex="-1"></a>    <span class="at">lty =</span> <span class="dv">2</span>,</span>
<span id="cb9-87"><a href="#cb9-87" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.25</span>,</span>
<span id="cb9-88"><a href="#cb9-88" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb9-89"><a href="#cb9-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb9-90"><a href="#cb9-90" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> p3_medians,</span>
<span id="cb9-91"><a href="#cb9-91" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(median_tri_diff_dam_state, <span class="dv">0</span>, <span class="at">label =</span> <span class="st">"^"</span>),</span>
<span id="cb9-92"><a href="#cb9-92" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">4</span>,</span>
<span id="cb9-93"><a href="#cb9-93" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.75</span>,</span>
<span id="cb9-94"><a href="#cb9-94" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"firebrick"</span></span>
<span id="cb9-95"><a href="#cb9-95" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb9-96"><a href="#cb9-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb9-97"><a href="#cb9-97" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> p3_medians,</span>
<span id="cb9-98"><a href="#cb9-98" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x=</span> <span class="fu">I</span>(<span class="fl">0.3</span>), <span class="at">y =</span> <span class="fu">I</span>(<span class="fl">0.8</span>), </span>
<span id="cb9-99"><a href="#cb9-99" aria-hidden="true" tabindex="-1"></a>        <span class="at">label =</span> <span class="fu">glue</span>(<span class="st">"Median: {round(median_tri_diff_dam_state, digits = 1)}"</span>)</span>
<span id="cb9-100"><a href="#cb9-100" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb9-101"><a href="#cb9-101" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb9-102"><a href="#cb9-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"firebrick"</span>, <span class="st">"darkslategrey"</span>, <span class="st">"blue"</span>, <span class="st">"skyblue"</span>)) <span class="sc">+</span></span>
<span id="cb9-103"><a href="#cb9-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb9-104"><a href="#cb9-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>region_label, <span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb9-105"><a href="#cb9-105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb9-106"><a href="#cb9-106" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"C. By region"</span>,</span>
<span id="cb9-107"><a href="#cb9-107" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="cn">NULL</span></span>
<span id="cb9-108"><a href="#cb9-108" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb9-109"><a href="#cb9-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-110"><a href="#cb9-110" aria-hidden="true" tabindex="-1"></a>p4_medians <span class="ot">&lt;-</span> data_for_plot <span class="sc">|&gt;</span></span>
<span id="cb9-111"><a href="#cb9-111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">median_tri_diff_dam_state =</span> <span class="fu">median</span>(tri_diff_dam_sample),</span>
<span id="cb9-112"><a href="#cb9-112" aria-hidden="true" tabindex="-1"></a>            <span class="at">.by =</span> nidHeightId)</span>
<span id="cb9-113"><a href="#cb9-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-114"><a href="#cb9-114" aria-hidden="true" tabindex="-1"></a>p4_diff_nidHeightId <span class="ot">&lt;-</span> data_for_plot <span class="sc">|&gt;</span></span>
<span id="cb9-115"><a href="#cb9-115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb9-116"><a href="#cb9-116" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(</span>
<span id="cb9-117"><a href="#cb9-117" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(tri_diff_dam_sample, <span class="at">fill =</span> nidHeightId),</span>
<span id="cb9-118"><a href="#cb9-118" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.1</span>,</span>
<span id="cb9-119"><a href="#cb9-119" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="cn">NA</span>,</span>
<span id="cb9-120"><a href="#cb9-120" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb9-121"><a href="#cb9-121" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb9-122"><a href="#cb9-122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(</span>
<span id="cb9-123"><a href="#cb9-123" aria-hidden="true" tabindex="-1"></a>    <span class="at">xintercept =</span> <span class="dv">0</span>,</span>
<span id="cb9-124"><a href="#cb9-124" aria-hidden="true" tabindex="-1"></a>    <span class="at">lty =</span> <span class="dv">2</span>,</span>
<span id="cb9-125"><a href="#cb9-125" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.25</span>,</span>
<span id="cb9-126"><a href="#cb9-126" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb9-127"><a href="#cb9-127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb9-128"><a href="#cb9-128" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> p4_medians,</span>
<span id="cb9-129"><a href="#cb9-129" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(median_tri_diff_dam_state, <span class="dv">0</span>, <span class="at">label =</span> <span class="st">"^"</span>),</span>
<span id="cb9-130"><a href="#cb9-130" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">4</span>,</span>
<span id="cb9-131"><a href="#cb9-131" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.75</span>,</span>
<span id="cb9-132"><a href="#cb9-132" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"firebrick"</span></span>
<span id="cb9-133"><a href="#cb9-133" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb9-134"><a href="#cb9-134" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb9-135"><a href="#cb9-135" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> p4_medians,</span>
<span id="cb9-136"><a href="#cb9-136" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x=</span> <span class="fu">I</span>(<span class="fl">0.3</span>), <span class="at">y =</span> <span class="fu">I</span>(<span class="fl">0.8</span>), </span>
<span id="cb9-137"><a href="#cb9-137" aria-hidden="true" tabindex="-1"></a>        <span class="at">label =</span> <span class="fu">glue</span>(<span class="st">"Median: {round(median_tri_diff_dam_state, digits = 2)}"</span>)</span>
<span id="cb9-138"><a href="#cb9-138" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb9-139"><a href="#cb9-139" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb9-140"><a href="#cb9-140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"firebrick"</span>, <span class="st">"darkslategrey"</span>, <span class="st">"blue"</span>, <span class="st">"skyblue"</span>)) <span class="sc">+</span></span>
<span id="cb9-141"><a href="#cb9-141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb9-142"><a href="#cb9-142" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>nidHeightId, <span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb9-143"><a href="#cb9-143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb9-144"><a href="#cb9-144" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"D. By nidHeightId"</span>,</span>
<span id="cb9-145"><a href="#cb9-145" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="cn">NULL</span></span>
<span id="cb9-146"><a href="#cb9-146" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb9-147"><a href="#cb9-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-148"><a href="#cb9-148" aria-hidden="true" tabindex="-1"></a>p1_diff_dam_sample <span class="sc">+</span> (p2_diff_all <span class="sc">/</span> p3_diff_region <span class="sc">/</span> p4_diff_nidHeightId) <span class="sc">+</span></span>
<span id="cb9-149"><a href="#cb9-149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb9-150"><a href="#cb9-150" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distributions of *tri_mean&lt;sub&gt;dam&lt;/sub&gt; - tri_mean&lt;sub&gt;sample&lt;/sub&gt;*&lt;br&gt;"</span>,</span>
<span id="cb9-151"><a href="#cb9-151" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">glue</span>(<span class="st">"TRI means calculated from 5 km circles around each of {n_dams} dams"</span>,</span>
<span id="cb9-152"><a href="#cb9-152" aria-hidden="true" tabindex="-1"></a>                    <span class="st">" and same number of random samples in each state."</span>,</span>
<span id="cb9-153"><a href="#cb9-153" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"</span><span class="sc">\n</span><span class="st">Red indicators are median(tri_mean&lt;sub&gt;dam&lt;/sub&gt; - tri_mean&lt;sub&gt;sample&lt;/sub&gt;)&lt;br&gt;"</span>),</span>
<span id="cb9-154"><a href="#cb9-154" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> my_caption_nid_opentopography</span>
<span id="cb9-155"><a href="#cb9-155" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">&amp;</span></span>
<span id="cb9-156"><a href="#cb9-156" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_textbox_simple</span>(),</span>
<span id="cb9-157"><a href="#cb9-157" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_textbox_simple</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div id="fig-mean-tri-diff-dam-and-state-by-state" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-mean-tri-diff-dam-and-state-by-state-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="page-columns page-full">
<img src="ruggedness_files/figure-html/fig-mean-tri-diff-dam-and-state-by-state-1.png" class="img-fluid figure-img column-page-right" width="960">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mean-tri-diff-dam-and-state-by-state-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10.5: Distribution of dam tri_mean<sub>dam</sub> and tri_mean<sub>state sample</sub> by state
</figcaption>
</figure>
</div>
</div>
</div>
<p><br></p>
<p>Of note re: fig-three-tri-mean-distributions-by-date:</p>
<ul>
<li><p>This plot of distributions is a recap of earlier plots. I place them next to each other for easy comparison.</p></li>
<li><p>Where the distribution of <span class="math inline">\(tri\_mean_{dam}\)</span> (panel A) differs from <span class="math inline">\(tri\_mean_{sample}\)</span> (panel B), it tells us the ruggedness around dams is not representative of the state. For example, Colorado doesn’t seem to have many dams in the flat, eastern part of the state–or the dams in the eastern part are in relatively rare hilly areas. I also note that more distributions in panel B seem to have long tails of high <span class="math inline">\(tri\_mean_{sample}\)</span> values.</p></li>
<li><p>Panel C is ordered by the size of the difference <span class="math inline">\(tri\_mean_{dam} - tri\_mean_{sample}\)</span> for each state (a different ordering than panel A or B). States with a positive difference support <span class="math inline">\(H_1\)</span>; those near zero or negative challenge it.</p></li>
</ul>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>(p1_dam_state <span class="sc">+</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">"A. Distribution of tri_mean_dam"</span>)) <span class="sc">+</span> </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  (p1_sample_state <span class="sc">+</span> </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>     <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">"B. Distribution of tri_mean_sample"</span>)) <span class="sc">+</span> </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  (p1_diff_dam_sample <span class="sc">+</span> </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>     <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">"C. Distribution of tri_diff_dam_sample"</span>)) <span class="sc">+</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"tri_mean distributions"</span>,</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">glue</span>(<span class="st">"Red indicator is median tri_mean for each variable. Ordered by descending median."</span>,</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"</span><span class="sc">\n</span><span class="st">Note that each subplot orders the states differently."</span>),</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> my_caption_nid_opentopography</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">&amp;</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_textbox_simple</span>()) <span class="sc">&amp;</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div id="fig-three-tri-mean-distributions-by-date" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-three-tri-mean-distributions-by-date-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="page-columns page-full">
<img src="ruggedness_files/figure-html/fig-three-tri-mean-distributions-by-date-1.png" class="img-fluid figure-img column-page-right" width="960">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-three-tri-mean-distributions-by-date-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10.6: Distribution of TRI means in each state
</figcaption>
</figure>
</div>
</div>
</div>
<p><br></p>
<p>Of note re: <a href="#fig-tri-mean-sample-by-tri-mean-dam" class="quarto-xref">Figure&nbsp;<span>10.7</span></a>:</p>
<ul>
<li><p>Plots in panels A1 and B1 appear to show that <span class="math inline">\(tri\_mean_{sample}\)</span> exceeds <span class="math inline">\(tri\_mean_{dam}\)</span> in most cases, which would disprove <span class="math inline">\(H_1\)</span>.</p></li>
<li><p>However, panels A1 and B1 hide most of the data, which have low <span class="math inline">\(tri\_mean\)</span> values. The log-log plots in panels A2 and B2 show that in most cases, <span class="math inline">\(tri\_mean_{dam}\)</span> exceeds <span class="math inline">\(tri\_mean_{sample}\)</span>.</p></li>
<li><p>In other words, in flatter areas <span class="math inline">\(H_1\)</span> holds true. In mountainous areas it does not.</p></li>
</ul>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> dta_for_model <span class="sc">|&gt;</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(tri_mean_dam <span class="sc">&gt;</span> <span class="dv">0</span>,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>         tri_mean_sample <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(tri_mean_dam, tri_mean_sample, <span class="at">color =</span> state_abb, <span class="at">group =</span> state_abb)) <span class="sc">+</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.25</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.8</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">lty =</span> <span class="dv">2</span>,</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.25</span>,</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="cn">NA</span>),</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"A1. Line plot"</span>,</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"tri_mean_dam"</span>,</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"tri_mean_sample"</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>p1_log_log <span class="ot">&lt;-</span> dta_for_model <span class="sc">|&gt;</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(tri_mean_dam <span class="sc">&gt;</span> <span class="dv">0</span>,</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>         tri_mean_sample <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(tri_mean_dam, tri_mean_sample, <span class="at">color =</span> state_abb, <span class="at">group =</span> state_abb)) <span class="sc">+</span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.25</span>,</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.8</span></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">lty =</span> <span class="dv">2</span>,</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.25</span>,</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="cn">NA</span>),</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"A2. Line plot (log10 scales)"</span>,</span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"tri_mean_dam (log10 scale)"</span>,</span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"tri_mean_sample (log10 scale)"</span></span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> dta_for_model <span class="sc">|&gt;</span></span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(tri_mean_dam <span class="sc">&gt;</span> <span class="dv">0</span>,</span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>         tri_mean_sample <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(tri_mean_dam, tri_mean_sample, </span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> state_abb, <span class="at">group =</span> state_abb)) <span class="sc">+</span></span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(</span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">'gam'</span>,</span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> y <span class="sc">~</span> <span class="fu">s</span>(x, <span class="at">bs =</span> <span class="st">"cs"</span>),</span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.2</span>,</span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.8</span>,</span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(</span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">lty =</span> <span class="dv">2</span>,</span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.25</span>,</span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="cn">NA</span>),</span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb11-66"><a href="#cb11-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb11-67"><a href="#cb11-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb11-68"><a href="#cb11-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"B1. Regression line plot (same data)"</span>,</span>
<span id="cb11-69"><a href="#cb11-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"tri_mean_dam"</span>,</span>
<span id="cb11-70"><a href="#cb11-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"tri_mean_sample"</span></span>
<span id="cb11-71"><a href="#cb11-71" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb11-72"><a href="#cb11-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-73"><a href="#cb11-73" aria-hidden="true" tabindex="-1"></a>p2_log_log <span class="ot">&lt;-</span> dta_for_model <span class="sc">|&gt;</span></span>
<span id="cb11-74"><a href="#cb11-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(tri_mean_dam <span class="sc">&gt;</span> <span class="dv">0</span>,</span>
<span id="cb11-75"><a href="#cb11-75" aria-hidden="true" tabindex="-1"></a>         tri_mean_sample <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb11-76"><a href="#cb11-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(tri_mean_dam, tri_mean_sample, </span>
<span id="cb11-77"><a href="#cb11-77" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> state_abb, <span class="at">group =</span> state_abb)) <span class="sc">+</span></span>
<span id="cb11-78"><a href="#cb11-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(</span>
<span id="cb11-79"><a href="#cb11-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">'gam'</span>,</span>
<span id="cb11-80"><a href="#cb11-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> y <span class="sc">~</span> <span class="fu">s</span>(x, <span class="at">bs =</span> <span class="st">"cs"</span>),</span>
<span id="cb11-81"><a href="#cb11-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.2</span>,</span>
<span id="cb11-82"><a href="#cb11-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.8</span>,</span>
<span id="cb11-83"><a href="#cb11-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb11-84"><a href="#cb11-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(</span>
<span id="cb11-85"><a href="#cb11-85" aria-hidden="true" tabindex="-1"></a>    <span class="at">lty =</span> <span class="dv">2</span>,</span>
<span id="cb11-86"><a href="#cb11-86" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.25</span>,</span>
<span id="cb11-87"><a href="#cb11-87" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb11-88"><a href="#cb11-88" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb11-89"><a href="#cb11-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb11-90"><a href="#cb11-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb11-91"><a href="#cb11-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb11-92"><a href="#cb11-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="cn">NA</span>),</span>
<span id="cb11-93"><a href="#cb11-93" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb11-94"><a href="#cb11-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb11-95"><a href="#cb11-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb11-96"><a href="#cb11-96" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"B2. Regression line plot (log10 scales)"</span>,</span>
<span id="cb11-97"><a href="#cb11-97" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"tri_mean_dam (log10 scale)"</span>,</span>
<span id="cb11-98"><a href="#cb11-98" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"tri_mean_sample (log10 scale)"</span></span>
<span id="cb11-99"><a href="#cb11-99" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb11-100"><a href="#cb11-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-101"><a href="#cb11-101" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p1_log_log <span class="sc">+</span> p2 <span class="sc">+</span> p2_log_log <span class="sc">+</span></span>
<span id="cb11-102"><a href="#cb11-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb11-103"><a href="#cb11-103" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"tri_mean&lt;sub&gt;sample&lt;/sub&gt; by tri_mean&lt;sub&gt;dam&lt;/sub&gt; for each state"</span>,</span>
<span id="cb11-104"><a href="#cb11-104" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"In most states, tri_mean&lt;sub&gt;sample&lt;/sub&gt; is larger than tri_mean&lt;sub&gt;dam&lt;/sub&gt;, disproving H1&lt;br&gt;"</span>,</span>
<span id="cb11-105"><a href="#cb11-105" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> my_caption_nid_opentopography</span>
<span id="cb11-106"><a href="#cb11-106" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">&amp;</span></span>
<span id="cb11-107"><a href="#cb11-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_textbox_simple</span>(),</span>
<span id="cb11-108"><a href="#cb11-108" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_textbox_simple</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div id="fig-tri-mean-sample-by-tri-mean-dam" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-tri-mean-sample-by-tri-mean-dam-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="page-columns page-full">
<img src="ruggedness_files/figure-html/fig-tri-mean-sample-by-tri-mean-dam-1.png" class="img-fluid figure-img column-page-right" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-tri-mean-sample-by-tri-mean-dam-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10.7: Distribution of TRI means in each state
</figcaption>
</figure>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="regression-models" class="level3 page-columns page-full" data-number="10.3.3">
<h3 data-number="10.3.3" class="anchored" data-anchor-id="regression-models"><span class="header-section-number">10.3.3</span> Regression models</h3>
<p>I ordered <span class="math inline">\(tri\_mean_{dam}\)</span> and <span class="math inline">\(tri\_mean_{sample}\)</span> from smallest to largest in each state before combining them in <code>dta_for_model</code>. The data set includes 85,854 pairs in 48 states. DE has the least dams: 83. TX has the most dams: 7276.</p>
<p>Thus, when model mod.h1.1 <span class="math inline">\(tri\_mean_{dam} \sim \beta_1 tri\_mean_{sample} + \epsilon\)</span> has <span class="math inline">\(\beta_1 &gt; 1.0\)</span> , it would that <span class="math inline">\(tri\_mean_{dam}\)</span> in general is larger than <span class="math inline">\(tri\_mean_{sample}\)</span> , which would consistent with the conclusions from <a href="#fig-mean-tri-diff-dam-and-state-by-state" class="quarto-xref">Figure&nbsp;<span>10.5</span></a> in the prior section in supporting <span class="math inline">\(H_1\)</span>.</p>
<section id="sec-h1-mod1" class="level4" data-number="10.3.3.1">
<h4 data-number="10.3.3.1" class="anchored" data-anchor-id="sec-h1-mod1"><span class="header-section-number">10.3.3.1</span> Model mod.h1.1</h4>
<p>mod.h1.1 explains most of the variation: <span class="math inline">\(R^2 = 0.87\)</span>.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>mod.h1<span class="fl">.1</span> <span class="ot">&lt;-</span> dta_for_model <span class="sc">|&gt;</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(tri_mean_dam <span class="sc">~</span> tri_mean_sample,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">data =</span> _)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod.h1<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = tri_mean_dam ~ tri_mean_sample, data = dta_for_model)

Residuals:
     Min       1Q   Median       3Q      Max 
-12.3141  -0.4044  -0.1503   0.4948  20.5014 

Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     1.2566466  0.0071688   175.3   &lt;2e-16 ***
tri_mean_sample 0.6809898  0.0008868   768.0   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.641 on 85852 degrees of freedom
Multiple R-squared:  0.8729,    Adjusted R-squared:  0.8729 
F-statistic: 5.898e+05 on 1 and 85852 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p><br></p>
<p><span class="math inline">\(\beta_1\)</span> in <span class="math inline">\(\beta_1 tri\_mean_{dam}\)</span> is 0.68, meaning <span class="math inline">\(tri\_mean_{dam}\)</span> is on average 68% the size of <span class="math inline">\(tri\_mean_{sample}\)</span>, apparently disproving <span class="math inline">\(H_1\)</span>.</p>
<p>Note there is an implicit <span class="math inline">\(\left\{\beta_1,..\beta_n\right\}\)</span> before each term <span class="math inline">\(\left\{term_1,..term_n\right\}\)</span> in the regression formulas (and <span class="math inline">\(+ \epsilon\)</span>) at the end. For the sake of brevity and readability, I omit them from the formulas in the remainder of this chapter.</p>
<p><br></p>
</section>
<section id="sec-h1-mod2" class="level4" data-number="10.3.3.2">
<h4 data-number="10.3.3.2" class="anchored" data-anchor-id="sec-h1-mod2"><span class="header-section-number">10.3.3.2</span> Model mod.h1.2</h4>
<p>mod.h1.2 explains more than a third of the variance using only state means: <span class="math inline">\(R^2 = 0.43\)</span>. This is a base model useful when considering the variance explained by other models.</p>
<p><span class="math display">\[mod.h1.2: tri\_mean_{dam} \sim 1 | state\]</span></p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>mod.h1<span class="fl">.2</span> <span class="ot">&lt;-</span> dta_for_model <span class="sc">|&gt;</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="co">#tri_mean_sample_scaled = scale(tri_mean_sample),</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">tri_mean_dam_scaled =</span> <span class="fu">scale</span>(tri_mean_dam)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">|&gt;</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lmer</span>(tri_mean_dam_scaled <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> state_abb,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">data =</span> _)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod.h1<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: tri_mean_dam_scaled ~ 1 | state_abb
   Data: mutate(dta_for_model, tri_mean_dam_scaled = scale(tri_mean_dam))

REML criterion at convergence: 207681.1

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.5983 -0.4175 -0.1013  0.2144 14.4448 

Random effects:
 Groups    Name        Variance Std.Dev.
 state_abb (Intercept) 0.5590   0.7477  
 Residual              0.6552   0.8095  
Number of obs: 85854, groups:  state_abb, 48

Fixed effects:
            Estimate Std. Error t value
(Intercept)   0.2026     0.1080   1.876</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>r_squared <span class="ot">&lt;-</span> <span class="fu">rsq</span>(mod.h1<span class="fl">.2</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>rsq_comment <span class="ot">&lt;-</span> <span class="fu">glue</span>(</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"r_squared: {round(r_squared$model, digits = 3)}"</span>, </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>     <span class="st">"</span><span class="sc">\n</span><span class="st">consisting of fixed effects: {round(r_squared$fixed, digits = 3)}"</span>, </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>     <span class="st">" and random effects: {round(r_squared$random, digits = 3)}"</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><br></p>
<p>For this model, which includes only intercepts for each state: r_squared: 0.395 consisting of fixed effects: -0.041 and random effects: 0.436.</p>
<p><br></p>
</section>
<section id="sec-h1-mod3" class="level4 page-columns page-full" data-number="10.3.3.3">
<h4 data-number="10.3.3.3" class="anchored" data-anchor-id="sec-h1-mod3"><span class="header-section-number">10.3.3.3</span> Model mod.h1.3</h4>
<p>mod.h1.3 explains more than a third of the variance using only state means: <span class="math inline">\(R^2 = 0.39\)</span>. This is a base model useful when considering the variance explained by other models.</p>
<p><span class="math display">\[mod.h1.3: tri\_mean_{sample} \sim 1 | state\]</span></p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>mod.h1<span class="fl">.3</span> <span class="ot">&lt;-</span> dta_for_model <span class="sc">|&gt;</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tri_mean_sample_scaled =</span> <span class="fu">scale</span>(tri_mean_sample),</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>         <span class="co"># tri_mean_dam_scaled = scale(tri_mean_dam)</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">|&gt;</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lmer</span>(tri_mean_sample_scaled <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> state_abb,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">data =</span> _)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod.h1<span class="fl">.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: tri_mean_sample_scaled ~ 1 | state_abb
   Data: 
mutate(dta_for_model, tri_mean_sample_scaled = scale(tri_mean_sample),      )

REML criterion at convergence: 208106

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.4398 -0.3894 -0.1136  0.2037 10.8430 

Random effects:
 Groups    Name        Variance Std.Dev.
 state_abb (Intercept) 0.5491   0.7410  
 Residual              0.6585   0.8115  
Number of obs: 85854, groups:  state_abb, 48

Fixed effects:
            Estimate Std. Error t value
(Intercept)   0.1903     0.1070   1.778</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>r_squared <span class="ot">&lt;-</span> <span class="fu">rsq</span>(mod.h1<span class="fl">.3</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>rsq_comment <span class="ot">&lt;-</span> <span class="fu">glue</span>(</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"r_squared: {round(r_squared$model, digits = 3)}"</span>, </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>     <span class="st">"</span><span class="sc">\n</span><span class="st">consisting of fixed effects: {round(r_squared$fixed, digits = 3)}"</span>, </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>     <span class="st">" and random effects: {round(r_squared$random, digits = 3)}"</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><br></p>
<p>For this model, which includes only intercepts for each state: r_squared: 0.392 consisting of fixed effects: -0.036 and random effects: 0.429.</p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame</span>(<span class="fu">ranef</span>(mod.h1<span class="fl">.3</span>, <span class="at">condVar =</span> <span class="cn">FALSE</span>)) <span class="sc">|&gt;</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">state_abb =</span> grp) <span class="sc">|&gt;</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>grpvar) <span class="sc">|&gt;</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    states_and_regions,</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="fu">join_by</span>(state_abb)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">state_abb =</span> <span class="fu">fct_reorder</span>(state_abb, condval)) <span class="sc">|&gt;</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(condval, state_abb, <span class="at">fill =</span> region_label)) <span class="sc">+</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"firebrick"</span>, <span class="st">"darkslategrey"</span>, <span class="st">"blue"</span>, <span class="st">"skyblue"</span>)) <span class="sc">+</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">position =</span> <span class="st">"inside"</span>)) <span class="sc">+</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position.inside =</span> <span class="fu">c</span>(<span class="fl">0.75</span>, <span class="fl">0.2</span>)) <span class="sc">+</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"mod.h1.3 random effect</span><span class="sc">\n</span><span class="st">conditional means indicate</span><span class="sc">\n</span><span class="st">relative level of mean ruggedness"</span>,</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"West Virginia has the highest tri_mean, and Delaware has the lowest."</span>,</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Conditional mean"</span>,</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="cn">NULL</span>,</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> my_caption_nid_opentopography</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div id="fig-lmer-random-effect-conditional-means-mod-h1-3" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-lmer-random-effect-conditional-means-mod-h1-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="page-columns page-full">
<img src="ruggedness_files/figure-html/fig-lmer-random-effect-conditional-means-mod-h1-3-1.png" class="img-fluid figure-img column-page-right" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-lmer-random-effect-conditional-means-mod-h1-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10.8: mod.h1.3 random effect condidtional means
</figcaption>
</figure>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="sec-h1-mod4" class="level4" data-number="10.3.3.4">
<h4 data-number="10.3.3.4" class="anchored" data-anchor-id="sec-h1-mod4"><span class="header-section-number">10.3.3.4</span> Model mod.h1.4</h4>
<p>Better is a linear mixed model adjusting for states. mod.h1.3 explains even more of the variation: <span class="math inline">\(R^2 = 0.95\)</span>.</p>
<p><span class="math display">\[mod.h1.4: tri\_mean_{dam} \sim tri\_mean_{sample} | state\]</span></p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>mod.h1<span class="fl">.4</span> <span class="ot">&lt;-</span> dta_for_model <span class="sc">|&gt;</span> <span class="co"># dams_with_tri |&gt;</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tri_mean_dam_scaled =</span> <span class="fu">scale</span>(tri_mean_dam), </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">tri_mean_sample_scaled =</span> <span class="fu">scale</span>(tri_mean_sample))<span class="sc">|&gt;</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lmer</span>(tri_mean_dam_scaled <span class="sc">~</span> tri_mean_sample_scaled <span class="sc">+</span> state_abb <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> state_abb),</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">data =</span> _)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod.h1<span class="fl">.4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: tri_mean_dam_scaled ~ tri_mean_sample_scaled + state_abb + (1 |  
    state_abb)
   Data: mutate(dta_for_model, tri_mean_dam_scaled = scale(tri_mean_dam),  
    tri_mean_sample_scaled = scale(tri_mean_sample))

REML criterion at convergence: 13306.1

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-7.5624 -0.2065  0.0302  0.1899 19.8787 

Random effects:
 Groups    Name        Variance Std.Dev.
 state_abb (Intercept) 0.08446  0.2906  
 Residual              0.06809  0.2609  
Number of obs: 85854, groups:  state_abb, 48

Fixed effects:
                        Estimate Std. Error t value
(Intercept)            -0.130513   0.292026  -0.447
tri_mean_sample_scaled  0.944270   0.001098 860.165
state_abbFL             0.068811   0.412070   0.167
state_abbMI             0.013371   0.412073   0.032
state_abbLA             0.112335   0.412109   0.273
state_abbIL             0.069854   0.412043   0.170
state_abbMN             0.151334   0.412066   0.367
state_abbND             0.064370   0.412088   0.156
state_abbMS             0.076474   0.412005   0.186
state_abbTX             0.018921   0.412003   0.046
state_abbKS             0.154197   0.412029   0.374
state_abbWI             0.084184   0.412079   0.204
state_abbOK             0.056549   0.412009   0.137
state_abbNE             0.110183   0.412020   0.267
state_abbRI             0.154448   0.412364   0.375
state_abbIN             0.267030   0.412068   0.648
state_abbSD             0.163901   0.412025   0.398
state_abbSC             0.297093   0.412026   0.721
state_abbAL             0.047262   0.412030   0.115
state_abbIA             0.301910   0.412012   0.733
state_abbMO             0.094925   0.412008   0.230
state_abbGA             0.237632   0.412007   0.577
state_abbAR             0.047341   0.412058   0.115
state_abbNJ             0.378236   0.412097   0.918
state_abbOH             0.219358   0.412051   0.532
state_abbME             0.077980   0.412143   0.189
state_abbMD             0.309765   0.412198   0.751
state_abbMA             0.142192   0.412061   0.345
state_abbMT            -0.611956   0.412023  -1.485
state_abbTN            -0.005935   0.412062  -0.014
state_abbVA            -0.175889   0.412025  -0.427
state_abbCT             0.251949   0.412061   0.611
state_abbNC             0.443372   0.412017   1.076
state_abbWY            -0.065306   0.412050  -0.158
state_abbNM             0.407111   0.412202   0.988
state_abbNH            -0.089691   0.412125  -0.218
state_abbNY             0.401771   0.412038   0.975
state_abbNV             0.101763   0.412160   0.247
state_abbAZ             0.252024   0.412222   0.611
state_abbKY             0.109801   0.412073   0.266
state_abbPA             0.260837   0.412052   0.633
state_abbWA            -0.692934   0.412107  -1.681
state_abbID            -0.180944   0.412219  -0.439
state_abbVT             0.502196   0.412233   1.218
state_abbOR             0.047552   0.412095   0.115
state_abbCO             0.537532   0.412038   1.305
state_abbUT             0.985488   0.412096   2.391
state_abbCA             0.640588   0.412056   1.555
state_abbWV             0.522318   0.412178   1.267</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>r_squared <span class="ot">&lt;-</span> <span class="fu">rsq</span>(mod.h1<span class="fl">.4</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>rsq_comment <span class="ot">&lt;-</span> <span class="fu">glue</span>(</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"r_squared: {round(r_squared$model, digits = 2)}"</span>, </span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>     <span class="st">"</span><span class="sc">\n</span><span class="st">consisting of fixed effects: {round(r_squared$fixed, digits = 2)}"</span>, </span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>     <span class="st">" and random effects: {round(r_squared$random, digits = 2)}"</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><br></p>
<p>For this model r_squared: 0.95 consisting of fixed effects: 0.93 and random effects: 0.02.</p>
<p><br></p>
<p>While residuals are mostly small, a plot of residuals by predicted (<a href="#fig-lm-tri-mean-dam-explained-by-tri-mean-sample-by-state-evaluate" class="quarto-xref">Figure&nbsp;<span>10.9</span></a>) is not what we’d hope for:</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># following pattern at </span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="co"># https://mspeekenbrink.github.io/sdam-r-companion/linear-mixed-effects-models.html#visually-assessing-model-assumptions</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>tdat <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">predicted =</span> <span class="fu">predict</span>(mod.h1<span class="fl">.4</span>), </span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">residual =</span> <span class="fu">residuals</span>(mod.h1<span class="fl">.4</span>), </span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">state_abb =</span> dta_for_model<span class="sc">$</span>state_abb)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>p0 <span class="ot">&lt;-</span> tdat <span class="sc">|&gt;</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="fu">abs</span>(residual))) <span class="sc">+</span> </span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.1</span>, </span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>                 <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">label_number</span>(<span class="at">scale_cut =</span> <span class="fu">cut_short_scale</span>())) <span class="sc">+</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"A. Histogram (residuals)"</span>,</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"abs(residual)"</span>,</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> tdat <span class="sc">|&gt;</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> predicted, <span class="at">y =</span> residual,</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> state_abb)) <span class="sc">+</span> </span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.25</span>,</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, </span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>             <span class="at">lty =</span> <span class="dv">2</span>,</span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>             <span class="at">linewidth =</span> <span class="fl">0.5</span>,</span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"A. Scatter plot"</span></span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a>p1b <span class="ot">&lt;-</span> tdat <span class="sc">|&gt;</span></span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> predicted, <span class="at">y =</span> residual,</span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> state_abb)) <span class="sc">+</span> </span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.2</span>,</span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, </span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a>             <span class="at">lty =</span> <span class="dv">2</span>,</span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a>             <span class="at">linewidth =</span> <span class="fl">0.5</span>,</span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb24-47"><a href="#cb24-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"A2. Line plot (same data)"</span>,</span>
<span id="cb24-48"><a href="#cb24-48" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb24-49"><a href="#cb24-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-50"><a href="#cb24-50" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> tdat <span class="sc">|&gt;</span></span>
<span id="cb24-51"><a href="#cb24-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="fu">abs</span>(residual),</span>
<span id="cb24-52"><a href="#cb24-52" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> state_abb)) <span class="sc">+</span> </span>
<span id="cb24-53"><a href="#cb24-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ecdf</span>(<span class="at">linewidth =</span> <span class="fl">0.2</span>,</span>
<span id="cb24-54"><a href="#cb24-54" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.8</span>,</span>
<span id="cb24-55"><a href="#cb24-55" aria-hidden="true" tabindex="-1"></a>            <span class="at">pad =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb24-56"><a href="#cb24-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">label_percent</span>()) <span class="sc">+</span></span>
<span id="cb24-57"><a href="#cb24-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb24-58"><a href="#cb24-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb24-59"><a href="#cb24-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb24-60"><a href="#cb24-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"B1. ECDF plot (residuals)"</span>,</span>
<span id="cb24-61"><a href="#cb24-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"abs(residual)"</span>,</span>
<span id="cb24-62"><a href="#cb24-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Percent of residuals"</span></span>
<span id="cb24-63"><a href="#cb24-63" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb24-64"><a href="#cb24-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-65"><a href="#cb24-65" aria-hidden="true" tabindex="-1"></a>p2b <span class="ot">&lt;-</span> tdat <span class="sc">|&gt;</span></span>
<span id="cb24-66"><a href="#cb24-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(residual <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">|&gt;</span> <span class="co"># because scale_x_log10()</span></span>
<span id="cb24-67"><a href="#cb24-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="fu">abs</span>(residual),</span>
<span id="cb24-68"><a href="#cb24-68" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> state_abb)) <span class="sc">+</span> </span>
<span id="cb24-69"><a href="#cb24-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ecdf</span>(<span class="at">linewidth =</span> <span class="fl">0.2</span>,</span>
<span id="cb24-70"><a href="#cb24-70" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.8</span>,</span>
<span id="cb24-71"><a href="#cb24-71" aria-hidden="true" tabindex="-1"></a>            <span class="at">pad =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb24-72"><a href="#cb24-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ecdf</span>(<span class="at">data =</span> tdat <span class="sc">|&gt;</span></span>
<span id="cb24-73"><a href="#cb24-73" aria-hidden="true" tabindex="-1"></a>              <span class="fu">filter</span>(residual <span class="sc">&gt;</span> <span class="dv">0</span>),</span>
<span id="cb24-74"><a href="#cb24-74" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="fu">abs</span>(residual), <span class="at">color =</span> state_abb),</span>
<span id="cb24-75"><a href="#cb24-75" aria-hidden="true" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="dv">1</span>,</span>
<span id="cb24-76"><a href="#cb24-76" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"blue"</span>,</span>
<span id="cb24-77"><a href="#cb24-77" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.8</span>,</span>
<span id="cb24-78"><a href="#cb24-78" aria-hidden="true" tabindex="-1"></a>            <span class="at">pad =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb24-79"><a href="#cb24-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb24-80"><a href="#cb24-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">label_percent</span>()) <span class="sc">+</span></span>
<span id="cb24-81"><a href="#cb24-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb24-82"><a href="#cb24-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb24-83"><a href="#cb24-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb24-84"><a href="#cb24-84" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"B2. ECDF plot (residuals on log10 scale)"</span>,</span>
<span id="cb24-85"><a href="#cb24-85" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"abs(residual) (log10 scale)"</span>,</span>
<span id="cb24-86"><a href="#cb24-86" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Percent of residuals"</span></span>
<span id="cb24-87"><a href="#cb24-87" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb24-88"><a href="#cb24-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-89"><a href="#cb24-89" aria-hidden="true" tabindex="-1"></a>my_layout <span class="ot">&lt;-</span> </span>
<span id="cb24-90"><a href="#cb24-90" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="st">"</span></span>
<span id="cb24-91"><a href="#cb24-91" aria-hidden="true" tabindex="-1"></a><span class="st">AA</span></span>
<span id="cb24-92"><a href="#cb24-92" aria-hidden="true" tabindex="-1"></a><span class="st">BC</span></span>
<span id="cb24-93"><a href="#cb24-93" aria-hidden="true" tabindex="-1"></a><span class="st">DE"</span>)</span>
<span id="cb24-94"><a href="#cb24-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-95"><a href="#cb24-95" aria-hidden="true" tabindex="-1"></a>p0 <span class="sc">+</span> p1 <span class="sc">+</span> p1b <span class="sc">+</span> p2 <span class="sc">+</span> p2b <span class="sc">+</span></span>
<span id="cb24-96"><a href="#cb24-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb24-97"><a href="#cb24-97" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"mod.h1.4 residuals are small but far from the random distribution</span><span class="sc">\n</span><span class="st">one looks for in a well-described model"</span>,</span>
<span id="cb24-98"><a href="#cb24-98" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">'Each "thread" is the residuals for a state'</span>,</span>
<span id="cb24-99"><a href="#cb24-99" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> my_caption_nid_opentopography</span>
<span id="cb24-100"><a href="#cb24-100" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb24-101"><a href="#cb24-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">design =</span> my_layout)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-lm-tri-mean-dam-explained-by-tri-mean-sample-by-state-evaluate" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-lm-tri-mean-dam-explained-by-tri-mean-sample-by-state-evaluate-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ruggedness_files/figure-html/fig-lm-tri-mean-dam-explained-by-tri-mean-sample-by-state-evaluate-1.png" class="img-fluid figure-img" width="960">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-lm-tri-mean-dam-explained-by-tri-mean-sample-by-state-evaluate-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10.9: Residuals of model mod.h1.4 are mostly small but not randomly distributed
</figcaption>
</figure>
</div>
</div>
</div>
<p><br></p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tdat, <span class="fu">aes</span>(<span class="at">sample =</span> residual)) <span class="sc">+</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>() <span class="sc">+</span> </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq_line</span>(</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">lty =</span> <span class="dv">2</span>,</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.5</span>,</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"mod.h1.4 QQ Plot residuals are not normal"</span>,</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Tails are heavier than a normal distribution would produce"</span>,</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> my_caption_nid_opentopography</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-lm-tri-mean-dam-explained-by-tri-mean-samples-qq-plot" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-lm-tri-mean-dam-explained-by-tri-mean-samples-qq-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ruggedness_files/figure-html/fig-lm-tri-mean-dam-explained-by-tri-mean-samples-qq-plot-1.png" class="img-fluid figure-img" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-lm-tri-mean-dam-explained-by-tri-mean-samples-qq-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10.10: mod.h1.4 QQ Plot shows the model produces heavy non-normal tails
</figcaption>
</figure>
</div>
</div>
</div>
<p><br></p>
</section>
</section>
<section id="conclusion-h1" class="level3" data-number="10.3.4">
<h3 data-number="10.3.4" class="anchored" data-anchor-id="conclusion-h1"><span class="header-section-number">10.3.4</span> Conclusion: H<sub>1</sub></h3>
<p>From the plots:</p>
<ul>
<li><a href="#fig-mean-tri-diff-dam-and-state-by-state" class="quarto-xref">Figure&nbsp;<span>10.5</span></a> is quite helpful. All four panels support <span class="math inline">\(H_1\)</span>.</li>
<li><a href="#fig-tri-mean-sample-by-tri-mean-dam" class="quarto-xref">Figure&nbsp;<span>10.7</span></a> is also helpful. The log-log plots in panels A2 and B2 show that in most cases, <span class="math inline">\(tri\_mean_{dam}\)</span> exceeds <span class="math inline">\(tri\_mean_{sample}\)</span>.</li>
</ul>
<p>In flatter areas <span class="math inline">\(H_1\)</span> is true. In mountainous areas it is not.</p>
<p>From the regressions:</p>
<ul>
<li><p><em><a href="#sec-h1-mod4" class="quarto-xref"><span>Section 10.3.3.4</span></a> <span class="citation" data-cites="mod.h1.4">@mod.h1.4</span></em> best describes the variation in the data. Conditional means of the state effects are also aligned with the states’ <span class="math inline">\(median(tri\_mean_{sample})\)</span>.</p></li>
<li><p>The regressions don’t make a strong case for <span class="math inline">\(H_1\)</span>.</p></li>
</ul>
<p><br></p>
</section>
</section>
<section id="sec-h2-explore" class="level2 page-columns page-full" data-number="10.4">
<h2 data-number="10.4" class="anchored" data-anchor-id="sec-h2-explore"><span class="header-section-number">10.4</span> Exploring H<sub>2</sub> : In states with higher terrain ruggedness, dams’ <span class="math inline">\(\frac{surfaceArea}{nidStorage}\)</span> will be lower</h2>
<p>As a reminder:</p>
<p>Where dams are in more rugged areas, it seems likely dams’ lakes will be deeper and thus have smaller ratios <span class="math inline">\(\frac{surfaceArea}{nidStorage}\)</span>. In other words, considering the states in the continental US, there is an inverse proportional relationship:</p>
<p><span class="math display">\[tri\_mean_{sample} \propto \frac{1}{\left(\frac{surfaceArea}{nidStorage}\right)}\]</span></p>
<p>I look at two regressions:</p>
<ol type="1">
<li>lm(tri_mean_sample ~ ratio)</li>
</ol>
<ul>
<li>How much does this simple mode capture the variance in the data? Does it perform better than the base model looking only at state effects <em><a href="#sec-h1-mod3" class="quarto-xref"><span>Section 10.3.3.3</span></a></em>?</li>
</ul>
<ol start="2" type="1">
<li>lmer(tri_mean_sample ~ ratio + (1 | state_abb)</li>
</ol>
<ul>
<li>I assume this is the model likely to explain more variance than the other models.</li>
</ul>
<p>where <span class="math inline">\(ratio = \frac{surfaceArea}{nidStorage}\)</span>.</p>
<section id="first-surfacearea-and-nidstorage-distributions" class="level3 page-columns page-full" data-number="10.4.1">
<h3 data-number="10.4.1" class="anchored" data-anchor-id="first-surfacearea-and-nidstorage-distributions"><span class="header-section-number">10.4.1</span> First: <code>surfaceArea</code> and <code>nidStorage</code> distributions</h3>
<section id="data-availability" class="level4" data-number="10.4.1.1">
<h4 data-number="10.4.1.1" class="anchored" data-anchor-id="data-availability"><span class="header-section-number">10.4.1.1</span> Data availability</h4>
<p>The NID records are mostly complete with <code>nidHeight.</code> In comparison, there are more gaps for <code>nidStorage</code> (water volume) and water <code>surfaceArea</code>. For most states, the <code>nidStorage</code> missing rate is less than 4%. The exception is Connecticut, where the missing rate is 35%</p>
<div class="cell" data-tbl-cap-location="bottom">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>missing_nidStorage_by_state <span class="ot">&lt;-</span> dta_for_model <span class="sc">|&gt;</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(state_abb, nidStorage) <span class="sc">|&gt;</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">no_nidStorage =</span> <span class="fu">is.na</span>(nidStorage)) <span class="sc">|&gt;</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="at">n_dams =</span> <span class="fu">n</span>(),</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">n_missing_nidStorage =</span> <span class="fu">sum</span>(no_nidStorage),</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">pct_missing_nidStorage =</span> n_missing_nidStorage <span class="sc">/</span> n_dams,</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">.by =</span> state_abb) <span class="sc">|&gt;</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(pct_missing_nidStorage)) <span class="sc">|&gt;</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(pct_missing_nidStorage <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_totals</span>(<span class="at">where =</span> <span class="st">"row"</span>) <span class="sc">|&gt;</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rowid =</span> <span class="fu">row_number</span>(),</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">pct_missing_nidStorage =</span> n_missing_nidStorage <span class="sc">/</span> n_dams) <span class="co"># Do this again to pick up total row</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>missing_nidStorage_by_state <span class="sc">|&gt;</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="fu">md</span>(<span class="st">"**Percent of dams missing nidStorage values**"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_percent</span>(<span class="at">columns =</span> <span class="fu">starts_with</span>(<span class="st">"pct_"</span>),</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>              <span class="at">decimals =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-missing-nidStorage-by-state" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-tbl-cap-location="bottom">
<figure class="quarto-float quarto-float-tbl figure">
<div aria-describedby="tbl-missing-nidStorage-by-state-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="sfrifbkcew" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#sfrifbkcew table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#sfrifbkcew thead, #sfrifbkcew tbody, #sfrifbkcew tfoot, #sfrifbkcew tr, #sfrifbkcew td, #sfrifbkcew th {
  border-style: none;
}

#sfrifbkcew p {
  margin: 0;
  padding: 0;
}

#sfrifbkcew .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#sfrifbkcew .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#sfrifbkcew .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#sfrifbkcew .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#sfrifbkcew .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#sfrifbkcew .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sfrifbkcew .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#sfrifbkcew .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#sfrifbkcew .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#sfrifbkcew .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#sfrifbkcew .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#sfrifbkcew .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#sfrifbkcew .gt_spanner_row {
  border-bottom-style: hidden;
}

#sfrifbkcew .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#sfrifbkcew .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#sfrifbkcew .gt_from_md > :first-child {
  margin-top: 0;
}

#sfrifbkcew .gt_from_md > :last-child {
  margin-bottom: 0;
}

#sfrifbkcew .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#sfrifbkcew .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#sfrifbkcew .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#sfrifbkcew .gt_row_group_first td {
  border-top-width: 2px;
}

#sfrifbkcew .gt_row_group_first th {
  border-top-width: 2px;
}

#sfrifbkcew .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#sfrifbkcew .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#sfrifbkcew .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#sfrifbkcew .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sfrifbkcew .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#sfrifbkcew .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#sfrifbkcew .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#sfrifbkcew .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#sfrifbkcew .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sfrifbkcew .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#sfrifbkcew .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#sfrifbkcew .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#sfrifbkcew .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#sfrifbkcew .gt_left {
  text-align: left;
}

#sfrifbkcew .gt_center {
  text-align: center;
}

#sfrifbkcew .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#sfrifbkcew .gt_font_normal {
  font-weight: normal;
}

#sfrifbkcew .gt_font_bold {
  font-weight: bold;
}

#sfrifbkcew .gt_font_italic {
  font-style: italic;
}

#sfrifbkcew .gt_super {
  font-size: 65%;
}

#sfrifbkcew .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#sfrifbkcew .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#sfrifbkcew .gt_indent_1 {
  text-indent: 5px;
}

#sfrifbkcew .gt_indent_2 {
  text-indent: 10px;
}

#sfrifbkcew .gt_indent_3 {
  text-indent: 15px;
}

#sfrifbkcew .gt_indent_4 {
  text-indent: 20px;
}

#sfrifbkcew .gt_indent_5 {
  text-indent: 25px;
}

#sfrifbkcew .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#sfrifbkcew div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="5" class="gt_heading gt_title gt_font_normal gt_bottom_border"><strong>Percent of dams missing nidStorage values</strong></th>
</tr>
<tr class="gt_col_headings even">
<th id="state_abb" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">state_abb</th>
<th id="n_dams" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">n_dams</th>
<th id="n_missing_nidStorage" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">n_missing_nidStorage</th>
<th id="pct_missing_nidStorage" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">pct_missing_nidStorage</th>
<th id="rowid" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">rowid</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center" headers="state_abb">CT</td>
<td class="gt_row gt_right" headers="n_dams">1211</td>
<td class="gt_row gt_right" headers="n_missing_nidStorage">425</td>
<td class="gt_row gt_right" headers="pct_missing_nidStorage">35.09%</td>
<td class="gt_row gt_right" headers="rowid">1</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="state_abb">MD</td>
<td class="gt_row gt_right" headers="n_dams">402</td>
<td class="gt_row gt_right" headers="n_missing_nidStorage">15</td>
<td class="gt_row gt_right" headers="pct_missing_nidStorage">3.73%</td>
<td class="gt_row gt_right" headers="rowid">2</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="state_abb">RI</td>
<td class="gt_row gt_right" headers="n_dams">222</td>
<td class="gt_row gt_right" headers="n_missing_nidStorage">8</td>
<td class="gt_row gt_right" headers="pct_missing_nidStorage">3.60%</td>
<td class="gt_row gt_right" headers="rowid">3</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="state_abb">NJ</td>
<td class="gt_row gt_right" headers="n_dams">787</td>
<td class="gt_row gt_right" headers="n_missing_nidStorage">23</td>
<td class="gt_row gt_right" headers="pct_missing_nidStorage">2.92%</td>
<td class="gt_row gt_right" headers="rowid">4</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="state_abb">IN</td>
<td class="gt_row gt_right" headers="n_dams">1081</td>
<td class="gt_row gt_right" headers="n_missing_nidStorage">25</td>
<td class="gt_row gt_right" headers="pct_missing_nidStorage">2.31%</td>
<td class="gt_row gt_right" headers="rowid">5</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="state_abb">NC</td>
<td class="gt_row gt_right" headers="n_dams">3346</td>
<td class="gt_row gt_right" headers="n_missing_nidStorage">72</td>
<td class="gt_row gt_right" headers="pct_missing_nidStorage">2.15%</td>
<td class="gt_row gt_right" headers="rowid">6</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="state_abb">IL</td>
<td class="gt_row gt_right" headers="n_dams">1606</td>
<td class="gt_row gt_right" headers="n_missing_nidStorage">28</td>
<td class="gt_row gt_right" headers="pct_missing_nidStorage">1.74%</td>
<td class="gt_row gt_right" headers="rowid">7</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="state_abb">NM</td>
<td class="gt_row gt_right" headers="n_dams">395</td>
<td class="gt_row gt_right" headers="n_missing_nidStorage">5</td>
<td class="gt_row gt_right" headers="pct_missing_nidStorage">1.27%</td>
<td class="gt_row gt_right" headers="rowid">8</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="state_abb">UT</td>
<td class="gt_row gt_right" headers="n_dams">825</td>
<td class="gt_row gt_right" headers="n_missing_nidStorage">9</td>
<td class="gt_row gt_right" headers="pct_missing_nidStorage">1.09%</td>
<td class="gt_row gt_right" headers="rowid">9</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="state_abb">WV</td>
<td class="gt_row gt_right" headers="n_dams">473</td>
<td class="gt_row gt_right" headers="n_missing_nidStorage">5</td>
<td class="gt_row gt_right" headers="pct_missing_nidStorage">1.06%</td>
<td class="gt_row gt_right" headers="rowid">10</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="state_abb">CA</td>
<td class="gt_row gt_right" headers="n_dams">1430</td>
<td class="gt_row gt_right" headers="n_missing_nidStorage">10</td>
<td class="gt_row gt_right" headers="pct_missing_nidStorage">0.70%</td>
<td class="gt_row gt_right" headers="rowid">11</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="state_abb">NY</td>
<td class="gt_row gt_right" headers="n_dams">1850</td>
<td class="gt_row gt_right" headers="n_missing_nidStorage">11</td>
<td class="gt_row gt_right" headers="pct_missing_nidStorage">0.59%</td>
<td class="gt_row gt_right" headers="rowid">12</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="state_abb">ME</td>
<td class="gt_row gt_right" headers="n_dams">547</td>
<td class="gt_row gt_right" headers="n_missing_nidStorage">3</td>
<td class="gt_row gt_right" headers="pct_missing_nidStorage">0.55%</td>
<td class="gt_row gt_right" headers="rowid">13</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="state_abb">MO</td>
<td class="gt_row gt_right" headers="n_dams">5375</td>
<td class="gt_row gt_right" headers="n_missing_nidStorage">23</td>
<td class="gt_row gt_right" headers="pct_missing_nidStorage">0.43%</td>
<td class="gt_row gt_right" headers="rowid">14</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="state_abb">OR</td>
<td class="gt_row gt_right" headers="n_dams">854</td>
<td class="gt_row gt_right" headers="n_missing_nidStorage">3</td>
<td class="gt_row gt_right" headers="pct_missing_nidStorage">0.35%</td>
<td class="gt_row gt_right" headers="rowid">15</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="state_abb">KY</td>
<td class="gt_row gt_right" headers="n_dams">1063</td>
<td class="gt_row gt_right" headers="n_missing_nidStorage">3</td>
<td class="gt_row gt_right" headers="pct_missing_nidStorage">0.28%</td>
<td class="gt_row gt_right" headers="rowid">16</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="state_abb">AZ</td>
<td class="gt_row gt_right" headers="n_dams">362</td>
<td class="gt_row gt_right" headers="n_missing_nidStorage">1</td>
<td class="gt_row gt_right" headers="pct_missing_nidStorage">0.28%</td>
<td class="gt_row gt_right" headers="rowid">17</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="state_abb">PA</td>
<td class="gt_row gt_right" headers="n_dams">1462</td>
<td class="gt_row gt_right" headers="n_missing_nidStorage">4</td>
<td class="gt_row gt_right" headers="pct_missing_nidStorage">0.27%</td>
<td class="gt_row gt_right" headers="rowid">18</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="state_abb">WA</td>
<td class="gt_row gt_right" headers="n_dams">789</td>
<td class="gt_row gt_right" headers="n_missing_nidStorage">2</td>
<td class="gt_row gt_right" headers="pct_missing_nidStorage">0.25%</td>
<td class="gt_row gt_right" headers="rowid">19</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="state_abb">NV</td>
<td class="gt_row gt_right" headers="n_dams">499</td>
<td class="gt_row gt_right" headers="n_missing_nidStorage">1</td>
<td class="gt_row gt_right" headers="pct_missing_nidStorage">0.20%</td>
<td class="gt_row gt_right" headers="rowid">20</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="state_abb">MI</td>
<td class="gt_row gt_right" headers="n_dams">1014</td>
<td class="gt_row gt_right" headers="n_missing_nidStorage">2</td>
<td class="gt_row gt_right" headers="pct_missing_nidStorage">0.20%</td>
<td class="gt_row gt_right" headers="rowid">21</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="state_abb">MN</td>
<td class="gt_row gt_right" headers="n_dams">1113</td>
<td class="gt_row gt_right" headers="n_missing_nidStorage">2</td>
<td class="gt_row gt_right" headers="pct_missing_nidStorage">0.18%</td>
<td class="gt_row gt_right" headers="rowid">22</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="state_abb">TN</td>
<td class="gt_row gt_right" headers="n_dams">1199</td>
<td class="gt_row gt_right" headers="n_missing_nidStorage">2</td>
<td class="gt_row gt_right" headers="pct_missing_nidStorage">0.17%</td>
<td class="gt_row gt_right" headers="rowid">23</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="state_abb">NH</td>
<td class="gt_row gt_right" headers="n_dams">634</td>
<td class="gt_row gt_right" headers="n_missing_nidStorage">1</td>
<td class="gt_row gt_right" headers="pct_missing_nidStorage">0.16%</td>
<td class="gt_row gt_right" headers="rowid">24</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="state_abb">LA</td>
<td class="gt_row gt_right" headers="n_dams">704</td>
<td class="gt_row gt_right" headers="n_missing_nidStorage">1</td>
<td class="gt_row gt_right" headers="pct_missing_nidStorage">0.14%</td>
<td class="gt_row gt_right" headers="rowid">25</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="state_abb">FL</td>
<td class="gt_row gt_right" headers="n_dams">1059</td>
<td class="gt_row gt_right" headers="n_missing_nidStorage">1</td>
<td class="gt_row gt_right" headers="pct_missing_nidStorage">0.09%</td>
<td class="gt_row gt_right" headers="rowid">26</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="state_abb">AL</td>
<td class="gt_row gt_right" headers="n_dams">2175</td>
<td class="gt_row gt_right" headers="n_missing_nidStorage">2</td>
<td class="gt_row gt_right" headers="pct_missing_nidStorage">0.09%</td>
<td class="gt_row gt_right" headers="rowid">27</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="state_abb">MA</td>
<td class="gt_row gt_right" headers="n_dams">1213</td>
<td class="gt_row gt_right" headers="n_missing_nidStorage">1</td>
<td class="gt_row gt_right" headers="pct_missing_nidStorage">0.08%</td>
<td class="gt_row gt_right" headers="rowid">28</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="state_abb">AR</td>
<td class="gt_row gt_right" headers="n_dams">1253</td>
<td class="gt_row gt_right" headers="n_missing_nidStorage">1</td>
<td class="gt_row gt_right" headers="pct_missing_nidStorage">0.08%</td>
<td class="gt_row gt_right" headers="rowid">29</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="state_abb">SD</td>
<td class="gt_row gt_right" headers="n_dams">2530</td>
<td class="gt_row gt_right" headers="n_missing_nidStorage">2</td>
<td class="gt_row gt_right" headers="pct_missing_nidStorage">0.08%</td>
<td class="gt_row gt_right" headers="rowid">30</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="state_abb">MT</td>
<td class="gt_row gt_right" headers="n_dams">2958</td>
<td class="gt_row gt_right" headers="n_missing_nidStorage">2</td>
<td class="gt_row gt_right" headers="pct_missing_nidStorage">0.07%</td>
<td class="gt_row gt_right" headers="rowid">31</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="state_abb">CO</td>
<td class="gt_row gt_right" headers="n_dams">1948</td>
<td class="gt_row gt_right" headers="n_missing_nidStorage">1</td>
<td class="gt_row gt_right" headers="pct_missing_nidStorage">0.05%</td>
<td class="gt_row gt_right" headers="rowid">32</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="state_abb">KS</td>
<td class="gt_row gt_right" headers="n_dams">2226</td>
<td class="gt_row gt_right" headers="n_missing_nidStorage">1</td>
<td class="gt_row gt_right" headers="pct_missing_nidStorage">0.04%</td>
<td class="gt_row gt_right" headers="rowid">33</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="state_abb">GA</td>
<td class="gt_row gt_right" headers="n_dams">5356</td>
<td class="gt_row gt_right" headers="n_missing_nidStorage">2</td>
<td class="gt_row gt_right" headers="pct_missing_nidStorage">0.04%</td>
<td class="gt_row gt_right" headers="rowid">34</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="state_abb">VA</td>
<td class="gt_row gt_right" headers="n_dams">2695</td>
<td class="gt_row gt_right" headers="n_missing_nidStorage">1</td>
<td class="gt_row gt_right" headers="pct_missing_nidStorage">0.04%</td>
<td class="gt_row gt_right" headers="rowid">35</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="state_abb">Total</td>
<td class="gt_row gt_right" headers="n_dams">52656</td>
<td class="gt_row gt_right" headers="n_missing_nidStorage">698</td>
<td class="gt_row gt_right" headers="pct_missing_nidStorage">1.33%</td>
<td class="gt_row gt_right" headers="rowid">36</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-tbl" id="tbl-missing-nidStorage-by-state-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;10.1: Missing nidStorage by state
</figcaption>
</figure>
</div>
</div>
<p>Only the smallest dams have a missing 1 rate greater than 1%:</p>
<div class="cell" data-tbl-cap-location="bottom">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>missing_nidStorage_by_nidHeightId <span class="ot">&lt;-</span> dta_for_model <span class="sc">|&gt;</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(nidHeightId, nidStorage) <span class="sc">|&gt;</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">no_nidStorage =</span> <span class="fu">is.na</span>(nidStorage)) <span class="sc">|&gt;</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="at">n_dams =</span> <span class="fu">n</span>(),</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">n_missing_nidStorage =</span> <span class="fu">sum</span>(no_nidStorage),</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">pct_missing_nidStorage =</span> n_missing_nidStorage <span class="sc">/</span> n_dams,</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">.by =</span> nidHeightId) <span class="sc">|&gt;</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># arrange(desc(pct_missing_nidStorage)) |&gt;</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(pct_missing_nidStorage <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_totals</span>(<span class="at">where =</span> <span class="st">"row"</span>) <span class="sc">|&gt;</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rowid =</span> <span class="fu">row_number</span>(),</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">pct_missing_nidStorage =</span> n_missing_nidStorage <span class="sc">/</span> n_dams) <span class="co"># Do this again to pick up total row</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>missing_nidStorage_by_nidHeightId <span class="sc">|&gt;</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="fu">md</span>(<span class="st">"**Percent of dams missing nidStorage values**"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_percent</span>(<span class="at">columns =</span> <span class="fu">starts_with</span>(<span class="st">"pct_"</span>),</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>              <span class="at">decimals =</span> <span class="dv">2</span>) <span class="sc">|&gt;</span></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_align</span>(<span class="at">columns =</span> nidHeightId,</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="st">"left"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-missing-nidStorage-by-nidHeightId" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-tbl-cap-location="bottom">
<figure class="quarto-float quarto-float-tbl figure">
<div aria-describedby="tbl-missing-nidStorage-by-nidHeightId-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="bhapllehbl" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#bhapllehbl table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#bhapllehbl thead, #bhapllehbl tbody, #bhapllehbl tfoot, #bhapllehbl tr, #bhapllehbl td, #bhapllehbl th {
  border-style: none;
}

#bhapllehbl p {
  margin: 0;
  padding: 0;
}

#bhapllehbl .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#bhapllehbl .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#bhapllehbl .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#bhapllehbl .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#bhapllehbl .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#bhapllehbl .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bhapllehbl .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#bhapllehbl .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#bhapllehbl .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#bhapllehbl .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#bhapllehbl .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#bhapllehbl .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#bhapllehbl .gt_spanner_row {
  border-bottom-style: hidden;
}

#bhapllehbl .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#bhapllehbl .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#bhapllehbl .gt_from_md > :first-child {
  margin-top: 0;
}

#bhapllehbl .gt_from_md > :last-child {
  margin-bottom: 0;
}

#bhapllehbl .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#bhapllehbl .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#bhapllehbl .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#bhapllehbl .gt_row_group_first td {
  border-top-width: 2px;
}

#bhapllehbl .gt_row_group_first th {
  border-top-width: 2px;
}

#bhapllehbl .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#bhapllehbl .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#bhapllehbl .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#bhapllehbl .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bhapllehbl .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#bhapllehbl .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#bhapllehbl .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#bhapllehbl .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#bhapllehbl .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bhapllehbl .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#bhapllehbl .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#bhapllehbl .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#bhapllehbl .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#bhapllehbl .gt_left {
  text-align: left;
}

#bhapllehbl .gt_center {
  text-align: center;
}

#bhapllehbl .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#bhapllehbl .gt_font_normal {
  font-weight: normal;
}

#bhapllehbl .gt_font_bold {
  font-weight: bold;
}

#bhapllehbl .gt_font_italic {
  font-style: italic;
}

#bhapllehbl .gt_super {
  font-size: 65%;
}

#bhapllehbl .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#bhapllehbl .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#bhapllehbl .gt_indent_1 {
  text-indent: 5px;
}

#bhapllehbl .gt_indent_2 {
  text-indent: 10px;
}

#bhapllehbl .gt_indent_3 {
  text-indent: 15px;
}

#bhapllehbl .gt_indent_4 {
  text-indent: 20px;
}

#bhapllehbl .gt_indent_5 {
  text-indent: 25px;
}

#bhapllehbl .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#bhapllehbl div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="5" class="gt_heading gt_title gt_font_normal gt_bottom_border"><strong>Percent of dams missing nidStorage values</strong></th>
</tr>
<tr class="gt_col_headings even">
<th id="nidHeightId" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">nidHeightId</th>
<th id="n_dams" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">n_dams</th>
<th id="n_missing_nidStorage" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">n_missing_nidStorage</th>
<th id="pct_missing_nidStorage" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">pct_missing_nidStorage</th>
<th id="rowid" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">rowid</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="nidHeightId">Less than 25 feet</td>
<td class="gt_row gt_right" headers="n_dams">43011</td>
<td class="gt_row gt_right" headers="n_missing_nidStorage">598</td>
<td class="gt_row gt_right" headers="pct_missing_nidStorage">1.39%</td>
<td class="gt_row gt_right" headers="rowid">1</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="nidHeightId">51-100 feet</td>
<td class="gt_row gt_right" headers="n_dams">5023</td>
<td class="gt_row gt_right" headers="n_missing_nidStorage">15</td>
<td class="gt_row gt_right" headers="pct_missing_nidStorage">0.30%</td>
<td class="gt_row gt_right" headers="rowid">2</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="nidHeightId">25-50 feet</td>
<td class="gt_row gt_right" headers="n_dams">36294</td>
<td class="gt_row gt_right" headers="n_missing_nidStorage">80</td>
<td class="gt_row gt_right" headers="pct_missing_nidStorage">0.22%</td>
<td class="gt_row gt_right" headers="rowid">3</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="nidHeightId">Greater than 100 feet</td>
<td class="gt_row gt_right" headers="n_dams">1526</td>
<td class="gt_row gt_right" headers="n_missing_nidStorage">5</td>
<td class="gt_row gt_right" headers="pct_missing_nidStorage">0.33%</td>
<td class="gt_row gt_right" headers="rowid">4</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="nidHeightId">Total</td>
<td class="gt_row gt_right" headers="n_dams">85854</td>
<td class="gt_row gt_right" headers="n_missing_nidStorage">698</td>
<td class="gt_row gt_right" headers="pct_missing_nidStorage">0.81%</td>
<td class="gt_row gt_right" headers="rowid">5</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-tbl" id="tbl-missing-nidStorage-by-nidHeightId-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;10.2: Missing nidStorage by nidHeightId
</figcaption>
</figure>
</div>
</div>
<p><br></p>
<p>For <code>surfaceArea</code> the gaps are worse. For example, Utah and Montana, South Dakota, and Alabama are missing <code>surfaceArea</code> for more than 75% of their dams. Among all dams, 20% are missing this data.</p>
<div class="cell" data-tbl-cap-location="bottom">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>missing_surfaceArea_by_state <span class="ot">&lt;-</span> dta_for_model <span class="sc">|&gt;</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(state_abb, surfaceArea) <span class="sc">|&gt;</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">no_surfaceArea =</span> <span class="fu">is.na</span>(surfaceArea)) <span class="sc">|&gt;</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="at">n_dams =</span> <span class="fu">n</span>(),</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">n_missing_surfaceArea =</span> <span class="fu">sum</span>(no_surfaceArea),</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">pct_missing_surfaceArea =</span> n_missing_surfaceArea <span class="sc">/</span> n_dams,</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">.by =</span> state_abb) <span class="sc">|&gt;</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(pct_missing_surfaceArea)) <span class="sc">|&gt;</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(pct_missing_surfaceArea <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_totals</span>(<span class="at">where =</span> <span class="st">"row"</span>) <span class="sc">|&gt;</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rowid =</span> <span class="fu">row_number</span>(),</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">pct_missing_surfaceArea =</span> n_missing_surfaceArea <span class="sc">/</span> n_dams) <span class="co"># Do this again to pick up total row</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>missing_surfaceArea_by_state <span class="sc">|&gt;</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="fu">md</span>(<span class="st">"**Percent of dams missing surfaceArea values**"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_percent</span>(<span class="at">columns =</span> <span class="fu">starts_with</span>(<span class="st">"pct_"</span>),</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>              <span class="at">decimals =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-missing-surfaceArea-by-state" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-tbl-cap-location="bottom">
<figure class="quarto-float quarto-float-tbl figure">
<div aria-describedby="tbl-missing-surfaceArea-by-state-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="vlergcluxh" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#vlergcluxh table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#vlergcluxh thead, #vlergcluxh tbody, #vlergcluxh tfoot, #vlergcluxh tr, #vlergcluxh td, #vlergcluxh th {
  border-style: none;
}

#vlergcluxh p {
  margin: 0;
  padding: 0;
}

#vlergcluxh .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#vlergcluxh .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#vlergcluxh .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#vlergcluxh .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#vlergcluxh .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vlergcluxh .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vlergcluxh .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vlergcluxh .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#vlergcluxh .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#vlergcluxh .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#vlergcluxh .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#vlergcluxh .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#vlergcluxh .gt_spanner_row {
  border-bottom-style: hidden;
}

#vlergcluxh .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#vlergcluxh .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#vlergcluxh .gt_from_md > :first-child {
  margin-top: 0;
}

#vlergcluxh .gt_from_md > :last-child {
  margin-bottom: 0;
}

#vlergcluxh .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#vlergcluxh .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#vlergcluxh .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#vlergcluxh .gt_row_group_first td {
  border-top-width: 2px;
}

#vlergcluxh .gt_row_group_first th {
  border-top-width: 2px;
}

#vlergcluxh .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vlergcluxh .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#vlergcluxh .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#vlergcluxh .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vlergcluxh .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vlergcluxh .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#vlergcluxh .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#vlergcluxh .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#vlergcluxh .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vlergcluxh .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vlergcluxh .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vlergcluxh .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vlergcluxh .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vlergcluxh .gt_left {
  text-align: left;
}

#vlergcluxh .gt_center {
  text-align: center;
}

#vlergcluxh .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#vlergcluxh .gt_font_normal {
  font-weight: normal;
}

#vlergcluxh .gt_font_bold {
  font-weight: bold;
}

#vlergcluxh .gt_font_italic {
  font-style: italic;
}

#vlergcluxh .gt_super {
  font-size: 65%;
}

#vlergcluxh .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#vlergcluxh .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#vlergcluxh .gt_indent_1 {
  text-indent: 5px;
}

#vlergcluxh .gt_indent_2 {
  text-indent: 10px;
}

#vlergcluxh .gt_indent_3 {
  text-indent: 15px;
}

#vlergcluxh .gt_indent_4 {
  text-indent: 20px;
}

#vlergcluxh .gt_indent_5 {
  text-indent: 25px;
}

#vlergcluxh .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#vlergcluxh div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="5" class="gt_heading gt_title gt_font_normal gt_bottom_border"><strong>Percent of dams missing surfaceArea values</strong></th>
</tr>
<tr class="gt_col_headings even">
<th id="state_abb" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">state_abb</th>
<th id="n_dams" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">n_dams</th>
<th id="n_missing_surfaceArea" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">n_missing_surfaceArea</th>
<th id="pct_missing_surfaceArea" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">pct_missing_surfaceArea</th>
<th id="rowid" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">rowid</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center" headers="state_abb">UT</td>
<td class="gt_row gt_right" headers="n_dams">825</td>
<td class="gt_row gt_right" headers="n_missing_surfaceArea">790</td>
<td class="gt_row gt_right" headers="pct_missing_surfaceArea">95.76%</td>
<td class="gt_row gt_right" headers="rowid">1</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="state_abb">MT</td>
<td class="gt_row gt_right" headers="n_dams">2958</td>
<td class="gt_row gt_right" headers="n_missing_surfaceArea">2445</td>
<td class="gt_row gt_right" headers="pct_missing_surfaceArea">82.66%</td>
<td class="gt_row gt_right" headers="rowid">2</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="state_abb">SD</td>
<td class="gt_row gt_right" headers="n_dams">2530</td>
<td class="gt_row gt_right" headers="n_missing_surfaceArea">2007</td>
<td class="gt_row gt_right" headers="pct_missing_surfaceArea">79.33%</td>
<td class="gt_row gt_right" headers="rowid">3</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="state_abb">AL</td>
<td class="gt_row gt_right" headers="n_dams">2175</td>
<td class="gt_row gt_right" headers="n_missing_surfaceArea">1642</td>
<td class="gt_row gt_right" headers="pct_missing_surfaceArea">75.49%</td>
<td class="gt_row gt_right" headers="rowid">4</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="state_abb">IL</td>
<td class="gt_row gt_right" headers="n_dams">1606</td>
<td class="gt_row gt_right" headers="n_missing_surfaceArea">938</td>
<td class="gt_row gt_right" headers="pct_missing_surfaceArea">58.41%</td>
<td class="gt_row gt_right" headers="rowid">5</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="state_abb">MS</td>
<td class="gt_row gt_right" headers="n_dams">6088</td>
<td class="gt_row gt_right" headers="n_missing_surfaceArea">2344</td>
<td class="gt_row gt_right" headers="pct_missing_surfaceArea">38.50%</td>
<td class="gt_row gt_right" headers="rowid">6</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="state_abb">AR</td>
<td class="gt_row gt_right" headers="n_dams">1253</td>
<td class="gt_row gt_right" headers="n_missing_surfaceArea">471</td>
<td class="gt_row gt_right" headers="pct_missing_surfaceArea">37.59%</td>
<td class="gt_row gt_right" headers="rowid">7</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="state_abb">MN</td>
<td class="gt_row gt_right" headers="n_dams">1113</td>
<td class="gt_row gt_right" headers="n_missing_surfaceArea">380</td>
<td class="gt_row gt_right" headers="pct_missing_surfaceArea">34.14%</td>
<td class="gt_row gt_right" headers="rowid">8</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="state_abb">VA</td>
<td class="gt_row gt_right" headers="n_dams">2695</td>
<td class="gt_row gt_right" headers="n_missing_surfaceArea">918</td>
<td class="gt_row gt_right" headers="pct_missing_surfaceArea">34.06%</td>
<td class="gt_row gt_right" headers="rowid">9</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="state_abb">TX</td>
<td class="gt_row gt_right" headers="n_dams">7270</td>
<td class="gt_row gt_right" headers="n_missing_surfaceArea">1787</td>
<td class="gt_row gt_right" headers="pct_missing_surfaceArea">24.58%</td>
<td class="gt_row gt_right" headers="rowid">10</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="state_abb">NM</td>
<td class="gt_row gt_right" headers="n_dams">395</td>
<td class="gt_row gt_right" headers="n_missing_surfaceArea">90</td>
<td class="gt_row gt_right" headers="pct_missing_surfaceArea">22.78%</td>
<td class="gt_row gt_right" headers="rowid">11</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="state_abb">AZ</td>
<td class="gt_row gt_right" headers="n_dams">362</td>
<td class="gt_row gt_right" headers="n_missing_surfaceArea">68</td>
<td class="gt_row gt_right" headers="pct_missing_surfaceArea">18.78%</td>
<td class="gt_row gt_right" headers="rowid">12</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="state_abb">WV</td>
<td class="gt_row gt_right" headers="n_dams">473</td>
<td class="gt_row gt_right" headers="n_missing_surfaceArea">75</td>
<td class="gt_row gt_right" headers="pct_missing_surfaceArea">15.86%</td>
<td class="gt_row gt_right" headers="rowid">13</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="state_abb">ND</td>
<td class="gt_row gt_right" headers="n_dams">860</td>
<td class="gt_row gt_right" headers="n_missing_surfaceArea">127</td>
<td class="gt_row gt_right" headers="pct_missing_surfaceArea">14.77%</td>
<td class="gt_row gt_right" headers="rowid">14</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="state_abb">OK</td>
<td class="gt_row gt_right" headers="n_dams">4968</td>
<td class="gt_row gt_right" headers="n_missing_surfaceArea">708</td>
<td class="gt_row gt_right" headers="pct_missing_surfaceArea">14.25%</td>
<td class="gt_row gt_right" headers="rowid">15</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="state_abb">KY</td>
<td class="gt_row gt_right" headers="n_dams">1063</td>
<td class="gt_row gt_right" headers="n_missing_surfaceArea">141</td>
<td class="gt_row gt_right" headers="pct_missing_surfaceArea">13.26%</td>
<td class="gt_row gt_right" headers="rowid">16</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="state_abb">WA</td>
<td class="gt_row gt_right" headers="n_dams">789</td>
<td class="gt_row gt_right" headers="n_missing_surfaceArea">104</td>
<td class="gt_row gt_right" headers="pct_missing_surfaceArea">13.18%</td>
<td class="gt_row gt_right" headers="rowid">17</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="state_abb">OR</td>
<td class="gt_row gt_right" headers="n_dams">854</td>
<td class="gt_row gt_right" headers="n_missing_surfaceArea">112</td>
<td class="gt_row gt_right" headers="pct_missing_surfaceArea">13.11%</td>
<td class="gt_row gt_right" headers="rowid">18</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="state_abb">PA</td>
<td class="gt_row gt_right" headers="n_dams">1462</td>
<td class="gt_row gt_right" headers="n_missing_surfaceArea">186</td>
<td class="gt_row gt_right" headers="pct_missing_surfaceArea">12.72%</td>
<td class="gt_row gt_right" headers="rowid">19</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="state_abb">KS</td>
<td class="gt_row gt_right" headers="n_dams">2226</td>
<td class="gt_row gt_right" headers="n_missing_surfaceArea">278</td>
<td class="gt_row gt_right" headers="pct_missing_surfaceArea">12.49%</td>
<td class="gt_row gt_right" headers="rowid">20</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="state_abb">MD</td>
<td class="gt_row gt_right" headers="n_dams">402</td>
<td class="gt_row gt_right" headers="n_missing_surfaceArea">49</td>
<td class="gt_row gt_right" headers="pct_missing_surfaceArea">12.19%</td>
<td class="gt_row gt_right" headers="rowid">21</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="state_abb">NC</td>
<td class="gt_row gt_right" headers="n_dams">3346</td>
<td class="gt_row gt_right" headers="n_missing_surfaceArea">370</td>
<td class="gt_row gt_right" headers="pct_missing_surfaceArea">11.06%</td>
<td class="gt_row gt_right" headers="rowid">22</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="state_abb">MA</td>
<td class="gt_row gt_right" headers="n_dams">1213</td>
<td class="gt_row gt_right" headers="n_missing_surfaceArea">105</td>
<td class="gt_row gt_right" headers="pct_missing_surfaceArea">8.66%</td>
<td class="gt_row gt_right" headers="rowid">23</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="state_abb">WI</td>
<td class="gt_row gt_right" headers="n_dams">953</td>
<td class="gt_row gt_right" headers="n_missing_surfaceArea">77</td>
<td class="gt_row gt_right" headers="pct_missing_surfaceArea">8.08%</td>
<td class="gt_row gt_right" headers="rowid">24</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="state_abb">CA</td>
<td class="gt_row gt_right" headers="n_dams">1430</td>
<td class="gt_row gt_right" headers="n_missing_surfaceArea">94</td>
<td class="gt_row gt_right" headers="pct_missing_surfaceArea">6.57%</td>
<td class="gt_row gt_right" headers="rowid">25</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="state_abb">GA</td>
<td class="gt_row gt_right" headers="n_dams">5356</td>
<td class="gt_row gt_right" headers="n_missing_surfaceArea">309</td>
<td class="gt_row gt_right" headers="pct_missing_surfaceArea">5.77%</td>
<td class="gt_row gt_right" headers="rowid">26</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="state_abb">SC</td>
<td class="gt_row gt_right" headers="n_dams">2399</td>
<td class="gt_row gt_right" headers="n_missing_surfaceArea">133</td>
<td class="gt_row gt_right" headers="pct_missing_surfaceArea">5.54%</td>
<td class="gt_row gt_right" headers="rowid">27</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="state_abb">OH</td>
<td class="gt_row gt_right" headers="n_dams">1393</td>
<td class="gt_row gt_right" headers="n_missing_surfaceArea">64</td>
<td class="gt_row gt_right" headers="pct_missing_surfaceArea">4.59%</td>
<td class="gt_row gt_right" headers="rowid">28</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="state_abb">RI</td>
<td class="gt_row gt_right" headers="n_dams">222</td>
<td class="gt_row gt_right" headers="n_missing_surfaceArea">10</td>
<td class="gt_row gt_right" headers="pct_missing_surfaceArea">4.50%</td>
<td class="gt_row gt_right" headers="rowid">29</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="state_abb">TN</td>
<td class="gt_row gt_right" headers="n_dams">1199</td>
<td class="gt_row gt_right" headers="n_missing_surfaceArea">49</td>
<td class="gt_row gt_right" headers="pct_missing_surfaceArea">4.09%</td>
<td class="gt_row gt_right" headers="rowid">30</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="state_abb">CT</td>
<td class="gt_row gt_right" headers="n_dams">1211</td>
<td class="gt_row gt_right" headers="n_missing_surfaceArea">49</td>
<td class="gt_row gt_right" headers="pct_missing_surfaceArea">4.05%</td>
<td class="gt_row gt_right" headers="rowid">31</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="state_abb">IN</td>
<td class="gt_row gt_right" headers="n_dams">1081</td>
<td class="gt_row gt_right" headers="n_missing_surfaceArea">43</td>
<td class="gt_row gt_right" headers="pct_missing_surfaceArea">3.98%</td>
<td class="gt_row gt_right" headers="rowid">32</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="state_abb">DE</td>
<td class="gt_row gt_right" headers="n_dams">83</td>
<td class="gt_row gt_right" headers="n_missing_surfaceArea">3</td>
<td class="gt_row gt_right" headers="pct_missing_surfaceArea">3.61%</td>
<td class="gt_row gt_right" headers="rowid">33</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="state_abb">ME</td>
<td class="gt_row gt_right" headers="n_dams">547</td>
<td class="gt_row gt_right" headers="n_missing_surfaceArea">18</td>
<td class="gt_row gt_right" headers="pct_missing_surfaceArea">3.29%</td>
<td class="gt_row gt_right" headers="rowid">34</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="state_abb">MI</td>
<td class="gt_row gt_right" headers="n_dams">1014</td>
<td class="gt_row gt_right" headers="n_missing_surfaceArea">27</td>
<td class="gt_row gt_right" headers="pct_missing_surfaceArea">2.66%</td>
<td class="gt_row gt_right" headers="rowid">35</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="state_abb">CO</td>
<td class="gt_row gt_right" headers="n_dams">1948</td>
<td class="gt_row gt_right" headers="n_missing_surfaceArea">47</td>
<td class="gt_row gt_right" headers="pct_missing_surfaceArea">2.41%</td>
<td class="gt_row gt_right" headers="rowid">36</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="state_abb">NV</td>
<td class="gt_row gt_right" headers="n_dams">499</td>
<td class="gt_row gt_right" headers="n_missing_surfaceArea">12</td>
<td class="gt_row gt_right" headers="pct_missing_surfaceArea">2.40%</td>
<td class="gt_row gt_right" headers="rowid">37</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="state_abb">WY</td>
<td class="gt_row gt_right" headers="n_dams">1471</td>
<td class="gt_row gt_right" headers="n_missing_surfaceArea">31</td>
<td class="gt_row gt_right" headers="pct_missing_surfaceArea">2.11%</td>
<td class="gt_row gt_right" headers="rowid">38</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="state_abb">LA</td>
<td class="gt_row gt_right" headers="n_dams">704</td>
<td class="gt_row gt_right" headers="n_missing_surfaceArea">14</td>
<td class="gt_row gt_right" headers="pct_missing_surfaceArea">1.99%</td>
<td class="gt_row gt_right" headers="rowid">39</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="state_abb">NY</td>
<td class="gt_row gt_right" headers="n_dams">1850</td>
<td class="gt_row gt_right" headers="n_missing_surfaceArea">36</td>
<td class="gt_row gt_right" headers="pct_missing_surfaceArea">1.95%</td>
<td class="gt_row gt_right" headers="rowid">40</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="state_abb">NJ</td>
<td class="gt_row gt_right" headers="n_dams">787</td>
<td class="gt_row gt_right" headers="n_missing_surfaceArea">15</td>
<td class="gt_row gt_right" headers="pct_missing_surfaceArea">1.91%</td>
<td class="gt_row gt_right" headers="rowid">41</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="state_abb">NE</td>
<td class="gt_row gt_right" headers="n_dams">2948</td>
<td class="gt_row gt_right" headers="n_missing_surfaceArea">53</td>
<td class="gt_row gt_right" headers="pct_missing_surfaceArea">1.80%</td>
<td class="gt_row gt_right" headers="rowid">42</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="state_abb">IA</td>
<td class="gt_row gt_right" headers="n_dams">4042</td>
<td class="gt_row gt_right" headers="n_missing_surfaceArea">70</td>
<td class="gt_row gt_right" headers="pct_missing_surfaceArea">1.73%</td>
<td class="gt_row gt_right" headers="rowid">43</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="state_abb">NH</td>
<td class="gt_row gt_right" headers="n_dams">634</td>
<td class="gt_row gt_right" headers="n_missing_surfaceArea">6</td>
<td class="gt_row gt_right" headers="pct_missing_surfaceArea">0.95%</td>
<td class="gt_row gt_right" headers="rowid">44</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="state_abb">ID</td>
<td class="gt_row gt_right" headers="n_dams">375</td>
<td class="gt_row gt_right" headers="n_missing_surfaceArea">2</td>
<td class="gt_row gt_right" headers="pct_missing_surfaceArea">0.53%</td>
<td class="gt_row gt_right" headers="rowid">45</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="state_abb">FL</td>
<td class="gt_row gt_right" headers="n_dams">1059</td>
<td class="gt_row gt_right" headers="n_missing_surfaceArea">4</td>
<td class="gt_row gt_right" headers="pct_missing_surfaceArea">0.38%</td>
<td class="gt_row gt_right" headers="rowid">46</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="state_abb">MO</td>
<td class="gt_row gt_right" headers="n_dams">5375</td>
<td class="gt_row gt_right" headers="n_missing_surfaceArea">9</td>
<td class="gt_row gt_right" headers="pct_missing_surfaceArea">0.17%</td>
<td class="gt_row gt_right" headers="rowid">47</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="state_abb">Total</td>
<td class="gt_row gt_right" headers="n_dams">85506</td>
<td class="gt_row gt_right" headers="n_missing_surfaceArea">17310</td>
<td class="gt_row gt_right" headers="pct_missing_surfaceArea">20.24%</td>
<td class="gt_row gt_right" headers="rowid">48</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-tbl" id="tbl-missing-surfaceArea-by-state-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;10.3: Missing surfaceArea by state
</figcaption>
</figure>
</div>
</div>
<p><br></p>
<p>The biggest gaps in <code>surfaceArea</code> data are for the smallest dams, where a quarter are missing.</p>
<div class="cell" data-tbl-cap-location="bottom">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>missing_surfaceArea_by_nidHeightId <span class="ot">&lt;-</span> dta_for_model <span class="sc">|&gt;</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(nidHeightId, surfaceArea) <span class="sc">|&gt;</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">no_surfaceArea =</span> <span class="fu">is.na</span>(surfaceArea)) <span class="sc">|&gt;</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="at">n_dams =</span> <span class="fu">n</span>(),</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">n_missing_surfaceArea =</span> <span class="fu">sum</span>(no_surfaceArea),</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">pct_missing_surfaceArea =</span> n_missing_surfaceArea <span class="sc">/</span> n_dams,</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">.by =</span> nidHeightId) <span class="sc">|&gt;</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># arrange(desc(pct_missing_surfaceArea)) |&gt;</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(pct_missing_surfaceArea <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_totals</span>(<span class="at">where =</span> <span class="st">"row"</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rowid =</span> <span class="fu">row_number</span>(),</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">pct_missing_surfaceArea =</span> n_missing_surfaceArea <span class="sc">/</span> n_dams) <span class="co"># Do this again to pick up total row</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>missing_surfaceArea_by_nidHeightId <span class="sc">|&gt;</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="fu">md</span>(<span class="st">"**Percent of dams missing surfaceArea values**"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_percent</span>(<span class="at">columns =</span> <span class="fu">starts_with</span>(<span class="st">"pct_"</span>),</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>              <span class="at">decimals =</span> <span class="dv">2</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_align</span>(<span class="at">columns =</span> nidHeightId,</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="st">"left"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-missing-surfaceArea-by-nidHeightId" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-tbl-cap-location="bottom">
<figure class="quarto-float quarto-float-tbl figure">
<div aria-describedby="tbl-missing-surfaceArea-by-nidHeightId-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="ltohlxsnrm" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ltohlxsnrm table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ltohlxsnrm thead, #ltohlxsnrm tbody, #ltohlxsnrm tfoot, #ltohlxsnrm tr, #ltohlxsnrm td, #ltohlxsnrm th {
  border-style: none;
}

#ltohlxsnrm p {
  margin: 0;
  padding: 0;
}

#ltohlxsnrm .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ltohlxsnrm .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ltohlxsnrm .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ltohlxsnrm .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ltohlxsnrm .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ltohlxsnrm .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ltohlxsnrm .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ltohlxsnrm .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ltohlxsnrm .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ltohlxsnrm .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ltohlxsnrm .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ltohlxsnrm .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ltohlxsnrm .gt_spanner_row {
  border-bottom-style: hidden;
}

#ltohlxsnrm .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ltohlxsnrm .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ltohlxsnrm .gt_from_md > :first-child {
  margin-top: 0;
}

#ltohlxsnrm .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ltohlxsnrm .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ltohlxsnrm .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ltohlxsnrm .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ltohlxsnrm .gt_row_group_first td {
  border-top-width: 2px;
}

#ltohlxsnrm .gt_row_group_first th {
  border-top-width: 2px;
}

#ltohlxsnrm .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ltohlxsnrm .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ltohlxsnrm .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ltohlxsnrm .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ltohlxsnrm .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ltohlxsnrm .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ltohlxsnrm .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ltohlxsnrm .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ltohlxsnrm .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ltohlxsnrm .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ltohlxsnrm .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ltohlxsnrm .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ltohlxsnrm .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ltohlxsnrm .gt_left {
  text-align: left;
}

#ltohlxsnrm .gt_center {
  text-align: center;
}

#ltohlxsnrm .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ltohlxsnrm .gt_font_normal {
  font-weight: normal;
}

#ltohlxsnrm .gt_font_bold {
  font-weight: bold;
}

#ltohlxsnrm .gt_font_italic {
  font-style: italic;
}

#ltohlxsnrm .gt_super {
  font-size: 65%;
}

#ltohlxsnrm .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ltohlxsnrm .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ltohlxsnrm .gt_indent_1 {
  text-indent: 5px;
}

#ltohlxsnrm .gt_indent_2 {
  text-indent: 10px;
}

#ltohlxsnrm .gt_indent_3 {
  text-indent: 15px;
}

#ltohlxsnrm .gt_indent_4 {
  text-indent: 20px;
}

#ltohlxsnrm .gt_indent_5 {
  text-indent: 25px;
}

#ltohlxsnrm .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ltohlxsnrm div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="5" class="gt_heading gt_title gt_font_normal gt_bottom_border"><strong>Percent of dams missing surfaceArea values</strong></th>
</tr>
<tr class="gt_col_headings even">
<th id="nidHeightId" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">nidHeightId</th>
<th id="n_dams" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">n_dams</th>
<th id="n_missing_surfaceArea" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">n_missing_surfaceArea</th>
<th id="pct_missing_surfaceArea" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">pct_missing_surfaceArea</th>
<th id="rowid" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">rowid</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="nidHeightId">Less than 25 feet</td>
<td class="gt_row gt_right" headers="n_dams">43011</td>
<td class="gt_row gt_right" headers="n_missing_surfaceArea">10887</td>
<td class="gt_row gt_right" headers="pct_missing_surfaceArea">25.31%</td>
<td class="gt_row gt_right" headers="rowid">1</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="nidHeightId">51-100 feet</td>
<td class="gt_row gt_right" headers="n_dams">5023</td>
<td class="gt_row gt_right" headers="n_missing_surfaceArea">514</td>
<td class="gt_row gt_right" headers="pct_missing_surfaceArea">10.23%</td>
<td class="gt_row gt_right" headers="rowid">2</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="nidHeightId">25-50 feet</td>
<td class="gt_row gt_right" headers="n_dams">36294</td>
<td class="gt_row gt_right" headers="n_missing_surfaceArea">5719</td>
<td class="gt_row gt_right" headers="pct_missing_surfaceArea">15.76%</td>
<td class="gt_row gt_right" headers="rowid">3</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="nidHeightId">Greater than 100 feet</td>
<td class="gt_row gt_right" headers="n_dams">1526</td>
<td class="gt_row gt_right" headers="n_missing_surfaceArea">190</td>
<td class="gt_row gt_right" headers="pct_missing_surfaceArea">12.45%</td>
<td class="gt_row gt_right" headers="rowid">4</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="nidHeightId">Total</td>
<td class="gt_row gt_right" headers="n_dams">85854</td>
<td class="gt_row gt_right" headers="n_missing_surfaceArea">17310</td>
<td class="gt_row gt_right" headers="pct_missing_surfaceArea">20.16%</td>
<td class="gt_row gt_right" headers="rowid">5</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-tbl" id="tbl-missing-surfaceArea-by-nidHeightId-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;10.4: Missing surfaceArea by nidHeightId
</figcaption>
</figure>
</div>
</div>
<p><br></p>
<p>Let’s proceed with exploring <span class="math inline">\(H_2\)</span>, recognizing that for some states the results may not be useful.</p>
</section>
<section id="plots" class="level4 page-columns page-full" data-number="10.4.1.2">
<h4 data-number="10.4.1.2" class="anchored" data-anchor-id="plots"><span class="header-section-number">10.4.1.2</span> Plots</h4>
<p>In this section I look at the distributions and relationship between <code>surfaceArea</code> and <code>nidStorage</code> before exploring their associations with <span class="math inline">\(tri\_mean_{sample}\)</span> in the next section.</p>
<p>Of note in <a href="#fig-distributions-of-surfaceArea-and-nidStorage-by-state" class="quarto-xref">Figure&nbsp;<span>10.11</span></a>:</p>
<ul>
<li>The distributions of <code>surfaceArea</code>, <code>nidStorage</code>, and <span class="math inline">\(\frac{surfaceArea}{nidStorage}\)</span> differ in many states. I’m not sure what to make of this fact.</li>
</ul>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>dta_for_plot <span class="ot">&lt;-</span> dta_for_model <span class="sc">|&gt;</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(surfaceArea),</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>         <span class="sc">!</span><span class="fu">is.na</span>(nidStorage)) <span class="sc">|&gt;</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">state_median_surfaceArea =</span> <span class="fu">median</span>(surfaceArea),</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">state_median_nidStorage =</span> <span class="fu">median</span>(nidStorage),</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">state_median_area_to_vol =</span> <span class="fu">median</span>(area_to_volume_dam),</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">.by =</span> state_abb) <span class="sc">|&gt;</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">state_abb =</span> <span class="fu">fct_reorder</span>(state_abb, state_median_surfaceArea))</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>p1_surfaceArea_by_state <span class="ot">&lt;-</span> dta_for_plot <span class="sc">|&gt;</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density_ridges</span>(</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(surfaceArea, state_abb, <span class="at">fill =</span> region_label),</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">rel_min_height =</span> <span class="fl">0.005</span>,</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.1</span>,</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="cn">NA</span>,</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> dta_for_plot <span class="sc">|&gt;</span></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>      <span class="fu">distinct</span>(state_abb, state_median_surfaceArea),</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(state_median_surfaceArea, state_abb, <span class="at">label =</span> <span class="st">"^"</span>),</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">4</span>,</span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.75</span>,</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"firebrick"</span></span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">label =</span> <span class="fu">label_number</span>(<span class="at">scale_cut =</span> <span class="fu">cut_short_scale</span>())) <span class="sc">+</span></span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"firebrick"</span>, <span class="st">"darkslategrey"</span>, <span class="st">"blue"</span>, <span class="st">"skyblue"</span>)) <span class="sc">+</span></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># guides(fill = guide_legend(position = "inside")) +</span></span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">"none"</span>) <span class="sc">+</span> <span class="co">#guide_legend(position = "inside")) +</span></span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position.inside =</span> <span class="fu">c</span>(<span class="fl">0.75</span>, <span class="fl">0.15</span>)) <span class="sc">+</span></span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"A. surfaceArea&lt;br&gt;"</span>,</span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="cn">NULL</span></span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a>p2_nidStorage_by_state <span class="ot">&lt;-</span> dta_for_plot <span class="sc">|&gt;</span></span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb30-39"><a href="#cb30-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density_ridges</span>(</span>
<span id="cb30-40"><a href="#cb30-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(nidStorage, state_abb, <span class="at">fill =</span> region_label),</span>
<span id="cb30-41"><a href="#cb30-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">rel_min_height =</span> <span class="fl">0.005</span>,</span>
<span id="cb30-42"><a href="#cb30-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.1</span>,</span>
<span id="cb30-43"><a href="#cb30-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="cn">NA</span>,</span>
<span id="cb30-44"><a href="#cb30-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb30-45"><a href="#cb30-45" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb30-46"><a href="#cb30-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb30-47"><a href="#cb30-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> dta_for_plot <span class="sc">|&gt;</span></span>
<span id="cb30-48"><a href="#cb30-48" aria-hidden="true" tabindex="-1"></a>      <span class="fu">distinct</span>(state_abb, state_median_nidStorage),</span>
<span id="cb30-49"><a href="#cb30-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(state_median_nidStorage, state_abb, <span class="at">label =</span> <span class="st">"^"</span>),</span>
<span id="cb30-50"><a href="#cb30-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">4</span>,</span>
<span id="cb30-51"><a href="#cb30-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.75</span>,</span>
<span id="cb30-52"><a href="#cb30-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"firebrick"</span></span>
<span id="cb30-53"><a href="#cb30-53" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb30-54"><a href="#cb30-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">label =</span> <span class="fu">label_number</span>(<span class="at">scale_cut =</span> <span class="fu">cut_short_scale</span>())) <span class="sc">+</span></span>
<span id="cb30-55"><a href="#cb30-55" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_x_continuous(label = label_number(scale_cut = cut_short_scale())) +</span></span>
<span id="cb30-56"><a href="#cb30-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"firebrick"</span>, <span class="st">"darkslategrey"</span>, <span class="st">"blue"</span>, <span class="st">"skyblue"</span>)) <span class="sc">+</span></span>
<span id="cb30-57"><a href="#cb30-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">"none"</span>) <span class="sc">+</span> <span class="co">#guide_legend(position = "inside")) +</span></span>
<span id="cb30-58"><a href="#cb30-58" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme(legend.position.inside = c(0.75, 0.15)) +</span></span>
<span id="cb30-59"><a href="#cb30-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1e6</span>)) <span class="sc">+</span></span>
<span id="cb30-60"><a href="#cb30-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb30-61"><a href="#cb30-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"B. nidStorage&lt;br&gt;"</span>,</span>
<span id="cb30-62"><a href="#cb30-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="cn">NULL</span></span>
<span id="cb30-63"><a href="#cb30-63" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb30-64"><a href="#cb30-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-65"><a href="#cb30-65" aria-hidden="true" tabindex="-1"></a>p3_surface_area_nidStorage_by_state <span class="ot">&lt;-</span> dta_for_plot <span class="sc">|&gt;</span></span>
<span id="cb30-66"><a href="#cb30-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb30-67"><a href="#cb30-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density_ridges</span>(</span>
<span id="cb30-68"><a href="#cb30-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(area_to_volume_dam, state_abb, <span class="at">fill =</span> region_label),</span>
<span id="cb30-69"><a href="#cb30-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">rel_min_height =</span> <span class="fl">0.005</span>,</span>
<span id="cb30-70"><a href="#cb30-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.1</span>,</span>
<span id="cb30-71"><a href="#cb30-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="cn">NA</span>,</span>
<span id="cb30-72"><a href="#cb30-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb30-73"><a href="#cb30-73" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb30-74"><a href="#cb30-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb30-75"><a href="#cb30-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> dta_for_plot <span class="sc">|&gt;</span></span>
<span id="cb30-76"><a href="#cb30-76" aria-hidden="true" tabindex="-1"></a>      <span class="fu">distinct</span>(state_abb, state_median_area_to_vol),</span>
<span id="cb30-77"><a href="#cb30-77" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(state_median_area_to_vol, state_abb, <span class="at">label =</span> <span class="st">"^"</span>),</span>
<span id="cb30-78"><a href="#cb30-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">4</span>,</span>
<span id="cb30-79"><a href="#cb30-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.75</span>,</span>
<span id="cb30-80"><a href="#cb30-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"firebrick"</span></span>
<span id="cb30-81"><a href="#cb30-81" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb30-82"><a href="#cb30-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">label =</span> <span class="fu">label_number</span>(<span class="at">scale_cut =</span> <span class="fu">cut_short_scale</span>())) <span class="sc">+</span></span>
<span id="cb30-83"><a href="#cb30-83" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_x_continuous(label = label_number(scale_cut = cut_short_scale())) +</span></span>
<span id="cb30-84"><a href="#cb30-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"firebrick"</span>, <span class="st">"darkslategrey"</span>, <span class="st">"blue"</span>, <span class="st">"skyblue"</span>)) <span class="sc">+</span></span>
<span id="cb30-85"><a href="#cb30-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">"none"</span>) <span class="sc">+</span> <span class="co">#guide_legend(position = "inside")) +</span></span>
<span id="cb30-86"><a href="#cb30-86" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme(legend.position.inside = c(0.75, 0.15)) +</span></span>
<span id="cb30-87"><a href="#cb30-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">0.001</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb30-88"><a href="#cb30-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb30-89"><a href="#cb30-89" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"C. surfaceArea / nidStorage&lt;br&gt;"</span>,</span>
<span id="cb30-90"><a href="#cb30-90" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="cn">NULL</span></span>
<span id="cb30-91"><a href="#cb30-91" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb30-92"><a href="#cb30-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-93"><a href="#cb30-93" aria-hidden="true" tabindex="-1"></a>p4_n_dams_by_state <span class="ot">&lt;-</span> dta_for_plot <span class="sc">|&gt;</span></span>
<span id="cb30-94"><a href="#cb30-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb30-95"><a href="#cb30-95" aria-hidden="true" tabindex="-1"></a>          <span class="at">.by =</span> <span class="fu">c</span>(state_abb, region_label)) <span class="sc">|&gt;</span></span>
<span id="cb30-96"><a href="#cb30-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb30-97"><a href="#cb30-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(</span>
<span id="cb30-98"><a href="#cb30-98" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(n, state_abb, <span class="at">fill =</span> region_label),</span>
<span id="cb30-99"><a href="#cb30-99" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.1</span>,</span>
<span id="cb30-100"><a href="#cb30-100" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="cn">NA</span>,</span>
<span id="cb30-101"><a href="#cb30-101" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb30-102"><a href="#cb30-102" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb30-103"><a href="#cb30-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> <span class="fu">label_number</span>(<span class="at">scale_cut =</span> <span class="fu">cut_short_scale</span>())) <span class="sc">+</span></span>
<span id="cb30-104"><a href="#cb30-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"firebrick"</span>, <span class="st">"darkslategrey"</span>, <span class="st">"blue"</span>, <span class="st">"skyblue"</span>)) <span class="sc">+</span></span>
<span id="cb30-105"><a href="#cb30-105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb30-106"><a href="#cb30-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb30-107"><a href="#cb30-107" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"D. Number of dams"</span>,</span>
<span id="cb30-108"><a href="#cb30-108" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"n dams with surfaceArea</span><span class="sc">\n</span><span class="st">and nidStorage values"</span>,</span>
<span id="cb30-109"><a href="#cb30-109" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="cn">NULL</span></span>
<span id="cb30-110"><a href="#cb30-110" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb30-111"><a href="#cb30-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-112"><a href="#cb30-112" aria-hidden="true" tabindex="-1"></a>my_layout <span class="ot">&lt;-</span></span>
<span id="cb30-113"><a href="#cb30-113" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="st">"</span></span>
<span id="cb30-114"><a href="#cb30-114" aria-hidden="true" tabindex="-1"></a><span class="st">ABCD"</span>)</span>
<span id="cb30-115"><a href="#cb30-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-116"><a href="#cb30-116" aria-hidden="true" tabindex="-1"></a>p1_surfaceArea_by_state <span class="sc">+</span> p2_nidStorage_by_state <span class="sc">+</span> </span>
<span id="cb30-117"><a href="#cb30-117" aria-hidden="true" tabindex="-1"></a>  p3_surface_area_nidStorage_by_state <span class="sc">+</span> p4_n_dams_by_state <span class="sc">+</span></span>
<span id="cb30-118"><a href="#cb30-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb30-119"><a href="#cb30-119" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distributions by state: surfaceArea, nidStorage, and surfaceArea / nidStorage"</span>,</span>
<span id="cb30-120"><a href="#cb30-120" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">glue</span>(<span class="st">"Red indicator is median for each subplot. All rows sorted by median surfaceArea."</span>,</span>
<span id="cb30-121"><a href="#cb30-121" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"</span><span class="sc">\n</span><span class="st">X axis in panels A-C are on log10 scale.&lt;br&gt;"</span>),</span>
<span id="cb30-122"><a href="#cb30-122" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> my_caption_nid_opentopography</span>
<span id="cb30-123"><a href="#cb30-123" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb30-124"><a href="#cb30-124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">design =</span> my_layout) <span class="sc">&amp;</span></span>
<span id="cb30-125"><a href="#cb30-125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_textbox_simple</span>(),</span>
<span id="cb30-126"><a href="#cb30-126" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_textbox_simple</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div id="fig-distributions-of-surfaceArea-and-nidStorage-by-state" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-distributions-of-surfaceArea-and-nidStorage-by-state-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="page-columns page-full">
<img src="ruggedness_files/figure-html/fig-distributions-of-surfaceArea-and-nidStorage-by-state-1.png" class="img-fluid figure-img column-page-right" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-distributions-of-surfaceArea-and-nidStorage-by-state-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10.11: Distributions by state: surfaceArea, nidStorage, and surfaceArea / nidStorage
</figcaption>
</figure>
</div>
</div>
</div>
<p><br></p>
<p>Of note re: <a href="#fig-distributions-of-surfaceArea-and-nidStorage-by-state-facet-by-nidHeightId" class="quarto-xref">Figure&nbsp;<span>10.12</span></a>:</p>
<p>Faceting by <code>nidHeightId</code> shows the distributions of the largest dams “Greater than 100 ft” have the most variation in the distributions. This is due in part to the much larger <code>nidHeight</code> range in this category (~101 to ~800 ft).</p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>dta_for_plot <span class="ot">&lt;-</span> dta_for_model <span class="sc">|&gt;</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(surfaceArea),</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>         <span class="sc">!</span><span class="fu">is.na</span>(nidStorage)) <span class="sc">|&gt;</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">state_median_surfaceArea =</span> <span class="fu">median</span>(surfaceArea),</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">state_median_nidStorage =</span> <span class="fu">median</span>(nidStorage),</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">state_median_area_to_vol =</span> <span class="fu">median</span>(area_to_volume_dam),</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">.by =</span> state_abb) <span class="sc">|&gt;</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">state_abb =</span> <span class="fu">fct_reorder</span>(state_abb, state_median_surfaceArea))</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>p1_surfaceArea_by_state <span class="ot">&lt;-</span> dta_for_plot <span class="sc">|&gt;</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density_ridges</span>(</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(surfaceArea, state_abb, <span class="at">fill =</span> region_label),</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">rel_min_height =</span> <span class="fl">0.005</span>,</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.1</span>,</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="cn">NA</span>,</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> dta_for_plot <span class="sc">|&gt;</span></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>      <span class="fu">distinct</span>(state_abb, state_median_surfaceArea),</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(state_median_surfaceArea, state_abb, <span class="at">label =</span> <span class="st">"^"</span>),</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">4</span>,</span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.75</span>,</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"firebrick"</span></span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">label =</span> <span class="fu">label_number</span>(<span class="at">scale_cut =</span> <span class="fu">cut_short_scale</span>())) <span class="sc">+</span></span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"firebrick"</span>, <span class="st">"darkslategrey"</span>, <span class="st">"blue"</span>, <span class="st">"skyblue"</span>)) <span class="sc">+</span></span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># guides(fill = guide_legend(position = "inside")) +</span></span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">"none"</span>) <span class="sc">+</span> <span class="co">#guide_legend(position = "inside")) +</span></span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position.inside =</span> <span class="fu">c</span>(<span class="fl">0.75</span>, <span class="fl">0.15</span>),</span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">0.75</span>))) <span class="sc">+</span></span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> nidHeightId, <span class="at">nrow =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"A. surfaceArea&lt;br&gt;"</span>,</span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="cn">NULL</span></span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true" tabindex="-1"></a>p2_nidStorage_by_state <span class="ot">&lt;-</span> dta_for_plot <span class="sc">|&gt;</span></span>
<span id="cb31-40"><a href="#cb31-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb31-41"><a href="#cb31-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density_ridges</span>(</span>
<span id="cb31-42"><a href="#cb31-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(nidStorage, state_abb, <span class="at">fill =</span> region_label),</span>
<span id="cb31-43"><a href="#cb31-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">rel_min_height =</span> <span class="fl">0.005</span>,</span>
<span id="cb31-44"><a href="#cb31-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.1</span>,</span>
<span id="cb31-45"><a href="#cb31-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="cn">NA</span>,</span>
<span id="cb31-46"><a href="#cb31-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb31-47"><a href="#cb31-47" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb31-48"><a href="#cb31-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb31-49"><a href="#cb31-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> dta_for_plot <span class="sc">|&gt;</span></span>
<span id="cb31-50"><a href="#cb31-50" aria-hidden="true" tabindex="-1"></a>      <span class="fu">distinct</span>(state_abb, state_median_nidStorage),</span>
<span id="cb31-51"><a href="#cb31-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(state_median_nidStorage, state_abb, <span class="at">label =</span> <span class="st">"^"</span>),</span>
<span id="cb31-52"><a href="#cb31-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">4</span>,</span>
<span id="cb31-53"><a href="#cb31-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.75</span>,</span>
<span id="cb31-54"><a href="#cb31-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"firebrick"</span></span>
<span id="cb31-55"><a href="#cb31-55" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb31-56"><a href="#cb31-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">label =</span> <span class="fu">label_number</span>(<span class="at">scale_cut =</span> <span class="fu">cut_short_scale</span>())) <span class="sc">+</span></span>
<span id="cb31-57"><a href="#cb31-57" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_x_continuous(label = label_number(scale_cut = cut_short_scale())) +</span></span>
<span id="cb31-58"><a href="#cb31-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"firebrick"</span>, <span class="st">"darkslategrey"</span>, <span class="st">"blue"</span>, <span class="st">"skyblue"</span>)) <span class="sc">+</span></span>
<span id="cb31-59"><a href="#cb31-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">"none"</span>) <span class="sc">+</span> <span class="co">#guide_legend(position = "inside")) +</span></span>
<span id="cb31-60"><a href="#cb31-60" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme(legend.position.inside = c(0.75, 0.15)) +</span></span>
<span id="cb31-61"><a href="#cb31-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">0.75</span>))) <span class="sc">+</span></span>
<span id="cb31-62"><a href="#cb31-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> nidHeightId, <span class="at">nrow =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb31-63"><a href="#cb31-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1e6</span>)) <span class="sc">+</span></span>
<span id="cb31-64"><a href="#cb31-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb31-65"><a href="#cb31-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"B. nidStorage&lt;br&gt;"</span>,</span>
<span id="cb31-66"><a href="#cb31-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="cn">NULL</span></span>
<span id="cb31-67"><a href="#cb31-67" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb31-68"><a href="#cb31-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-69"><a href="#cb31-69" aria-hidden="true" tabindex="-1"></a>my_layout <span class="ot">&lt;-</span></span>
<span id="cb31-70"><a href="#cb31-70" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="st">"</span></span>
<span id="cb31-71"><a href="#cb31-71" aria-hidden="true" tabindex="-1"></a><span class="st">AB"</span>)</span>
<span id="cb31-72"><a href="#cb31-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-73"><a href="#cb31-73" aria-hidden="true" tabindex="-1"></a>p1_surfaceArea_by_state <span class="sc">+</span> p2_nidStorage_by_state <span class="sc">+</span> </span>
<span id="cb31-74"><a href="#cb31-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb31-75"><a href="#cb31-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribution of surfaceArea and nidStorage by nidHeightId - continental states"</span>,</span>
<span id="cb31-76"><a href="#cb31-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">glue</span>(<span class="st">"Red indicator is median for all nidHeightId. All rows sorted by median surfaceArea."</span>,</span>
<span id="cb31-77"><a href="#cb31-77" aria-hidden="true" tabindex="-1"></a>                    <span class="st">" X axes are on log10 scale.&lt;br&gt;"</span>),</span>
<span id="cb31-78"><a href="#cb31-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> my_caption_nid_opentopography</span>
<span id="cb31-79"><a href="#cb31-79" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb31-80"><a href="#cb31-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">design =</span> my_layout) <span class="sc">&amp;</span></span>
<span id="cb31-81"><a href="#cb31-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_textbox_simple</span>(),</span>
<span id="cb31-82"><a href="#cb31-82" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_textbox_simple</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div id="fig-distributions-of-surfaceArea-and-nidStorage-by-state-facet-by-nidHeightId" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-distributions-of-surfaceArea-and-nidStorage-by-state-facet-by-nidHeightId-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="page-columns page-full">
<img src="ruggedness_files/figure-html/fig-distributions-of-surfaceArea-and-nidStorage-by-state-facet-by-nidHeightId-1.png" class="img-fluid figure-img column-page-right" width="1152">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-distributions-of-surfaceArea-and-nidStorage-by-state-facet-by-nidHeightId-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10.12: Distribution of surfaceArea and nidStorage in each state
</figcaption>
</figure>
</div>
</div>
</div>
<p><br></p>
<p>Of note re: <a href="#fig-h2-visualization" class="quarto-xref">Figure&nbsp;<span>10.13</span></a>:</p>
<ul>
<li><p>This plot is helpful in exploring the relationship between <code>surfaceArea</code> and <code>nidStorage</code>.</p></li>
<li><p>There appear to be data errors, data entry errors, or estimation heuristics at play at small <code>surfaceArea</code> values around 1 acre (see horizontal lines in panel A).</p></li>
<li><p>Otherwise, there appears to be near-linear relationships between <code>surfaceArea</code> and <code>nidStorage</code>, implying that dams generally have a similar “shape”: they grow in <code>surfaceArea</code> as <code>nidStorage</code> grows.</p></li>
</ul>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> dta_for_model <span class="sc">|&gt;</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(surfaceArea),</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>         <span class="sc">!</span><span class="fu">is.na</span>(nidStorage)) <span class="sc">|&gt;</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(nidStorage, surfaceArea, <span class="at">color =</span> nidHeightId, <span class="at">group =</span> nidHeightId)) <span class="sc">+</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">0.25</span>,</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.25</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">label =</span> <span class="fu">label_number</span>(<span class="at">scale_cut =</span> <span class="fu">cut_short_scale</span>())) <span class="sc">+</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">label =</span> <span class="fu">label_number</span>(<span class="at">scale_cut =</span> <span class="fu">cut_short_scale</span>())) <span class="sc">+</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"firebrick"</span>, <span class="st">"darkslategrey"</span>, <span class="st">"blue"</span>, <span class="st">"skyblue"</span>)) <span class="sc">+</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"A. storage_area / nidStorage&lt;br&gt;"</span>,</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"nidStorage (log10 scale)"</span>,</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"surfaceArea (log10 scale)"</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> dta_for_model <span class="sc">|&gt;</span></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(surfaceArea),</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>         <span class="sc">!</span><span class="fu">is.na</span>(nidStorage)) <span class="sc">|&gt;</span></span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(nidStorage, surfaceArea, <span class="at">color =</span> nidHeightId, <span class="at">group =</span> nidHeightId)) <span class="sc">+</span></span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">'gam'</span>,</span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> y <span class="sc">~</span> <span class="fu">s</span>(x, <span class="at">bs =</span> <span class="st">"cs"</span>),</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.5</span>,</span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># size = 0.25,</span></span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.8</span>,</span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">label =</span> <span class="fu">label_number</span>(<span class="at">scale_cut =</span> <span class="fu">cut_short_scale</span>())) <span class="sc">+</span></span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">label =</span> <span class="fu">label_number</span>(<span class="at">scale_cut =</span> <span class="fu">cut_short_scale</span>())) <span class="sc">+</span></span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"firebrick"</span>, <span class="st">"darkslategrey"</span>, <span class="st">"blue"</span>, <span class="st">"skyblue"</span>)) <span class="sc">+</span></span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">position =</span> <span class="st">"inside"</span>,</span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a>                              <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linewidth =</span> <span class="dv">3</span>))) <span class="sc">+</span></span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position.inside =</span> <span class="fu">c</span>(<span class="fl">0.35</span>, <span class="fl">0.85</span>)) <span class="sc">+</span></span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"B. Regression line plot (same data)&lt;br&gt;"</span>,</span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"nidStorage (log10 scale)"</span>,</span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="cn">NULL</span></span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb32-41"><a href="#cb32-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-42"><a href="#cb32-42" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> </span>
<span id="cb32-43"><a href="#cb32-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb32-44"><a href="#cb32-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"surfaceArea by nidStorage - all dams"</span>,</span>
<span id="cb32-45"><a href="#cb32-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># subtitle = "REPLACE ME&lt;br&gt;",</span></span>
<span id="cb32-46"><a href="#cb32-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> my_caption_nid_opentopography</span>
<span id="cb32-47"><a href="#cb32-47" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">&amp;</span></span>
<span id="cb32-48"><a href="#cb32-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_textbox_simple</span>(),</span>
<span id="cb32-49"><a href="#cb32-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_textbox_simple</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div id="fig-h2-visualization" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-h2-visualization-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="page-columns page-full">
<img src="ruggedness_files/figure-html/fig-h2-visualization-1.png" class="img-fluid figure-img column-page-right" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-h2-visualization-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10.13: surfaceArea by nidStorage - all dams
</figcaption>
</figure>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="sec-h2-mod1" class="level4" data-number="10.4.1.3">
<h4 data-number="10.4.1.3" class="anchored" data-anchor-id="sec-h2-mod1"><span class="header-section-number">10.4.1.3</span> Model mod.h2.1</h4>
<p>The model mod.h2.1 has some explanatory power. <span class="math inline">\(R^2\)</span> = 0.38.</p>
<p><span class="math display">\[mod.h2.1: surfaceArea \sim nidStorage\]</span></p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>mod.h2<span class="fl">.1</span> <span class="ot">&lt;-</span> dta_for_model <span class="sc">|&gt;</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(surfaceArea <span class="sc">~</span> nidStorage,</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">data =</span> _)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod.h2<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = surfaceArea ~ nidStorage, data = dta_for_model)

Residuals:
    Min      1Q  Median      3Q     Max 
-145078    -151    -146    -132  399225 

Coefficients:
                Estimate   Std. Error t value Pr(&gt;|t|)    
(Intercept) 155.48337258  12.43326056   12.51   &lt;2e-16 ***
nidStorage    0.01017373   0.00004963  205.01   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3240 on 68054 degrees of freedom
  (17798 observations deleted due to missingness)
Multiple R-squared:  0.3818,    Adjusted R-squared:  0.3818 
F-statistic: 4.203e+04 on 1 and 68054 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p><br></p>
</section>
<section id="sec-h2-mod2" class="level4" data-number="10.4.1.4">
<h4 data-number="10.4.1.4" class="anchored" data-anchor-id="sec-h2-mod2"><span class="header-section-number">10.4.1.4</span> Model mod.h2.2</h4>
<p>The model mod.h2.2 has some explanatory power. <span class="math inline">\(R^2\)</span> = 0.39 (which is less improvement over mod.h2.1 than I expected). So there isn’t really a state-level effect on the ratio <span class="math inline">\(surfaceArea::nidStorage\)</span>.</p>
<p><span class="math display">\[mod.h2.2: surfaceArea \sim nidStorage | state\]</span></p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>mod.h2<span class="fl">.2</span> <span class="ot">&lt;-</span> dta_for_model <span class="sc">|&gt;</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">surfaceArea_scaled =</span> <span class="fu">scale</span>(surfaceArea),</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">nidStorage_scaled =</span> <span class="fu">scale</span>(nidStorage)) <span class="sc">|&gt;</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lmer</span>(surfaceArea <span class="sc">~</span> nidStorage_scaled <span class="sc">+</span> state_abb <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> state_abb),</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">data =</span> _)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod.h2<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: surfaceArea ~ nidStorage_scaled + state_abb + (1 | state_abb)
   Data: mutate(dta_for_model, surfaceArea_scaled = scale(surfaceArea),  
    nidStorage_scaled = scale(nidStorage))

REML criterion at convergence: 1292501

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-44.635  -0.038  -0.016  -0.008 123.305 

Random effects:
 Groups    Name        Variance Std.Dev.
 state_abb (Intercept)     3713   60.93 
 Residual              10454667 3233.37 
Number of obs: 68056, groups:  state_abb, 48

Fixed effects:
                  Estimate Std. Error t value
(Intercept)        141.797    366.601   0.387
nidStorage_scaled 2296.989     11.217 204.777
state_abbFL        314.508    384.745   0.817
state_abbMI        211.262    385.632   0.548
state_abbLA        504.886    391.486   1.290
state_abbIL        249.938    392.183   0.637
state_abbMN       1410.151    390.375   3.612
state_abbND        -78.014    390.353  -0.200
state_abbMS        -29.856    375.369  -0.080
state_abbTX         76.693    374.188   0.205
state_abbKS         18.274    378.782   0.048
state_abbWI        764.930    387.355   1.975
state_abbOK         43.983    374.918   0.117
state_abbNE        -20.414    376.458  -0.054
state_abbRI         19.966    433.194   0.046
state_abbIN          6.842    385.174   0.018
state_abbSD        530.707    397.678   1.335
state_abbSC         82.017    377.787   0.217
state_abbAL        496.076    397.146   1.249
state_abbIA         -4.798    375.155  -0.013
state_abbMO        -14.619    374.252  -0.039
state_abbGA          4.605    374.407   0.012
state_abbAR        717.161    389.205   1.843
state_abbNJ          8.135    389.746   0.021
state_abbOH         21.453    382.068   0.056
state_abbME       1045.453    397.426   2.631
state_abbMD          3.124    410.381   0.008
state_abbMA         22.566    384.116   0.059
state_abbMT        157.714    398.124   0.396
state_abbTN        152.525    383.668   0.398
state_abbVA         -3.916    379.463  -0.010
state_abbCT          6.443    389.202   0.017
state_abbNC          3.552    376.362   0.009
state_abbWY         55.390    381.273   0.145
state_abbNM        258.783    415.748   0.622
state_abbNH        175.393    393.391   0.446
state_abbNY        169.048    379.331   0.446
state_abbNV       -229.166    399.539  -0.574
state_abbAZ       -234.985    416.789  -0.564
state_abbKY        201.683    386.604   0.522
state_abbPA         17.651    382.504   0.046
state_abbWA        259.276    391.631   0.662
state_abbID        821.693    407.604   2.016
state_abbVT         30.464    410.063   0.074
state_abbOR        304.713    390.128   0.781
state_abbCO        234.956    378.961   0.620
state_abbUT        802.745    660.980   1.214
state_abbCA        147.673    382.018   0.387
state_abbWV         51.198    405.764   0.126</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>r_squared <span class="ot">&lt;-</span> <span class="fu">rsq</span>(mod.h2<span class="fl">.2</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>rsq_comment <span class="ot">&lt;-</span> <span class="fu">glue</span>(</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"r_squared: {round(r_squared$model, digits = 2)}"</span>, </span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>     <span class="st">"</span><span class="sc">\n</span><span class="st">consisting of fixed effects: {round(r_squared$fixed, digits = 2)}"</span>, </span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>     <span class="st">" and random effects: {round(r_squared$random, digits = 2)}"</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><br></p>
</section>
</section>
<section id="sec-plots-tri-mean-sample" class="level3 page-columns page-full" data-number="10.4.2">
<h3 data-number="10.4.2" class="anchored" data-anchor-id="sec-plots-tri-mean-sample"><span class="header-section-number">10.4.2</span> Second: exploring the relationship among tri_mean<sub>sample</sub>, <code>sufaceArea</code>, and <code>nidStorage</code></h3>
<section id="plots-1" class="level4 page-columns page-full" data-number="10.4.2.1">
<h4 data-number="10.4.2.1" class="anchored" data-anchor-id="plots-1"><span class="header-section-number">10.4.2.1</span> Plots</h4>
<p>Of note re: <a href="#fig-tri-mean-sample-by-surfaceArea" class="quarto-xref">Figure&nbsp;<span>10.14</span></a>:</p>
<ul>
<li><p>The near-vertical nature of the categories in panel A indicate that there is no strong relationship between <span class="math inline">\(tri\_mean_{sample}\)</span> and <code>surfaceArea</code>.</p></li>
<li><p>One could tell a story from panel B if the model explained a lot of the variability (which is not likely given panel A). Regression <em>sec-h3-mod1 Model 1</em> confirms this. Only when we adjust for state does the model capture some of the variability: <em>sec-h3-mod4 Model 4</em>.</p>
<ul>
<li><p>The more <code>surfaceArea</code>, the lower the <span class="math inline">\(tri\_mean_{sample}\)</span> (panel B). This makes some sense, since lakes behind dams are flat, resulting in lower <span class="math inline">\(tri\_mean_{sample}\)</span>.</p></li>
<li><p>The regression lines are somewhat parallel: in general, for any <code>surfaceArea</code> value, the higher the <code>nidHeightId</code>, the higher the <span class="math inline">\(tri\_mean_{sample}\)</span>.</p></li>
</ul></li>
</ul>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> dta_for_model <span class="sc">|&gt;</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(surfaceArea),</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>         <span class="sc">!</span><span class="fu">is.na</span>(nidStorage)) <span class="sc">|&gt;</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(surfaceArea, tri_mean_sample, <span class="at">color =</span> nidHeightId, <span class="at">group =</span> nidHeightId)) <span class="sc">+</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">0.25</span>,</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.25</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">label =</span> <span class="fu">label_number</span>(<span class="at">scale_cut =</span> <span class="fu">cut_short_scale</span>())) <span class="sc">+</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">label =</span> <span class="fu">label_number</span>(<span class="at">scale_cut =</span> <span class="fu">cut_short_scale</span>())) <span class="sc">+</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_y_continuous(label = label_number(scale_cut = cut_short_scale())) +</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"firebrick"</span>, <span class="st">"darkslategrey"</span>, <span class="st">"blue"</span>, <span class="st">"skyblue"</span>)) <span class="sc">+</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"A. Scatter plot&lt;br&gt;"</span>,</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"surface_area (log10 scale)"</span>,</span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"tri_mean_sample (log10 scale)"</span></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> dta_for_model <span class="sc">|&gt;</span></span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(surfaceArea),</span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>         <span class="sc">!</span><span class="fu">is.na</span>(nidStorage)) <span class="sc">|&gt;</span></span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(surfaceArea, tri_mean_sample, <span class="at">color =</span> nidHeightId, <span class="at">group =</span> nidHeightId)) <span class="sc">+</span></span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(</span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">'gam'</span>,</span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> y <span class="sc">~</span> <span class="fu">s</span>(x, <span class="at">bs =</span> <span class="st">"cs"</span>),</span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.5</span>,</span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># size = 0.25,</span></span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.8</span>,</span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">label =</span> <span class="fu">label_number</span>(<span class="at">scale_cut =</span> <span class="fu">cut_short_scale</span>())) <span class="sc">+</span></span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">label =</span> <span class="fu">label_number</span>(<span class="at">scale_cut =</span> <span class="fu">cut_short_scale</span>())) <span class="sc">+</span></span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"firebrick"</span>, <span class="st">"darkslategrey"</span>, <span class="st">"blue"</span>, <span class="st">"skyblue"</span>)) <span class="sc">+</span></span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">position =</span> <span class="st">"inside"</span>,</span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true" tabindex="-1"></a>                              <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linewidth =</span> <span class="dv">3</span>))) <span class="sc">+</span></span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position.inside =</span> <span class="fu">c</span>(<span class="fl">0.75</span>, <span class="fl">0.2</span>),</span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>)) <span class="sc">+</span></span>
<span id="cb38-39"><a href="#cb38-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb38-40"><a href="#cb38-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb38-41"><a href="#cb38-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"B. Regression line plot (same data)&lt;br&gt;"</span>,</span>
<span id="cb38-42"><a href="#cb38-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"surface_area (log10 scale)"</span>,</span>
<span id="cb38-43"><a href="#cb38-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="cn">NULL</span></span>
<span id="cb38-44"><a href="#cb38-44" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb38-45"><a href="#cb38-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-46"><a href="#cb38-46" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> </span>
<span id="cb38-47"><a href="#cb38-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb38-48"><a href="#cb38-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"tri_mean&lt;sub&gt;sample&lt;/sub&gt; by surfaceArea&lt;br&gt;for local areas around dams"</span>,</span>
<span id="cb38-49"><a href="#cb38-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> my_caption_nid_opentopography</span>
<span id="cb38-50"><a href="#cb38-50" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">&amp;</span></span>
<span id="cb38-51"><a href="#cb38-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_textbox_simple</span>(),</span>
<span id="cb38-52"><a href="#cb38-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_textbox_simple</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div id="fig-tri-mean-sample-by-surfaceArea" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-tri-mean-sample-by-surfaceArea-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="page-columns page-full">
<img src="ruggedness_files/figure-html/fig-tri-mean-sample-by-surfaceArea-1.png" class="img-fluid figure-img column-page-right" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-tri-mean-sample-by-surfaceArea-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10.14: tri_mean<sub>sample</sub> by surfaceArea
</figcaption>
</figure>
</div>
</div>
</div>
<p><br></p>
<p>Of note re: <a href="#fig-tri-mean-sample-by-nidStorage" class="quarto-xref">Figure&nbsp;<span>10.15</span></a>:</p>
<ul>
<li><p>It looks like there is a data entry artifact at <code>nidStorage</code> = 100 among small dams (the vertical line in panel A). The people estimating <code>nidStorage</code> probably use 100 acre-feet as a handy guestimate.</p></li>
<li><p>Like with <code>surfaceArea</code> in plot <a href="#fig-tri-mean-sample-by-surfaceArea" class="quarto-xref">Figure&nbsp;<span>10.14</span></a>, the near-vertical nature of the categories in panel A indicate that there is no strong relationship between <span class="math inline">\(tri\_mean_{sample}\)</span> and <code>surfaceArea</code>.</p></li>
<li><p>One could tell a story from panel B if the model explained a lot of the variability. Regression <em>sec-h3-mod2 Model 2</em> confirms this. Only when we adjust for state does the model capture some of the variability: <em>sec-h3-mod5 Model 5</em></p>
<ul>
<li><p>The more <code>nidStorage</code>, the lower the <span class="math inline">\(tri\_mean_{sample}\)</span> (panel B). This makes some sense, since <code>surfaceArea</code> grows as <code>nidStorage</code> grows (<a href="#fig-h2-visualization" class="quarto-xref">Figure&nbsp;<span>10.13</span></a>), and lakes behind dams are flat, resulting in lower <span class="math inline">\(tri\_mean_{sample}\)</span>.</p></li>
<li><p>The regression lines are somewhat parallel: in general, for any <code>surfaceArea</code> value, the higher the <code>nidHeightId</code>, the higher the <span class="math inline">\(tri\_mean_{sample}\)</span>.</p></li>
</ul></li>
</ul>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> dta_for_model <span class="sc">|&gt;</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(surfaceArea),</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>         <span class="sc">!</span><span class="fu">is.na</span>(nidStorage),</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>         nidStorage <span class="sc">&gt;=</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(nidStorage, tri_mean_sample, <span class="at">color =</span> nidHeightId, <span class="at">group =</span> nidHeightId)) <span class="sc">+</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">0.25</span>,</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.25</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">label =</span> <span class="fu">label_number</span>(<span class="at">scale_cut =</span> <span class="fu">cut_short_scale</span>())) <span class="sc">+</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">label =</span> <span class="fu">label_number</span>(<span class="at">scale_cut =</span> <span class="fu">cut_short_scale</span>())) <span class="sc">+</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"firebrick"</span>, <span class="st">"darkslategrey"</span>, <span class="st">"blue"</span>, <span class="st">"skyblue"</span>)) <span class="sc">+</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">100</span>)) <span class="sc">+</span><span class="fu">labs</span>(</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"A. Scatter plot"</span>,</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"nidStorage (log10 scale)"</span>,</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"tri_mean_sample (log10 scale)"</span></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> dta_for_model <span class="sc">|&gt;</span></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(surfaceArea),</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>         <span class="sc">!</span><span class="fu">is.na</span>(nidStorage),</span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>         nidStorage <span class="sc">&gt;=</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(nidStorage, tri_mean_sample, <span class="at">color =</span> nidHeightId, <span class="at">group =</span> nidHeightId)) <span class="sc">+</span></span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(</span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">'gam'</span>,</span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> y <span class="sc">~</span> <span class="fu">s</span>(x, <span class="at">bs =</span> <span class="st">"cs"</span>),</span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.5</span>,</span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.8</span>,</span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">label =</span> <span class="fu">label_number</span>(<span class="at">scale_cut =</span> <span class="fu">cut_short_scale</span>())) <span class="sc">+</span></span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">label =</span> <span class="fu">label_number</span>(<span class="at">scale_cut =</span> <span class="fu">cut_short_scale</span>())) <span class="sc">+</span></span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"firebrick"</span>, <span class="st">"darkslategrey"</span>, <span class="st">"blue"</span>, <span class="st">"skyblue"</span>)) <span class="sc">+</span></span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">position =</span> <span class="st">"inside"</span>,</span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a>                              <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linewidth =</span> <span class="dv">3</span>))) <span class="sc">+</span></span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position.inside =</span> <span class="fu">c</span>(<span class="fl">0.75</span>, <span class="fl">0.2</span>),</span>
<span id="cb39-37"><a href="#cb39-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>)) <span class="sc">+</span></span>
<span id="cb39-38"><a href="#cb39-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">100</span>)) <span class="sc">+</span><span class="fu">labs</span>(</span>
<span id="cb39-39"><a href="#cb39-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"B. Regression line plot (same data)&lt;br&gt;"</span>,</span>
<span id="cb39-40"><a href="#cb39-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"nidStorage (log10 scale)"</span>,</span>
<span id="cb39-41"><a href="#cb39-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="cn">NULL</span></span>
<span id="cb39-42"><a href="#cb39-42" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb39-43"><a href="#cb39-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-44"><a href="#cb39-44" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> </span>
<span id="cb39-45"><a href="#cb39-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb39-46"><a href="#cb39-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"tri_mean&lt;sub&gt;sample&lt;/sub&gt; by nidStorage&lt;br&gt;for local areas around dams"</span>,</span>
<span id="cb39-47"><a href="#cb39-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> my_caption_nid_opentopography</span>
<span id="cb39-48"><a href="#cb39-48" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">&amp;</span></span>
<span id="cb39-49"><a href="#cb39-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_textbox_simple</span>(),</span>
<span id="cb39-50"><a href="#cb39-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_textbox_simple</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div id="fig-tri-mean-sample-by-nidStorage" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-tri-mean-sample-by-nidStorage-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="page-columns page-full">
<img src="ruggedness_files/figure-html/fig-tri-mean-sample-by-nidStorage-1.png" class="img-fluid figure-img column-page-right" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-tri-mean-sample-by-nidStorage-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10.15: tri_mean<sub>sample</sub> by nidStorage<br>for local areas around dams
</figcaption>
</figure>
</div>
</div>
</div>
<p><br></p>
<p>Of note re: <a href="#fig-tri-mean-sample-and-surfaceArea-to-nidstorage" class="quarto-xref">Figure&nbsp;<span>10.16</span></a> :</p>
<p>The plots below using <span class="math inline">\(surfaceArea::nidStorage\)</span> are similar to those above, and the same conclusions apply.</p>
<ul>
<li><p>Panel A suggests no meaningful relationship between <span class="math inline">\(tri\_mean_{sample}\)</span> and <span class="math inline">\(\frac{surfaceArea}{nidStorage}\)</span></p></li>
<li><p>One could tell a story from panel B if the model explained a lot of the variability (which is not likely given panel A). Regression in <em><a href="#sec-h3-mod3" class="quarto-xref"><span>Section 10.5.2.3</span></a> Model 3</em> confirm this.</p>
<ul>
<li>The regression lines are somewhat parallel: in general, for any <span class="math inline">\(surfaceArea::nidStorage\)</span> ratio, the higher the <code>nidHeightId</code>, the higher the <span class="math inline">\(tri\_mean_{sample}\)</span>.</li>
</ul></li>
</ul>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> dta_for_model <span class="sc">|&gt;</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(surfaceArea),</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>         <span class="sc">!</span><span class="fu">is.na</span>(nidStorage)) <span class="sc">|&gt;</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(area_to_volume_dam, tri_mean_sample, <span class="at">color =</span> nidHeightId, <span class="at">group =</span> nidHeightId)) <span class="sc">+</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">0.25</span>,</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.25</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">label =</span> <span class="fu">label_number</span>(<span class="at">scale_cut =</span> <span class="fu">cut_short_scale</span>())) <span class="sc">+</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">label =</span> <span class="fu">label_number</span>(<span class="at">scale_cut =</span> <span class="fu">cut_short_scale</span>())) <span class="sc">+</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"firebrick"</span>, <span class="st">"darkslategrey"</span>, <span class="st">"blue"</span>, <span class="st">"skyblue"</span>)) <span class="sc">+</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"A. Scatter plot&lt;br&gt;"</span>,</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"surface_area::nidStorage (log10 scale)"</span>,</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"tri_mean_saample (log10 scale)"</span></span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> dta_for_model <span class="sc">|&gt;</span></span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(surfaceArea),</span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>         <span class="sc">!</span><span class="fu">is.na</span>(nidStorage)) <span class="sc">|&gt;</span></span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(area_to_volume_dam, tri_mean_sample, <span class="at">color =</span> nidHeightId, <span class="at">group =</span> nidHeightId)) <span class="sc">+</span></span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(</span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">'gam'</span>,</span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> y <span class="sc">~</span> <span class="fu">s</span>(x, <span class="at">bs =</span> <span class="st">"cs"</span>),</span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.5</span>,</span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.8</span>,</span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">label =</span> <span class="fu">label_number</span>(<span class="at">scale_cut =</span> <span class="fu">cut_short_scale</span>())) <span class="sc">+</span></span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">label =</span> <span class="fu">label_number</span>(<span class="at">scale_cut =</span> <span class="fu">cut_short_scale</span>())) <span class="sc">+</span></span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"firebrick"</span>, <span class="st">"darkslategrey"</span>, <span class="st">"blue"</span>, <span class="st">"skyblue"</span>)) <span class="sc">+</span></span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">position =</span> <span class="st">"inside"</span>,</span>
<span id="cb40-34"><a href="#cb40-34" aria-hidden="true" tabindex="-1"></a>                              <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linewidth =</span> <span class="dv">3</span>))) <span class="sc">+</span></span>
<span id="cb40-35"><a href="#cb40-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position.inside =</span> <span class="fu">c</span>(<span class="fl">0.75</span>, <span class="fl">0.2</span>),</span>
<span id="cb40-36"><a href="#cb40-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>)) <span class="sc">+</span></span>
<span id="cb40-37"><a href="#cb40-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb40-38"><a href="#cb40-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb40-39"><a href="#cb40-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"B. Regression line plot (same data)&lt;br&gt;"</span>,</span>
<span id="cb40-40"><a href="#cb40-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"surface_area::nidStorage (log10 scale)"</span>,</span>
<span id="cb40-41"><a href="#cb40-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="cn">NULL</span></span>
<span id="cb40-42"><a href="#cb40-42" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb40-43"><a href="#cb40-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-44"><a href="#cb40-44" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> </span>
<span id="cb40-45"><a href="#cb40-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb40-46"><a href="#cb40-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"tri_mean&lt;sub&gt;sample&lt;/sub&gt; by surfaceArea::nidStorage&lt;br&gt;for local areas around dams"</span>,</span>
<span id="cb40-47"><a href="#cb40-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> my_caption_nid_opentopography</span>
<span id="cb40-48"><a href="#cb40-48" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">&amp;</span></span>
<span id="cb40-49"><a href="#cb40-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_textbox_simple</span>(),</span>
<span id="cb40-50"><a href="#cb40-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_textbox_simple</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div id="fig-tri-mean-sample-and-surfaceArea-to-nidstorage" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-tri-mean-sample-and-surfaceArea-to-nidstorage-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="page-columns page-full">
<img src="ruggedness_files/figure-html/fig-tri-mean-sample-and-surfaceArea-to-nidstorage-1.png" class="img-fluid figure-img column-page-right" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-tri-mean-sample-and-surfaceArea-to-nidstorage-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10.16: tri_mean<sub>sample</sub> by surfaceArea::nidStorage<br>for local areas around dams
</figcaption>
</figure>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="regression-models-1" class="level4" data-number="10.4.2.2">
<h4 data-number="10.4.2.2" class="anchored" data-anchor-id="regression-models-1"><span class="header-section-number">10.4.2.2</span> Regression models</h4>
<p>Given my observations about <a href="#fig-tri-mean-sample-and-surfaceArea-to-nidstorage" class="quarto-xref">Figure&nbsp;<span>10.16</span></a>, and the fact that all three of the above plots have “vertical” features in the scatter plots, doubt there is a real relationship with <span class="math inline">\(tri\_mean_{sample}\)</span>. I explore only the best-performing model used in <span class="math inline">\(H_3\)</span>: <em><a href="#sec-h3-mod5" class="quarto-xref"><span>Section 10.5.2.5</span></a> Model 5</em>, which has <span class="math inline">\(R^2\)</span> = 0.50 (but that’s not very good given <em><a href="#sec-h3-mod6" class="quarto-xref"><span>Section 10.5.2.6</span></a> Model 6</em> using only state_abb has <span class="math inline">\(R^2\)</span> = 0.42).</p>
<section id="sec-h2-mod3" class="level5" data-number="10.4.2.2.1">
<h5 data-number="10.4.2.2.1" class="anchored" data-anchor-id="sec-h2-mod3"><span class="header-section-number">10.4.2.2.1</span> Model mod.h2.3</h5>
<p>Model mod.h2.3 <span class="math inline">\(R^2\)</span> = 0.49 (which is better than I expected).</p>
<p><span class="math display">\[mod.h2.3: tri\_mean_{dam} \sim nidstorage | state\]</span></p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>mod.h2<span class="fl">.3</span> <span class="ot">&lt;-</span> dta_for_model <span class="sc">|&gt;</span> </span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tri_mean_sample_scaled =</span> <span class="fu">scale</span>(tri_mean_sample),</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">nidStorage_scaled =</span> <span class="fu">scale</span>(nidStorage)) <span class="sc">|&gt;</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lmer</span>(tri_mean_sample_scaled <span class="sc">~</span> nidStorage_scaled <span class="sc">+</span> state_abb <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> state_abb),</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">data =</span> _)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod.h2<span class="fl">.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: tri_mean_sample_scaled ~ nidStorage_scaled + state_abb + (1 |  
    state_abb)
   Data: 
mutate(dta_for_model, tri_mean_sample_scaled = scale(tri_mean_sample),  
    nidStorage_scaled = scale(nidStorage))

REML criterion at convergence: 206380.2

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.4308 -0.3894 -0.1134  0.2036 10.8448 

Random effects:
 Groups    Name        Variance Std.Dev.
 state_abb (Intercept) 0.342    0.5848  
 Residual              0.659    0.8118  
Number of obs: 85156, groups:  state_abb, 48

Fixed effects:
                   Estimate Std. Error t value
(Intercept)       -0.703919   0.591588  -1.190
nidStorage_scaled  0.015223   0.002785   5.465
state_abbFL        0.030041   0.832248   0.036
state_abbMI        0.170992   0.832265   0.205
state_abbLA        0.068816   0.832437   0.083
state_abbIL        0.144136   0.832124   0.173
state_abbMN        0.132261   0.832230   0.159
state_abbND        0.229857   0.832334   0.276
state_abbMS        0.266060   0.831938   0.320
state_abbTX        0.335930   0.831928   0.404
state_abbKS        0.233193   0.832051   0.280
state_abbWI        0.375901   0.832289   0.452
state_abbOK        0.417555   0.831953   0.502
state_abbNE        0.365198   0.832008   0.439
state_abbRI        0.354044   0.833722   0.425
state_abbIN        0.235095   0.832248   0.282
state_abbSD        0.368236   0.832030   0.443
state_abbSC        0.288565   0.832038   0.347
state_abbAL        0.597051   0.832056   0.718
state_abbIA        0.336578   0.831971   0.405
state_abbMO        0.578288   0.831947   0.695
state_abbGA        0.434063   0.831947   0.522
state_abbAR        0.670377   0.832190   0.806
state_abbNJ        0.339538   0.832392   0.408
state_abbOH        0.509397   0.832158   0.612
state_abbME        0.722752   0.832601   0.868
state_abbMD        0.504976   0.832896   0.606
state_abbMA        0.776572   0.832200   0.933
state_abbMT        1.611265   0.832007   1.937
state_abbTN        1.107426   0.832204   1.331
state_abbVA        1.293486   0.832020   1.555
state_abbCT        0.857129   0.832377   1.030
state_abbNC        0.741665   0.831994   0.891
state_abbWY        1.333745   0.832143   1.603
state_abbNM        0.901844   0.832888   1.083
state_abbNH        1.480325   0.832499   1.778
state_abbNY        1.084699   0.832089   1.304
state_abbNV        1.417800   0.832669   1.703
state_abbAZ        1.261012   0.832971   1.514
state_abbKY        1.474209   0.832247   1.771
state_abbPA        1.567438   0.832145   1.884
state_abbWA        2.747030   0.832377   3.300
state_abbID        2.258452   0.832929   2.711
state_abbVT        1.645687   0.833011   1.976
state_abbOR        2.138093   0.832339   2.569
state_abbCO        1.723418   0.832077   2.071
state_abbUT        1.749662   0.832359   2.102
state_abbCA        2.179372   0.832152   2.619
state_abbWV        2.828031   0.832719   3.396</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>r_squared <span class="ot">&lt;-</span> <span class="fu">rsq</span>(mod.h2<span class="fl">.3</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>rsq_comment <span class="ot">&lt;-</span> <span class="fu">glue</span>(</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"r_squared: {round(r_squared$model, digits = 2)}"</span>, </span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>     <span class="st">"</span><span class="sc">\n</span><span class="st">consisting of fixed effects: {round(r_squared$fixed, digits = 2)}"</span>, </span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>     <span class="st">" and random effects: {round(r_squared$random, digits = 2)}"</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><br></p>
</section>
</section>
</section>
<section id="conclusion-h2" class="level3" data-number="10.4.3">
<h3 data-number="10.4.3" class="anchored" data-anchor-id="conclusion-h2"><span class="header-section-number">10.4.3</span> Conclusion: H<sub>2</sub></h3>
<p>The plots in <a href="#sec-plots-tri-mean-sample" class="quarto-xref"><span>Section 10.4.2</span></a>, in particular the near-vertical nature of the categories in the scatter plots indicate that there is no strong relationship between <span class="math inline">\(tri\_mean_{sample}\)</span> or <span class="math inline">\(tri\_mean_{dam}\)</span>) and either <code>surfaceArea</code>, <code>nidStorage</code>, or <span class="math inline">\(surfaceArea::nidStorage\)</span></p>
<p>For this reason I minimized my time investment by modeling only the one regression with the most promise (after exploring it in <span class="math inline">\(H_3\)</span>). It wasn’t helpful.</p>
<p>In other words, <span class="math inline">\(H_2\)</span> is not supported by the data.</p>
<p><br></p>
</section>
</section>
<section id="sec-h3-explore" class="level2 page-columns page-full" data-number="10.5">
<h2 data-number="10.5" class="anchored" data-anchor-id="sec-h3-explore"><span class="header-section-number">10.5</span> Exploring H<sub>3</sub> : Compared to H<sub>2</sub> there is a stronger inverse proportional relationship between ruggeness in the local areas around dams and surfaceArea::nidStorage</h2>
<p>This seems intuitive when compared to <span class="math inline">\(H_2\)</span>: dams are built where the topography provides good places to hold water, and where terrain is more rugged and thus the hills steeper, the basins holding water are likely to be deeper.</p>
<section id="plots-2" class="level3 page-columns page-full" data-number="10.5.1">
<h3 data-number="10.5.1" class="anchored" data-anchor-id="plots-2"><span class="header-section-number">10.5.1</span> Plots</h3>
<p>Of note re: <a href="#fig-tri-mean-dam-by-surfaceArea" class="quarto-xref">Figure&nbsp;<span>10.17</span></a>:</p>
<ul>
<li><p>Both panels show that dams with higher surface area tend to have lower <span class="math inline">\(tri\_mean_{dam}\)</span>, and the higher the <code>nidHeightId</code>, the higher the <span class="math inline">\(tri\_mean_{dam}\)</span>.</p></li>
<li><p>Compared to <span class="math inline">\(H_2\)</span>’s <a href="#fig-tri-mean-sample-by-surfaceArea" class="quarto-xref">Figure&nbsp;<span>10.14</span></a>, <a href="#fig-tri-mean-dam-by-surfaceArea" class="quarto-xref">Figure&nbsp;<span>10.17</span></a> does seem to show some relationship in panel A. See regression <em><a href="#sec-h3-mod1" class="quarto-xref"><span>Section 10.5.2.1</span></a> Model 1</em>.</p></li>
</ul>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> dta_for_model <span class="sc">|&gt;</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(surfaceArea),</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>         <span class="sc">!</span><span class="fu">is.na</span>(nidStorage)) <span class="sc">|&gt;</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(surfaceArea, tri_mean_dam, <span class="at">color =</span> nidHeightId, <span class="at">group =</span> nidHeightId)) <span class="sc">+</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">0.25</span>,</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.25</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">label =</span> <span class="fu">label_number</span>(<span class="at">scale_cut =</span> <span class="fu">cut_short_scale</span>())) <span class="sc">+</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">label =</span> <span class="fu">label_number</span>(<span class="at">scale_cut =</span> <span class="fu">cut_short_scale</span>())) <span class="sc">+</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"firebrick"</span>, <span class="st">"darkslategrey"</span>, <span class="st">"blue"</span>, <span class="st">"skyblue"</span>)) <span class="sc">+</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"A. Scatter plot&lt;br&gt;"</span>,</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"surface_area (log10 scale)"</span>,</span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"tri_mean_dam (log10 scale)"</span></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> dta_for_model <span class="sc">|&gt;</span></span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(surfaceArea),</span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>         <span class="sc">!</span><span class="fu">is.na</span>(nidStorage)) <span class="sc">|&gt;</span></span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(surfaceArea, tri_mean_dam, <span class="at">color =</span> nidHeightId, <span class="at">group =</span> nidHeightId)) <span class="sc">+</span></span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(</span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">'gam'</span>,</span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> y <span class="sc">~</span> <span class="fu">s</span>(x, <span class="at">bs =</span> <span class="st">"cs"</span>),</span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.5</span>,</span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># size = 0.25,</span></span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.8</span>,</span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">label =</span> <span class="fu">label_number</span>(<span class="at">scale_cut =</span> <span class="fu">cut_short_scale</span>())) <span class="sc">+</span></span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">label =</span> <span class="fu">label_number</span>(<span class="at">scale_cut =</span> <span class="fu">cut_short_scale</span>())) <span class="sc">+</span></span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"firebrick"</span>, <span class="st">"darkslategrey"</span>, <span class="st">"blue"</span>, <span class="st">"skyblue"</span>)) <span class="sc">+</span></span>
<span id="cb44-34"><a href="#cb44-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">position =</span> <span class="st">"inside"</span>,</span>
<span id="cb44-35"><a href="#cb44-35" aria-hidden="true" tabindex="-1"></a>                              <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linewidth =</span> <span class="dv">3</span>))) <span class="sc">+</span></span>
<span id="cb44-36"><a href="#cb44-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position.inside =</span> <span class="fu">c</span>(<span class="fl">0.75</span>, <span class="fl">0.2</span>)) <span class="sc">+</span></span>
<span id="cb44-37"><a href="#cb44-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb44-38"><a href="#cb44-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb44-39"><a href="#cb44-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"B. Regression line plot (same data)&lt;br&gt;"</span>,</span>
<span id="cb44-40"><a href="#cb44-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"surface_area (log10 scale)"</span>,</span>
<span id="cb44-41"><a href="#cb44-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="cn">NULL</span></span>
<span id="cb44-42"><a href="#cb44-42" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb44-43"><a href="#cb44-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-44"><a href="#cb44-44" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> </span>
<span id="cb44-45"><a href="#cb44-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb44-46"><a href="#cb44-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"tri_mean&lt;sub&gt;dam&lt;/sub&gt; by surfaceArea&lt;br&gt;for local areas around dams"</span>,</span>
<span id="cb44-47"><a href="#cb44-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> my_caption_nid_opentopography</span>
<span id="cb44-48"><a href="#cb44-48" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">&amp;</span></span>
<span id="cb44-49"><a href="#cb44-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_textbox_simple</span>(),</span>
<span id="cb44-50"><a href="#cb44-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_textbox_simple</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div id="fig-tri-mean-dam-by-surfaceArea" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-tri-mean-dam-by-surfaceArea-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="page-columns page-full">
<img src="ruggedness_files/figure-html/fig-tri-mean-dam-by-surfaceArea-1.png" class="img-fluid figure-img column-page-right" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-tri-mean-dam-by-surfaceArea-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10.17: tri_mean<sub>dam</sub> by surfaceArea
</figcaption>
</figure>
</div>
</div>
</div>
<p><br></p>
<p>Of note re: <a href="#fig-tri-mean-dam-by-nidStorage" class="quarto-xref">Figure&nbsp;<span>10.18</span></a>:</p>
<ul>
<li><p>There is a similar story for <code>nidStorage</code>: dams with higher <code>nidStorage</code> tend to have lower <span class="math inline">\(tri\_mean_{dam}\)</span>, and the higher the <code>nidHeightId</code>, the higher the <span class="math inline">\(tri\_mean_{dam}\)</span>.</p></li>
<li><p>It looks like there is a data entry artifact at <code>nidStorage</code> = 100 among small dams (the vertical line in panel A). People estimating <code>nidStorage</code> probably use 100 acre-feet as a handy guestimate.</p></li>
<li><p>Compared to <span class="math inline">\(H_2\)</span>’s <a href="#fig-tri-mean-sample-by-nidStorage" class="quarto-xref">Figure&nbsp;<span>10.15</span></a>, <a href="#fig-tri-mean-dam-by-nidStorage" class="quarto-xref">Figure&nbsp;<span>10.18</span></a> does seem to show some relationship in panel A. See regression <em><a href="#sec-h3-mod2" class="quarto-xref"><span>Section 10.5.2.2</span></a> Model 2</em>.</p></li>
</ul>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> dta_for_model <span class="sc">|&gt;</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(surfaceArea),</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>         <span class="sc">!</span><span class="fu">is.na</span>(nidStorage),</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>         nidStorage <span class="sc">&gt;=</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(nidStorage, tri_mean_dam, <span class="at">color =</span> nidHeightId, <span class="at">group =</span> nidHeightId)) <span class="sc">+</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">0.25</span>,</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.25</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">label =</span> <span class="fu">label_number</span>(<span class="at">scale_cut =</span> <span class="fu">cut_short_scale</span>())) <span class="sc">+</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">label =</span> <span class="fu">label_number</span>(<span class="at">scale_cut =</span> <span class="fu">cut_short_scale</span>())) <span class="sc">+</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"firebrick"</span>, <span class="st">"darkslategrey"</span>, <span class="st">"blue"</span>, <span class="st">"skyblue"</span>)) <span class="sc">+</span></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">100</span>)) <span class="sc">+</span><span class="fu">labs</span>(</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"A. Scatter plot"</span>,</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"nidStorage (log10 scale)"</span>,</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"tri_mean_dam (log10 scale)"</span></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> dta_for_model <span class="sc">|&gt;</span></span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(surfaceArea),</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>         <span class="sc">!</span><span class="fu">is.na</span>(nidStorage),</span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>         nidStorage <span class="sc">&gt;=</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(nidStorage, tri_mean_dam, <span class="at">color =</span> nidHeightId, <span class="at">group =</span> nidHeightId)) <span class="sc">+</span></span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(</span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">'gam'</span>,</span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> y <span class="sc">~</span> <span class="fu">s</span>(x, <span class="at">bs =</span> <span class="st">"cs"</span>),</span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.5</span>,</span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># size = 0.25,</span></span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.8</span>,</span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">label =</span> <span class="fu">label_number</span>(<span class="at">scale_cut =</span> <span class="fu">cut_short_scale</span>())) <span class="sc">+</span></span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">label =</span> <span class="fu">label_number</span>(<span class="at">scale_cut =</span> <span class="fu">cut_short_scale</span>())) <span class="sc">+</span></span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"firebrick"</span>, <span class="st">"darkslategrey"</span>, <span class="st">"blue"</span>, <span class="st">"skyblue"</span>)) <span class="sc">+</span></span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">position =</span> <span class="st">"inside"</span>,</span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a>                              <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linewidth =</span> <span class="dv">3</span>))) <span class="sc">+</span></span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position.inside =</span> <span class="fu">c</span>(<span class="fl">0.75</span>, <span class="fl">0.2</span>)) <span class="sc">+</span></span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">100</span>)) <span class="sc">+</span><span class="fu">labs</span>(</span>
<span id="cb45-39"><a href="#cb45-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"B. Regression line plot (same data)&lt;br&gt;"</span>,</span>
<span id="cb45-40"><a href="#cb45-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"nidStorage (log10 scale)"</span>,</span>
<span id="cb45-41"><a href="#cb45-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="cn">NULL</span></span>
<span id="cb45-42"><a href="#cb45-42" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb45-43"><a href="#cb45-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-44"><a href="#cb45-44" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> </span>
<span id="cb45-45"><a href="#cb45-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb45-46"><a href="#cb45-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"tri_mean&lt;sub&gt;dam&lt;/sub&gt; by nidStorage&lt;br&gt;for local areas around dams"</span>,</span>
<span id="cb45-47"><a href="#cb45-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> my_caption_nid_opentopography</span>
<span id="cb45-48"><a href="#cb45-48" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">&amp;</span></span>
<span id="cb45-49"><a href="#cb45-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_textbox_simple</span>(),</span>
<span id="cb45-50"><a href="#cb45-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_textbox_simple</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div id="fig-tri-mean-dam-by-nidStorage" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-tri-mean-dam-by-nidStorage-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="page-columns page-full">
<img src="ruggedness_files/figure-html/fig-tri-mean-dam-by-nidStorage-1.png" class="img-fluid figure-img column-page-right" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-tri-mean-dam-by-nidStorage-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10.18: tri_mean<sub>dam</sub> by nidStorage<br>for local areas around dams
</figcaption>
</figure>
</div>
</div>
</div>
<p><br></p>
<p>Of note re: <a href="#fig-tri-mean-dam-and-surfaceArea-to-nidstorage" class="quarto-xref">Figure&nbsp;<span>10.19</span></a>:</p>
<p>Results are the same as when using <span class="math inline">\(tri\_mean_{sample}\)</span> in <a href="#fig-tri-mean-sample-and-surfaceArea-to-nidstorage" class="quarto-xref">Figure&nbsp;<span>10.16</span></a> above to explore <span class="math inline">\(H_2\)</span>.</p>
<ul>
<li><p>Panel A suggests there is no meaningful relationship between <span class="math inline">\(tri\_mean_{dam}\)</span> and <span class="math inline">\(\frac{surfaceArea}{nidStorage}\)</span></p></li>
<li><p>One could tell a story from panel B if the model explained a lot of the variability (which is not likely given panel A). Regressions in <em>sec-h3-mod6 Model 6</em> confirm this.</p>
<ul>
<li>The regression lines are somewhat parallel: in general, for any <code>surfaceArea::nidStorage</code> ratio, the higher the <code>nidHeightId</code>, the higher the <span class="math inline">\(tri\_mean_{sample}\)</span>.</li>
</ul></li>
</ul>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> dta_for_model <span class="sc">|&gt;</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(surfaceArea),</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>         <span class="sc">!</span><span class="fu">is.na</span>(nidStorage)) <span class="sc">|&gt;</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(area_to_volume_dam, tri_mean_dam, <span class="at">color =</span> nidHeightId, <span class="at">group =</span> nidHeightId)) <span class="sc">+</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">0.25</span>,</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.25</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">label =</span> <span class="fu">label_number</span>(<span class="at">scale_cut =</span> <span class="fu">cut_short_scale</span>())) <span class="sc">+</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">label =</span> <span class="fu">label_number</span>(<span class="at">scale_cut =</span> <span class="fu">cut_short_scale</span>())) <span class="sc">+</span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"firebrick"</span>, <span class="st">"darkslategrey"</span>, <span class="st">"blue"</span>, <span class="st">"skyblue"</span>)) <span class="sc">+</span></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"A. Scatter plot&lt;br&gt;"</span>,</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"surface_area::nidStorage (log10 scale)"</span>,</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"tri_mean_dam (log10 scale)"</span></span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> dta_for_model <span class="sc">|&gt;</span></span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(surfaceArea),</span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>         <span class="sc">!</span><span class="fu">is.na</span>(nidStorage)) <span class="sc">|&gt;</span></span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(area_to_volume_dam, tri_mean_dam, <span class="at">color =</span> nidHeightId, <span class="at">group =</span> nidHeightId)) <span class="sc">+</span></span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(</span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">'gam'</span>,</span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> y <span class="sc">~</span> <span class="fu">s</span>(x, <span class="at">bs =</span> <span class="st">"cs"</span>),</span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.5</span>,</span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.8</span>,</span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">label =</span> <span class="fu">label_number</span>(<span class="at">scale_cut =</span> <span class="fu">cut_short_scale</span>())) <span class="sc">+</span></span>
<span id="cb46-31"><a href="#cb46-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">label =</span> <span class="fu">label_number</span>(<span class="at">scale_cut =</span> <span class="fu">cut_short_scale</span>())) <span class="sc">+</span></span>
<span id="cb46-32"><a href="#cb46-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"firebrick"</span>, <span class="st">"darkslategrey"</span>, <span class="st">"blue"</span>, <span class="st">"skyblue"</span>)) <span class="sc">+</span></span>
<span id="cb46-33"><a href="#cb46-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">position =</span> <span class="st">"inside"</span>,</span>
<span id="cb46-34"><a href="#cb46-34" aria-hidden="true" tabindex="-1"></a>                              <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linewidth =</span> <span class="dv">3</span>))) <span class="sc">+</span></span>
<span id="cb46-35"><a href="#cb46-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position.inside =</span> <span class="fu">c</span>(<span class="fl">0.75</span>, <span class="fl">0.2</span>)) <span class="sc">+</span></span>
<span id="cb46-36"><a href="#cb46-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb46-37"><a href="#cb46-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb46-38"><a href="#cb46-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"B. Regression line plot (same data)&lt;br&gt;"</span>,</span>
<span id="cb46-39"><a href="#cb46-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"surface_area::nidStorage (log10 scale)"</span>,</span>
<span id="cb46-40"><a href="#cb46-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="cn">NULL</span></span>
<span id="cb46-41"><a href="#cb46-41" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb46-42"><a href="#cb46-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-43"><a href="#cb46-43" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> </span>
<span id="cb46-44"><a href="#cb46-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb46-45"><a href="#cb46-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"tri_mean&lt;sub&gt;dam&lt;/sub&gt; by surfaceArea::nidStorage&lt;br&gt;for local areas around dams"</span>,</span>
<span id="cb46-46"><a href="#cb46-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> my_caption_nid_opentopography</span>
<span id="cb46-47"><a href="#cb46-47" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">&amp;</span></span>
<span id="cb46-48"><a href="#cb46-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_textbox_simple</span>(),</span>
<span id="cb46-49"><a href="#cb46-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_textbox_simple</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div id="fig-tri-mean-dam-and-surfaceArea-to-nidstorage" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-tri-mean-dam-and-surfaceArea-to-nidstorage-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="page-columns page-full">
<img src="ruggedness_files/figure-html/fig-tri-mean-dam-and-surfaceArea-to-nidstorage-1.png" class="img-fluid figure-img column-page-right" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-tri-mean-dam-and-surfaceArea-to-nidstorage-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10.19: tri_mean<sub>dam</sub> by surfaceArea::nidStorage<br>for local areas around dams
</figcaption>
</figure>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="regression-models-2" class="level3" data-number="10.5.2">
<h3 data-number="10.5.2" class="anchored" data-anchor-id="regression-models-2"><span class="header-section-number">10.5.2</span> Regression models</h3>
<section id="sec-h3-mod1" class="level4" data-number="10.5.2.1">
<h4 data-number="10.5.2.1" class="anchored" data-anchor-id="sec-h3-mod1"><span class="header-section-number">10.5.2.1</span> Model mod.h3.1</h4>
<p>The model mod.h3.1 has no explanatory power. <span class="math inline">\(R^2\)</span> is effectively zero.</p>
<p><span class="math display">\[mod.h3.1: tri\_mean_{dam} \sim surfaceArea\]</span></p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>mod.h3<span class="fl">.1</span> <span class="ot">&lt;-</span> dta_for_model <span class="sc">|&gt;</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(tri_mean_dam <span class="sc">~</span> surfaceArea,</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">data =</span> _)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod.h3<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = tri_mean_dam ~ surfaceArea, data = dta_for_model)

Residuals:
   Min     1Q Median     3Q    Max 
-7.923 -2.550 -1.379  0.508 58.869 

Coefficients:
               Estimate  Std. Error t value Pr(&gt;|t|)    
(Intercept) 4.776714814 0.017544845 272.257  &lt; 2e-16 ***
surfaceArea 0.000011097 0.000004263   2.603  0.00925 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 4.584 on 68542 degrees of freedom
  (17310 observations deleted due to missingness)
Multiple R-squared:  9.882e-05, Adjusted R-squared:  8.423e-05 
F-statistic: 6.774 on 1 and 68542 DF,  p-value: 0.009251</code></pre>
</div>
</div>
<p><br></p>
</section>
<section id="sec-h3-mod2" class="level4" data-number="10.5.2.2">
<h4 data-number="10.5.2.2" class="anchored" data-anchor-id="sec-h3-mod2"><span class="header-section-number">10.5.2.2</span> Model mod.h3.2</h4>
<p>Similarly, the model mod.h3.2 has no explanatory power. <span class="math inline">\(R^2\)</span> is effectively zero.</p>
<p><span class="math display">\[mod.h3.2: tri\_mean_{dam} \sim nidStorage\]</span></p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>mod.h3<span class="fl">.2</span> <span class="ot">&lt;-</span> dta_for_model <span class="sc">|&gt;</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(tri_mean_dam <span class="sc">~</span> nidStorage,</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">data =</span> _)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod.h3<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = tri_mean_dam ~ nidStorage, data = dta_for_model)

Residuals:
    Min      1Q  Median      3Q     Max 
-13.932  -2.485  -1.359   0.405  58.967 

Coefficients:
                 Estimate    Std. Error t value        Pr(&gt;|t|)    
(Intercept) 4.67615140184 0.01578323542 296.273         &lt; 2e-16 ***
nidStorage  0.00000046983 0.00000006975   6.736 0.0000000000164 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 4.602 on 85154 degrees of freedom
  (698 observations deleted due to missingness)
Multiple R-squared:  0.0005325, Adjusted R-squared:  0.0005208 
F-statistic: 45.37 on 1 and 85154 DF,  p-value: 0.00000000001642</code></pre>
</div>
</div>
<p><br></p>
</section>
<section id="sec-h3-mod3" class="level4" data-number="10.5.2.3">
<h4 data-number="10.5.2.3" class="anchored" data-anchor-id="sec-h3-mod3"><span class="header-section-number">10.5.2.3</span> Model mod.h3.3</h4>
<p>The model mod.h3.3 has no explanatory power. <span class="math inline">\(R^2\)</span> is effectively zero and, accordingly, the <span class="math inline">\(p\)</span> value is very high.</p>
<p><span class="math display">\[mod.h3.3: tri\_mean_{dam} \sim ratio\]</span></p>
<p>where <span class="math inline">\(ratio = \frac{surfaceArea}{nidStorage}\)</span>.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>mod.h3<span class="fl">.3</span> <span class="ot">&lt;-</span> dta_for_model <span class="sc">|&gt;</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(tri_mean_dam <span class="sc">~</span> area_to_volume_dam,</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">data =</span> _)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod.h3<span class="fl">.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = tri_mean_dam ~ area_to_volume_dam, data = dta_for_model)

Residuals:
   Min     1Q Median     3Q    Max 
-4.744 -2.550 -1.384  0.494 58.877 

Coefficients:
                   Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)         4.77071    0.01766 270.201   &lt;2e-16 ***
area_to_volume_dam  0.01656    0.01205   1.374    0.169    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 4.594 on 68054 degrees of freedom
  (17798 observations deleted due to missingness)
Multiple R-squared:  2.775e-05, Adjusted R-squared:  1.306e-05 
F-statistic: 1.889 on 1 and 68054 DF,  p-value: 0.1694</code></pre>
</div>
</div>
<p><br></p>
</section>
<section id="sec-h3-mod4" class="level4" data-number="10.5.2.4">
<h4 data-number="10.5.2.4" class="anchored" data-anchor-id="sec-h3-mod4"><span class="header-section-number">10.5.2.4</span> Model mod.h3.4</h4>
<p>Adjusting for state in a linear mixed model offers more explanatory power: mod.h3.4 <span class="math inline">\(R^2\)</span> = 0.47.</p>
<p><span class="math display">\[mod.h3.4: tri\_mean_{dam} \sim surfaceArea | state\]</span></p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>mod.h3<span class="fl">.4</span> <span class="ot">&lt;-</span> dta_for_model <span class="sc">|&gt;</span> <span class="co"># dams_with_tri |&gt;</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tri_mean_dam_scaled =</span> <span class="fu">scale</span>(tri_mean_dam),</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">surfaceArea_scaled =</span> <span class="fu">scale</span>(surfaceArea)) <span class="sc">|&gt;</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lmer</span>(tri_mean_dam_scaled <span class="sc">~</span> surfaceArea_scaled <span class="sc">+</span> state_abb <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> state_abb),</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">data =</span> _)</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod.h3<span class="fl">.4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: tri_mean_dam_scaled ~ surfaceArea_scaled + state_abb + (1 | state_abb)
   Data: mutate(dta_for_model, tri_mean_dam_scaled = scale(tri_mean_dam),  
    surfaceArea_scaled = scale(surfaceArea))

REML criterion at convergence: 164361.2

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-4.7335 -0.4130 -0.0943  0.2242 14.5480 

Random effects:
 Groups    Name        Variance Std.Dev.
 state_abb (Intercept) 2.188    1.4791  
 Residual              0.642    0.8012  
Number of obs: 68544, groups:  state_abb, 48

Fixed effects:
                    Estimate Std. Error t value
(Intercept)        -0.796668   1.481781  -0.538
surfaceArea_scaled  0.002789   0.003069   0.909
state_abbFL         0.099150   2.093784   0.047
state_abbMI         0.180159   2.093794   0.086
state_abbLA         0.179884   2.093861   0.086
state_abbIL         0.215946   2.093869   0.103
state_abbMN         0.227510   2.093849   0.109
state_abbND         0.278619   2.093848   0.133
state_abbMS         0.330694   2.093680   0.158
state_abbTX         0.328485   2.093667   0.157
state_abbKS         0.375448   2.093718   0.179
state_abbWI         0.403496   2.093814   0.193
state_abbOK         0.450294   2.093675   0.215
state_abbNE         0.456201   2.093692   0.218
state_abbRI         0.488730   2.094362   0.233
state_abbIN         0.496939   2.093787   0.237
state_abbSD         0.428591   2.093932   0.205
state_abbSC         0.567741   2.093707   0.271
state_abbAL         0.490383   2.093927   0.234
state_abbIA         0.622551   2.093678   0.297
state_abbMO         0.643281   2.093668   0.307
state_abbGA         0.645353   2.093669   0.308
state_abbAR         0.698400   2.093835   0.334
state_abbNJ         0.702580   2.093838   0.336
state_abbOH         0.707544   2.093754   0.338
state_abbME         0.759280   2.093929   0.363
state_abbMD         0.789333   2.094073   0.377
state_abbMA         0.890187   2.093777   0.425
state_abbMT         1.635832   2.093938   0.781
state_abbTN         1.061460   2.093772   0.507
state_abbVA         1.209061   2.093725   0.577
state_abbCT         1.054984   2.093771   0.504
state_abbNC         1.180449   2.093691   0.564
state_abbWY         1.201428   2.093745   0.574
state_abbNM         1.202664   2.094142   0.574
state_abbNH         1.304317   2.093883   0.623
state_abbNY         1.440652   2.093724   0.688
state_abbNV         1.438821   2.093954   0.687
state_abbAZ         1.396055   2.094161   0.667
state_abbKY         1.226042   2.093805   0.586
state_abbPA         1.769214   2.093759   0.845
state_abbWA         1.945266   2.093863   0.929
state_abbID         1.958452   2.094050   0.935
state_abbVT         2.057331   2.094080   0.982
state_abbOR         2.149127   2.093846   1.026
state_abbCO         2.112241   2.093720   1.009
state_abbUT         3.774710   2.098016   1.799
state_abbCA         2.737416   2.093754   1.307
state_abbWV         3.009690   2.094024   1.437</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>r_squared <span class="ot">&lt;-</span> <span class="fu">rsq</span>(mod.h3<span class="fl">.4</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>rsq_comment <span class="ot">&lt;-</span> <span class="fu">glue</span>(</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"r_squared: {round(r_squared$model, digits = 2)}"</span>, </span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>     <span class="st">"</span><span class="sc">\n</span><span class="st">consisting of fixed effects: {round(r_squared$fixed, digits = 2)}"</span>, </span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>     <span class="st">" and random effects: {round(r_squared$random, digits = 2)}"</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><br></p>
</section>
<section id="sec-h3-mod5" class="level4" data-number="10.5.2.5">
<h4 data-number="10.5.2.5" class="anchored" data-anchor-id="sec-h3-mod5"><span class="header-section-number">10.5.2.5</span> Model mod.h3.5</h4>
<p>A similar mod.h3.5 has slightly better results: <span class="math inline">\(R^2\)</span> = 0.50.</p>
<p><span class="math display">\[mod.h3.5: tri\_mean_{dam} \sim nidstorage | state\]</span></p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>mod.h3<span class="fl">.5</span> <span class="ot">&lt;-</span> dta_for_model <span class="sc">|&gt;</span> <span class="co"># dams_with_tri |&gt;</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tri_mean_dam_scaled =</span> <span class="fu">scale</span>(tri_mean_dam),</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">nidStorage_scaled =</span> <span class="fu">scale</span>(nidStorage)) <span class="sc">|&gt;</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lmer</span>(tri_mean_dam_scaled <span class="sc">~</span> nidStorage_scaled <span class="sc">+</span> state_abb <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> state_abb),</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">data =</span> _)</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod.h3<span class="fl">.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: tri_mean_dam_scaled ~ nidStorage_scaled + state_abb + (1 | state_abb)
   Data: mutate(dta_for_model, tri_mean_dam_scaled = scale(tri_mean_dam),  
    nidStorage_scaled = scale(nidStorage))

REML criterion at convergence: 205879.3

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.5830 -0.4164 -0.1007  0.2139 14.4515 

Random effects:
 Groups    Name        Variance Std.Dev.
 state_abb (Intercept) 1.0557   1.0275  
 Residual              0.6551   0.8094  
Number of obs: 85156, groups:  state_abb, 48

Fixed effects:
                   Estimate Std. Error t value
(Intercept)       -0.795199   1.031310  -0.771
nidStorage_scaled  0.014489   0.002777   5.217
state_abbFL        0.097349   1.455997   0.067
state_abbMI        0.174747   1.456007   0.120
state_abbLA        0.177532   1.456104   0.122
state_abbIL        0.206033   1.455927   0.142
state_abbMN        0.276087   1.455987   0.190
state_abbND        0.281396   1.456046   0.193
state_abbMS        0.327705   1.455821   0.225
state_abbTX        0.336124   1.455815   0.231
state_abbKS        0.374391   1.455885   0.257
state_abbWI        0.439131   1.456020   0.302
state_abbOK        0.450830   1.455830   0.310
state_abbNE        0.455028   1.455861   0.313
state_abbRI        0.489115   1.456835   0.336
state_abbIN        0.489100   1.455997   0.336
state_abbSD        0.511593   1.455873   0.351
state_abbSC        0.569573   1.455878   0.391
state_abbAL        0.610712   1.455888   0.419
state_abbIA        0.619730   1.455840   0.426
state_abbMO        0.640944   1.455826   0.440
state_abbGA        0.647461   1.455826   0.445
state_abbAR        0.680338   1.455964   0.467
state_abbNJ        0.703274   1.456079   0.483
state_abbOH        0.700364   1.455946   0.481
state_abbME        0.760266   1.456198   0.522
state_abbMD        0.788313   1.456366   0.541
state_abbMA        0.875513   1.455970   0.601
state_abbMT        0.909781   1.455860   0.625
state_abbTN        1.039303   1.455972   0.714
state_abbVA        1.045716   1.455868   0.718
state_abbCT        1.063890   1.456071   0.731
state_abbNC        1.143199   1.455853   0.785
state_abbWY        1.194106   1.455937   0.820
state_abbNM        1.257300   1.456361   0.863
state_abbNH        1.308047   1.456140   0.898
state_abbNY        1.425883   1.455907   0.979
state_abbNV        1.440460   1.456236   0.989
state_abbAZ        1.442600   1.456408   0.991
state_abbKY        1.502459   1.455997   1.032
state_abbPA        1.740860   1.455939   1.196
state_abbWA        1.903134   1.456070   1.307
state_abbID        1.951624   1.456384   1.340
state_abbVT        2.056167   1.456431   1.412
state_abbOR        2.064702   1.456049   1.418
state_abbCO        2.164664   1.455900   1.487
state_abbUT        2.636034   1.456060   1.810
state_abbCA        2.698780   1.455943   1.854
state_abbWV        3.194126   1.456265   2.193</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>r_squared <span class="ot">&lt;-</span> <span class="fu">rsq</span>(mod.h3<span class="fl">.5</span>)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>rsq_comment <span class="ot">&lt;-</span> <span class="fu">glue</span>(</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"r_squared: {round(r_squared$model, digits = 2)}"</span>, </span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>     <span class="st">"</span><span class="sc">\n</span><span class="st">consisting of fixed effects: {round(r_squared$fixed, digits = 2)}"</span>, </span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>     <span class="st">" and random effects: {round(r_squared$random, digits = 2)}"</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><br></p>
</section>
<section id="sec-h3-mod6" class="level4" data-number="10.5.2.6">
<h4 data-number="10.5.2.6" class="anchored" data-anchor-id="sec-h3-mod6"><span class="header-section-number">10.5.2.6</span> Model mod.h3.6</h4>
<p>The model mod.h3.6 has some explanatory power. <span class="math inline">\(R^2\)</span> = 0.42, however, it explains less variation than the two models above using <code>surfaceArea</code> and <code>nidStorage</code> as separate predictors.</p>
<p><span class="math display">\[mod.h3.6: tri\_mean_{dam} \sim ratio | state\]</span></p>
<p>where <span class="math inline">\(ratio = \frac{surfaceArea}{nidStorage}\)</span></p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># mod6 &lt;- dta_for_model |&gt;</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   lmer(tri_mean_dam ~ area_to_volume_dam + (1 | state_abb),</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="co">#      data = _)</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>mod.h3<span class="fl">.6</span> <span class="ot">&lt;-</span> dta_for_model <span class="sc">|&gt;</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tri_mean_dam_scaled =</span> <span class="fu">scale</span>(tri_mean_dam),</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">area_to_volume_dam_scaled =</span> <span class="fu">scale</span>(area_to_volume_dam)) <span class="sc">|&gt;</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lmer</span>(tri_mean_dam_scaled <span class="sc">~</span> area_to_volume_dam_scaled <span class="sc">+</span> state_abb <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> state_abb),</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">data =</span> _)</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod.h3<span class="fl">.6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: tri_mean_dam_scaled ~ area_to_volume_dam_scaled + state_abb +  
    (1 | state_abb)
   Data: mutate(dta_for_model, tri_mean_dam_scaled = scale(tri_mean_dam),  
    area_to_volume_dam_scaled = scale(area_to_volume_dam))

REML criterion at convergence: 163453

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-4.7186 -0.4121 -0.0943  0.2231 14.5186 

Random effects:
 Groups    Name        Variance Std.Dev.
 state_abb (Intercept) 0.09228  0.3038  
 Residual              0.64444  0.8028  
Number of obs: 68056, groups:  state_abb, 48

Fixed effects:
                           Estimate Std. Error t value
(Intercept)               -0.796721   0.316759  -2.515
area_to_volume_dam_scaled -0.003785   0.003079  -1.229
state_abbFL                0.099587   0.439578   0.227
state_abbMI                0.180016   0.439626   0.409
state_abbLA                0.180261   0.439945   0.410
state_abbIL                0.216103   0.439983   0.491
state_abbMN                0.228196   0.439884   0.519
state_abbND                0.278764   0.439882   0.634
state_abbMS                0.330563   0.439078   0.753
state_abbTX                0.328454   0.439016   0.748
state_abbKS                0.375324   0.439259   0.854
state_abbWI                0.404142   0.439719   0.919
state_abbOK                0.450162   0.439054   1.025
state_abbNE                0.456021   0.439135   1.038
state_abbRI                0.490155   0.442348   1.108
state_abbIN                0.498546   0.439601   1.134
state_abbSD                0.429141   0.440286   0.975
state_abbSC                0.567735   0.439206   1.293
state_abbAL                0.490743   0.440257   1.115
state_abbIA                0.622374   0.439067   1.417
state_abbMO                0.642044   0.439019   1.462
state_abbGA                0.645237   0.439027   1.470
state_abbAR                0.698930   0.439820   1.589
state_abbNJ                0.706553   0.439849   1.606
state_abbOH                0.707418   0.439434   1.610
state_abbME                0.761086   0.440273   1.729
state_abbMD                0.792350   0.441005   1.797
state_abbMA                0.890169   0.439544   2.025
state_abbMT                1.636419   0.440311   3.717
state_abbTN                1.061525   0.439520   2.415
state_abbVA                1.209035   0.439295   2.752
state_abbCT                1.064990   0.439820   2.421
state_abbNC                1.178392   0.439130   2.683
state_abbWY                1.201424   0.439391   2.734
state_abbNM                1.194106   0.441314   2.706
state_abbNH                1.304429   0.440049   2.964
state_abbNY                1.439915   0.439288   3.278
state_abbNV                1.440967   0.440390   3.272
state_abbAZ                1.396704   0.441372   3.164
state_abbKY                1.224942   0.439678   2.786
state_abbPA                1.768951   0.439457   4.025
state_abbWA                1.946315   0.439953   4.424
state_abbID                1.959219   0.440846   4.444
state_abbVT                2.057327   0.440986   4.665
state_abbOR                2.149651   0.439870   4.887
state_abbCO                2.111321   0.439268   4.806
state_abbUT                3.776444   0.459380   8.221
state_abbCA                2.737617   0.439431   6.230
state_abbWV                3.014099   0.440741   6.839</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>r_squared <span class="ot">&lt;-</span> <span class="fu">rsq</span>(mod.h3<span class="fl">.6</span>)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>rsq_comment <span class="ot">&lt;-</span> <span class="fu">glue</span>(</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"r_squared: {round(r_squared$model, digits = 2)}"</span>, </span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>     <span class="st">"</span><span class="sc">\n</span><span class="st">consisting of fixed effects: {round(r_squared$fixed, digits = 2)}"</span>, </span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>     <span class="st">" and random effects: {round(r_squared$random, digits = 2)}"</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><br></p>
</section>
<section id="sec-h3-mod7" class="level4" data-number="10.5.2.7">
<h4 data-number="10.5.2.7" class="anchored" data-anchor-id="sec-h3-mod7"><span class="header-section-number">10.5.2.7</span> Model mod.h3.7</h4>
<p>mod.h3.7 uses only state effects. <span class="math inline">\(R^2\)</span> = 0.40.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>mod.h3<span class="fl">.7</span> <span class="ot">&lt;-</span> dta_for_model <span class="sc">|&gt;</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tri_mean_dam_scaled =</span> <span class="fu">scale</span>(tri_mean_dam)) <span class="sc">|&gt;</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lmer</span>(tri_mean_dam_scaled <span class="sc">~</span>  <span class="dv">1</span> <span class="sc">|</span> state_abb,</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">data =</span> _)</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod.h3<span class="fl">.7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: tri_mean_dam_scaled ~ 1 | state_abb
   Data: mutate(dta_for_model, tri_mean_dam_scaled = scale(tri_mean_dam))

REML criterion at convergence: 207681.1

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.5983 -0.4175 -0.1013  0.2144 14.4448 

Random effects:
 Groups    Name        Variance Std.Dev.
 state_abb (Intercept) 0.5590   0.7477  
 Residual              0.6552   0.8095  
Number of obs: 85854, groups:  state_abb, 48

Fixed effects:
            Estimate Std. Error t value
(Intercept)   0.2026     0.1080   1.876</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>r_squared <span class="ot">&lt;-</span> <span class="fu">rsq</span>(mod.h3<span class="fl">.7</span>)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>rsq_comment <span class="ot">&lt;-</span> <span class="fu">glue</span>(</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"r_squared: {round(r_squared$model, digits = 2)}"</span>, </span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>     <span class="st">"</span><span class="sc">\n</span><span class="st">consisting of fixed effects: {round(r_squared$fixed, digits = 2)}"</span>, </span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>     <span class="st">" and random effects: {round(r_squared$random, digits = 2)}"</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><br></p>
</section>
</section>
<section id="conclusion-h3" class="level3" data-number="10.5.3">
<h3 data-number="10.5.3" class="anchored" data-anchor-id="conclusion-h3"><span class="header-section-number">10.5.3</span> Conclusion: H<sub>3</sub></h3>
<p>Plots re: <span class="math inline">\(tri\_mean_{dam}\)</span> are similar to those when using <span class="math inline">\(tri\_mean_{sample}\)</span> in <a href="#fig-tri-mean-sample-and-surfaceArea-to-nidstorage" class="quarto-xref">Figure&nbsp;<span>10.16</span></a> above to explore <span class="math inline">\(H_2\)</span>. See <a href="#fig-tri-mean-dam-and-surfaceArea-to-nidstorage" class="quarto-xref">Figure&nbsp;<span>10.19</span></a>.</p>
<p>The near-vertical nature of the categories in the scatter plots indicate that there is no strong relationship between <span class="math inline">\(tri\_mean_{sample}\)</span> or <span class="math inline">\(tri\_mean_{dam}\)</span>) and either <code>surfaceArea</code>, <code>nidStorage</code>, or <span class="math inline">\(surfaceArea::nidStorage\)</span>.</p>
<p>I explored seven regression models. None strenghen the case for <span class="math inline">\(H_3\)</span>.</p>
<p>In other words, <span class="math inline">\(H_3\)</span> is not supported by the data.</p>
<p><br></p>
</section>
</section>
<section id="summary-insights-from-ruggedness" class="level2" data-number="10.6">
<h2 data-number="10.6" class="anchored" data-anchor-id="summary-insights-from-ruggedness"><span class="header-section-number">10.6</span> Summary: insights from ruggedness</h2>
<p><span class="math inline">\(H_1\)</span> is the only one of the three hypotheses supported by the data–and that only on a qualified basis. In flatter regions it’s true that the areas around dams are more rugged than the median ruggedness. This is not true for mountainous regions, since dams are placed in valleys, which are flatter than the surrounding mountains. Additionally large dams create flatness by virtue of their lakes.</p>
<p><span class="math inline">\(H_2\)</span> and <span class="math inline">\(H_3\)</span> are disproved by the data. While <code>surfaceArea</code> and <code>nidStorage</code> are related (<a href="#fig-h2-visualization" class="quarto-xref">Figure&nbsp;<span>10.13</span></a>), the ratio <span class="math inline">\(surfaceArea::nidStorage\)</span> does not appear to have an association with ruggedness–either of the areas around dams (<span class="math inline">\(tri\_mean_{dam}\)</span>) or around random points in the state (<span class="math inline">\(tri\_mean_{sample}\)</span>).</p>
<p><br></p>


</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>And in the case of dams for mine tailings and waste products from coal-based electricity generation: other liquids and semi-liquids.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Wilson et al 2007, Multiscale Terrain Analysis of Multibeam Bathymetry Data for Habitat Mapping on the Continental Slope. Marine Geodesy 30:3-35. See also the original paper defining TRI by Riley, DeGloia, and Elliot (1999): A Terrain Ruggedness Index that Quantifies Topographic Heterogeneity. Authors: Shawn J. Riley, Stephen D. DeGloria, Robert Elliot. <em>Intermountain Journal of Sciences</em>, Vol. 5, No.&nbsp;1-4, 1999. <a href="https://arc.lib.montana.edu/ojs/index.php/IJS/article/view/1794/1457" class="uri">https://arc.lib.montana.edu/ojs/index.php/IJS/article/view/1794/1457</a> which is available for download from the Archives and Special Collections of Montana State University.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p><a href="https://www.earthdata.nasa.gov/data/instruments/srtm" class="uri">https://www.earthdata.nasa.gov/data/instruments/srtm</a> <a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>See <a href="https://geoservice.dlr.de/web/dataguide/srtm/" class="uri">https://geoservice.dlr.de/web/dataguide/srtm/</a> and <a href="https://gis.stackexchange.com/questions/110755/is-srtm-3-second-arc-free-of-non-terrain-features" class="uri">https://gis.stackexchange.com/questions/110755/is-srtm-3-second-arc-free-of-non-terrain-features</a> <a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p><a href="https://en.wikipedia.org/wiki/List_of_extreme_points_of_the_United_States" class="uri">https://en.wikipedia.org/wiki/List_of_extreme_points_of_the_United_States</a> <a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./dams-and-waterways.html" class="pagination-link" aria-label="Dams, waterways, and watersheds">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Dams, waterways, and watersheds</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./ruggedness-preparing.html" class="pagination-link" aria-label="Preparing terrain ruggedness">
        <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Preparing terrain ruggedness</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Copyright 2026 by <a href="https://dmoul.github.io">Daniel Moul</a>. License: <a href="http://creativecommons.org/licenses/by/4.0/">CC-BY 4.0</a></p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>